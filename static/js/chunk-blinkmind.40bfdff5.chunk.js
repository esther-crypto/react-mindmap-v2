(window["webpackJsonpreact-mindmap"]=window["webpackJsonpreact-mindmap"]||[]).push([[0],{301:function(e,t,n){e.exports=n.p+"static/media/default.4f8c4983.jpg"},302:function(e,t,n){e.exports=n.p+"static/media/theme1.2f59f00b.jpg"},303:function(e,t,n){e.exports=n.p+"static/media/theme2.b18193fb.jpg"},304:function(e,t,n){e.exports=n.p+"static/media/theme3.61c97910.jpg"},305:function(e,t,n){e.exports=n.p+"static/media/theme4.1e21408c.jpg"},355:function(e,t,n){},358:function(e,t,n){},519:function(e,t,n){},768:function(e,t,n){},854:function(e,t,n){},875:function(e,t,n){},876:function(e,t,n){},877:function(e,t,n){},878:function(e,t,n){},879:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),c=n(22),i=n.n(c),a=(n(355),n(11)),l=n(12),u=n(14),s=n(13),p=n(45),d=n(2),f=n(9),y=n.n(f),b=n(86),g=n(5),h=n(32),O=n(1),m=n(29),v=n(23),j=n(3);function T(e){return!0===(null!=(t=e)&&"object"===typeof t&&!1===Array.isArray(t))&&"[object Object]"===Object.prototype.toString.call(e);var t}var E=function(e){var t,n;return!1!==T(e)&&("function"===typeof(t=e.constructor)&&(!1!==T(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))},k=n(31);var x,S=function(e,t){},C="L",w="R",R="M";!function(e){e[e.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT",e[e.LEFT_AND_RIGHT=2]="LEFT_AND_RIGHT",e[e.TOP_TO_BOTTOM=3]="TOP_TO_BOTTOM"}(x||(x={}));var K=0,D=1,L="CONTENT",I="DESC",_="NORMAL",M="EDITING_CONTENT",A="EDITING_DESC",F="SHOW_POPUP",P="DRAGGING",N="ANCESTOR",B="DESCENDANT",z="SIBLING",V="NONE",H="TOGGLE_COLLAPSE",G="COLLAPSE_ALL",U="EXPAND_ALL",W="EXPAND_TO",Z="ADD_CHILD",Y="ADD_SIBLING",J="DELETE_TOPIC",X="FOCUS_TOPIC",q="SET_FOCUS_MODE",Q="SET_STYLE",$="SET_THEME",ee="SET_TOPIC_BLOCK",te="DELETE_TOPIC_BLOCK",ne="START_EDITING_CONTENT",oe="START_EDITING_DESC",re="DRAG_AND_DROP",ce="SET_EDITOR_ROOT",ie=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"data",get:function(){return this.get("data")}},{key:"type",get:function(){return this.get("type")}}],[{key:"create",value:function(e){return new n(e)}},{key:"createList",value:function(e){if(j.List.isList(e)||Array.isArray(e))return Object(j.List)(e.map(n.create));throw new Error("Block.createList only accepts Array or List, but you passed it: ".concat(e))}}]),n}(Object(j.Record)({type:null,key:null,data:null}));var ae={readOnly:!1,allowUndo:!0,layoutDir:x.LEFT_AND_RIGHT,theme:{name:"default",randomColor:!0,background:"rgb(57,60,65)",highlightColor:"#50C9CE",marginH:60,marginV:20,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5,lineType:"curve",lineWidth:"3px"},rootTopic:{contentStyle:{fontSize:"34px",borderRadius:"35px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},primaryTopic:{contentStyle:{borderWidth:"1px",borderStyle:"solid",borderRadius:"20px",fontSize:"17px",padding:"10px 15px 10px 15px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},normalTopic:{contentStyle:{border:"1px solid #e8eaec",borderRadius:"20px",fontSize:"17px",padding:"4px 10px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"white"}}}},le=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"layoutDir",get:function(){return this.get("layoutDir")}},{key:"readOnly",get:function(){return this.get("readOnly")}},{key:"allowUndo",get:function(){return this.get("allowUndo")}},{key:"theme",get:function(){return this.get("theme")}}],[{key:"fromJSON",value:function(e){return new n(e)}}]),n}(Object(j.Record)(ae));function ue(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var se=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"key",get:function(){return this.get("key")}},{key:"parentKey",get:function(){return this.get("parentKey")}},{key:"collapse",get:function(){return this.get("collapse")}},{key:"subKeys",get:function(){return this.get("subKeys")}},{key:"blocks",get:function(){return this.get("blocks")}},{key:"relations",get:function(){return this.get("relations")}},{key:"style",get:function(){return this.get("style")}},{key:"getBlock",value:function(e){var t=this.blocks.findIndex((function(t){return t.type===e}));return-1===t?{index:t,block:null}:{index:t,block:this.blocks.get(t)}}}],[{key:"fromJSON",value:function(e){var t=e.key,o=e.parentKey,r=void 0===o?null:o,c=e.blocks,i=e.subKeys,a=void 0===i?[]:i,l=e.collapse;return new n({key:t,parentKey:r,collapse:void 0!==l&&l,subKeys:Object(j.List)(a),blocks:ie.createList(c)})}},{key:"create",value:function(e){var t=e.key,o=e.parentKey,r=void 0===o?null:o,c=e.content,i=void 0===c?"":c,a=e.subKeys,l=void 0===a?[]:a,u=e.collapse,s=void 0!==u&&u,p=ie.create({type:L,data:i,key:null});return new n({key:t,parentKey:r,blocks:Object(j.List)([p]),subKeys:Object(j.List)(l),collapse:s})}}]),n}(Object(j.Record)({key:null,parentKey:null,collapse:!1,subKeys:null,blocks:null,relations:null,style:null}));function pe(e,t){var n=e.getTopic(t),o=[];if(n.subKeys.size>0){var r,c=n.subKeys.toArray();(r=o).push.apply(r,Object(v.a)(c)),o=c.reduce((function(t,n){return t.push.apply(t,Object(v.a)(pe(e,n))),t}),o)}return o}function de(e,t,n){var o=e.getTopic(t),r=e.getTopic(n);if(o&&r){if(o.parentKey==r.parentKey)return z;for(var c=o;c.parentKey;){if(c.parentKey===r.key)return B;c=e.getParentTopic(c.key)}for(c=r;c.parentKey;){if(c.parentKey===o.key)return N;c=e.getParentTopic(c.key)}}return V}var fe=y()("modifier");function ye(e){var t=e.model,n=e.topicKey,o=e.focusMode;return fe("focus topic"),n!==t.focusKey&&(t=t.set("focusKey",n)),o!==t.focusMode&&(t=t.set("focusMode",o)),t}var be={addChild:function(e){var t=e.model,n=e.topicKey;fe("addChild:",n);var o=t.getTopic(n);if(o){var r=se.create({key:ue(),parentKey:o.key});return o=o.set("collapse",!1).update("subKeys",(function(e){return e.push(r.key)})),ye({model:t=t.update("topics",(function(e){return e.set(n,o).set(r.key,r)})),topicKey:r.key,focusMode:M})}return t},addSibling:function(e){var t=e.model,n=e.topicKey;if(n===t.rootTopicKey)return t;var o=t.getTopic(n);if(o){var r=t.getTopic(o.parentKey),c=r.subKeys.indexOf(n),i=se.create({key:ue(),parentKey:r.key});return ye({model:t=t.update("topics",(function(e){return e.set(i.key,i)})).updateIn(["topics",r.key,"subKeys"],(function(e){return e.insert(c+1,i.key)})),topicKey:i.key,focusMode:M})}return t},toggleCollapse:function(e){var t=e.model,n=e.topicKey,o=t.getTopic(n);return o&&0!==o.subKeys.size&&(o=o.merge({collapse:!o.collapse}),t=t.updateIn(["topics",o.key,"collapse"],(function(e){return!e}))),t=ye({model:t,topicKey:n,focusMode:_})},collapseAll:function(e){var t=e.model,n=pe(t,t.editorRootTopicKey);return fe(t),t=ye({model:t=t.withMutations((function(e){n.forEach((function(t){e.setIn(["topics",t,"collapse"],!0)}))})),topicKey:t.editorRootTopicKey,focusMode:_})},expandAll:function(e){var t=e.model,n=pe(t,t.editorRootTopicKey);return fe(t),t=t.withMutations((function(e){n.forEach((function(t){e.setIn(["topics",t,"collapse"],!1)}))})),fe(t),t},expandTo:function(e){var t=e.model,n=e.topicKey,o=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[t],r=e.getTopic(t);r.parentKey;)n?o.push(r.parentKey):o.unshift(r.parentKey),r=e.getParentTopic(r.key);return o}(t,n).filter((function(e){return e!==n}));return de(t=t.withMutations((function(e){o.forEach((function(t){e.setIn(["topics",t,"collapse"],!1)}))})),n,t.editorRootTopicKey)!==B&&(t=t.set("editorRootTopicKey",t.rootTopicKey)),t},focusTopic:ye,setFocusMode:function(e){var t=e.model,n=e.focusMode;return fe("setFocusMode"),n!==t.focusMode&&(t=t.set("focusMode",n)),t},deleteTopic:function(e){var t=e.model,n=e.topicKey;if(n===t.editorRootTopicKey)return t;var o=t.getTopic(n);return o&&(t=t.withMutations((function(e){e.update("topics",(function(e){e=e.delete(n);var o=pe(t,n);return e=e.withMutations((function(e){o.forEach((function(t){e.delete(t)}))}))})),e.updateIn(["topics",o.parentKey,"subKeys"],(function(e){return e.delete(e.indexOf(n))})),e.focusKey===n&&e.set("focusKey",null).set("focusMode",null)}))),t},setBlockData:function(e){var t=e.model,n=e.topicKey,o=e.blockType,r=e.focusMode,c=e.data,i=t.getTopic(n);if(i){var a=i.getBlock(o),l=a.index,u=a.block;-1===l?t=t.updateIn(["topics",n,"blocks"],(function(e){return e.push(ie.create({type:o,data:c}))})):u.data!==c&&(t=t.updateIn(["topics",n,"blocks",l,"data"],(function(e){return c}))),r&&(t=ye({model:t,topicKey:n,focusMode:r}))}return t},deleteBlock:function(e){var t=e.model,n=e.topicKey,o=e.blockType,r=t.getTopic(n);if(r){var c=r.getBlock(o).index;-1!==c&&(t=t.updateIn(["topics",n,"blocks"],(function(e){return e.delete(c)}))),t=ye({model:t,topicKey:null,focusMode:null})}return t},setStyle:function(e){var t=e.model,n=e.topicKey,o=e.style,r=t.getTopic(n);return r&&o!==r.style&&(t=t.updateIn(["topics",n,"style"],(function(e){return o}))),t},clearAllCustomStyle:function(e){var t=e.model;return t=t.withMutations((function(e){e.topics.keySeq().forEach((function(t){e.setIn(["topics",t,"style"],null)}))}))},setTheme:function(e){var t=e.model,n=e.theme;return t=t.setIn(["config","theme"],n)},setLayoutDir:function(e){var t=e.model,n=e.layoutDir;return t.config.layoutDir===n?t:t=t.setIn(["config","layoutDir"],n)},setEditorRootTopicKey:function(e){var t=e.model,n=e.topicKey;return t.editorRootTopicKey!==n&&(t=t.set("editorRootTopicKey",n)),t.getTopic(n).collapse&&(t=t.setIn(["topics",n,"collapse"],!1)),t},setZoomFactor:function(e){var t=e.model,n=e.zoomFactor;return t.zoomFactor!==n&&(t=t.set("zoomFactor",n)),t}},ge={topics:Object(j.Map)(),extData:Object(j.Map)(),config:new le,rootTopicKey:null,editorRootTopicKey:null,focusKey:null,focusMode:null,formatVersion:null,zoomFactor:1};Object(j.Record)(ge);function he(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.plugins,n=void 0===t?[]:t;return Object(v.a)(n)}y()("core:controller");function Oe(e,t){if(Array.isArray(t))t.forEach((function(t){return Oe(e,t)}));else if(null!=t)for(var n in t){var o=t[n];e.middleware[n]=e.middleware[n]||[],e.middleware[n].push(o)}}function me(e){if(!Array.isArray(e))throw new TypeError("Middleware stack must be an array!");var t,n=Object(m.a)(e);try{for(n.s();!(t=n.n()).done;){if("function"!==typeof t.value)throw new TypeError("Middleware must be composed of functions!")}}catch(o){n.e(o)}finally{n.f()}return function(t,n){var r=-1;return function c(i){if(i<=r)throw new Error("next() called multiple times");r=i;var a=e[i];i===e.length&&(a=n);if(!a)return null;try{return a(t,c.bind(null,i+1))}catch(o){throw o}}(0)}}var ve=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(a.a)(this,e);var n=t.plugins,o=void 0===n?[]:n,r=t.onChange,c=t.readOnly;this.readOnly=c,this.onChange=r,this.middleware=new Map;var i=he({plugins:o});Oe(this,i)}return Object(l.a)(e,[{key:"run",value:function(e){var t=this.middleware,n=t[e]||[];S(0!==n.length,"the middleware function ".concat(e," is not found!"));for(var o=Object(k.a)(me)(n),r=arguments.length,c=new Array(r>1?r-1:0),i=1;i<r;i++)c[i-1]=arguments[i];return o.apply(void 0,c)}},{key:"getValue",value:function(e,t){return this.run("getValue",Object(O.a)(Object(O.a)({},t),{},{propKey:e}))}},{key:"change",value:function(e,t){this.onChange(e,t),this.currentModel=e}}]),e}();n(358),n(101);function je(e){return!0===(null!=(t=e)&&"object"===typeof t&&!1===Array.isArray(t))&&"[object Object]"===Object.prototype.toString.call(e);var t}var Te,Ee=function(e){var t,n;return!1!==je(e)&&("function"===typeof(t=e.constructor)&&(!1!==je(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))},ke=n(28);!function(e){e[e.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT",e[e.LEFT_AND_RIGHT=2]="LEFT_AND_RIGHT",e[e.TOP_TO_BOTTOM=3]="TOP_TO_BOTTOM"}(Te||(Te={}));var xe="CONTENT",Se="DESC",Ce="NORMAL",we="EDITING_CONTENT",Re="EDITING_DESC",Ke="SET_TOPIC_BLOCK",De=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"data",get:function(){return this.get("data")}},{key:"type",get:function(){return this.get("type")}}],[{key:"create",value:function(e){return new n(e)}},{key:"createList",value:function(e){if(j.List.isList(e)||Array.isArray(e))return Object(j.List)(e.map(n.create));throw new Error("Block.createList only accepts Array or List, but you passed it: ".concat(e))}}]),n}(Object(j.Record)({type:null,key:null,data:null}));var Le={readOnly:!1,allowUndo:!0,layoutDir:Te.LEFT_AND_RIGHT,theme:{name:"default",randomColor:!0,background:"rgb(57,60,65)",highlightColor:"#50C9CE",marginH:60,marginV:20,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5,lineType:"curve",lineWidth:"3px"},rootTopic:{contentStyle:{fontSize:"34px",borderRadius:"35px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},primaryTopic:{contentStyle:{borderWidth:"1px",borderStyle:"solid",borderRadius:"20px",fontSize:"17px",padding:"10px 15px 10px 15px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},normalTopic:{contentStyle:{border:"1px solid #e8eaec",borderRadius:"20px",fontSize:"17px",padding:"4px 10px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"white"}}}},Ie=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"layoutDir",get:function(){return this.get("layoutDir")}},{key:"readOnly",get:function(){return this.get("readOnly")}},{key:"allowUndo",get:function(){return this.get("allowUndo")}},{key:"theme",get:function(){return this.get("theme")}}],[{key:"fromJSON",value:function(e){return new n(e)}}]),n}(Object(j.Record)(Le));function _e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var Me=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"key",get:function(){return this.get("key")}},{key:"parentKey",get:function(){return this.get("parentKey")}},{key:"collapse",get:function(){return this.get("collapse")}},{key:"subKeys",get:function(){return this.get("subKeys")}},{key:"blocks",get:function(){return this.get("blocks")}},{key:"relations",get:function(){return this.get("relations")}},{key:"style",get:function(){return this.get("style")}},{key:"getBlock",value:function(e){var t=this.blocks.findIndex((function(t){return t.type===e}));return-1===t?{index:t,block:null}:{index:t,block:this.blocks.get(t)}}}],[{key:"fromJSON",value:function(e){var t=e.key,o=e.parentKey,r=void 0===o?null:o,c=e.blocks,i=e.subKeys,a=void 0===i?[]:i,l=e.collapse;return new n({key:t,parentKey:r,collapse:void 0!==l&&l,subKeys:Object(j.List)(a),blocks:De.createList(c)})}},{key:"create",value:function(e){var t=e.key,o=e.parentKey,r=void 0===o?null:o,c=e.content,i=void 0===c?"":c,a=e.subKeys,l=void 0===a?[]:a,u=e.collapse,s=void 0!==u&&u,p=De.create({type:xe,data:i,key:null});return new n({key:t,parentKey:r,blocks:Object(j.List)([p]),subKeys:Object(j.List)(l),collapse:s})}}]),n}(Object(j.Record)({key:null,parentKey:null,collapse:!1,subKeys:null,blocks:null,relations:null,style:null}));y()("modifier");var Ae={topics:Object(j.Map)(),extData:Object(j.Map)(),config:new Ie,rootTopicKey:null,editorRootTopicKey:null,focusKey:null,focusMode:null,formatVersion:null,zoomFactor:1};Object(j.Record)(Ae);y()("core:controller");var Fe=n(44),Pe=n(36),Ne=function(e,t){return(Ne=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function Be(e,t){function n(){this.constructor=e}Ne(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var ze=function(){return(ze=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};var Ve,He,Ge,Ue=y()("node:text-editor"),We=d.default.div(Ge||(Ve=["\n  padding: 6px;\n  background-color: ",";\n  cursor: ",";\n  min-width: 50px;\n"],He=["\n  padding: 6px;\n  background-color: ",";\n  cursor: ",";\n  min-width: 50px;\n"],Object.defineProperty?Object.defineProperty(Ve,"raw",{value:He}):Ve.raw=He,Ge=Ve),(function(e){return e.readOnly?null:"white"}),(function(e){return e.readOnly?"pointer":"text"})),Ze=function(e){function t(t){var n=e.call(this,t)||this;return n.state={content:null},n.onMouseDown=function(e){e.stopPropagation()},n.onMouseMove=function(e){},n.onKeyDown=function(e){},n._handleClick=function(e){!n.root.contains(e.target)&&n.onClickOutSide(e)},n.rootRef=function(e){return function(t){e(t),n.root=t}},n.initState(),n}return Be(t,e),t.prototype.onChange=function(e){var t=e.value;Ue("onChange",t),this.setState({content:t})},t.prototype.componentDidMount=function(){this.props.readOnly||document.addEventListener("click",this._handleClick)},t.prototype.componentWillUnmount=function(){this.props.readOnly||document.removeEventListener("click",this._handleClick)},t.prototype.onClickOutSide=function(e){},t.prototype.getCustomizeProps=function(){return null},t.prototype.getContent=function(){var e=this.getCustomizeProps().block.data;return null==e?null:("string"===typeof e&&(e=Fe.a.deserialize(e)),e)},t.prototype.initState=function(){var e=this.getContent();this.state={content:e}},t.prototype.render=function(){var e=this.props,t=e.topicKey,n=e.saveRef,r=this.getCustomizeProps(),c=r.readOnly,i=r.getRefKeyFunc,a=r.placeholder,l=r.style;Ue(c);var u=i(t),s=c?this.getContent():this.state.content,p=this.onMouseDown,d=this.onMouseMove,f=this.onKeyDown,y={value:s,readOnly:c,onChange:this.onChange.bind(this),placeholder:a,style:l},b={key:u,readOnly:c,ref:this.rootRef(n(u)),onMouseDown:p,onMouseMove:d,onKeyDown:f};return Object(o.createElement)(We,ze({},b),Object(o.createElement)(Pe.Editor,ze({},y,{autoFocus:!0})))},t}(o.PureComponent),Ye=y()("node:topic-content-editor");function Je(e){return"content-editor-"+e}var Xe=function(e){function t(t){var n=e.call(this,t)||this;return n.onKeyDown=function(e){e.nativeEvent.ctrlKey&&"Enter"===e.nativeEvent.code&&n.save()},n}return Be(t,e),t.prototype.getCustomizeProps=function(){var e=this.props,t=e.model,n=e.topicKey,o=e.readOnly;return{block:t.getTopic(n).getBlock(xe).block,readOnly:o,getRefKeyFunc:Je,placeholder:"new",style:{whiteSpace:"pre"}}},t.prototype.onClickOutSide=function(e){Ye("onClickOutSide"),this.save()},t.prototype.save=function(){var e=this.props,t=e.model,n=e.topicKey;t.editingContentKey!==n||this.props.controller.run("operation",ze(ze({},this.props),{opType:Ke,blockType:xe,data:this.state.content,focusMode:Ce}))},t}(Ze),qe=y()("node:topic-desc-editor");function Qe(e){return"desc-editor-"+e}var $e=function(e){function t(t){var n=e.call(this,t)||this;return qe("constructor"),n}return Be(t,e),t.prototype.initState=function(){e.prototype.initState.call(this);var t=this.props,n=t.controller,o="topic-desc-data-"+t.topicKey,r=this.state.content;n.run("setTempValue",{key:o,value:r})},t.prototype.getCustomizeProps=function(){var e=this.props,t=e.model,n=e.topicKey;return{block:t.getTopic(n).getBlock(Se).block,readOnly:t.editingDescKey!==n,getRefKeyFunc:Qe,placeholder:"write topic notes here"}},t.prototype.onChange=function(e){var t=e.value;qe("onChange");var n=this.props,o=n.controller,r=n.topicKey;if(!(n.model.editingDescKey!==r)){var c="topic-desc-data-"+r;o.run("setTempValue",{key:c,value:t}),this.setState({content:t})}},t}(Ze);var et=function(){return{getTopicTitle:function(e){var t=e.model,n=e.controller,o=e.topicKey,r=e.maxLength,c=t.getTopic(o).getBlock(xe).block,i=n.run("serializeBlockData",ze(ze({},e),{block:c}));return null!=r&&(i=i.length>r?i.substr(0,r)+"...":i),i},renderTopicContentEditor:function(e){return Object(o.createElement)(Xe,ze({},e))},renderTopicDescEditor:function(e){return Object(o.createElement)($e,ze({},e))},isBlockEmpty:function(e,t){var n=e.block,o=e.controller;return n.type===xe||n.type===Se?null==n.data||""===o.run("serializeBlockData",e):t()},serializeBlockData:function(e,t){var n=e.block;return n.type===xe||n.type===Se?"string"===typeof n.data?n.data:Fe.a.serialize(n.data):t()}}},tt=n(15),nt=n.n(tt),ot=n(885),rt=n(66),ct=n(20),it=function(e,t){return(it=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function at(e,t){function n(){this.constructor=e}it(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var lt=function(){return(lt=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function ut(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}function st(e,t,n,o){var r,c=arguments.length,i=c<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(c<3?r(i):c>3?r(t,n,i):r(t,n))||i);return c>3&&i&&Object.defineProperty(t,n,i),i}function pt(e){var t="function"===typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function dt(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,c=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(o=c.next()).done;)i.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}return i}function ft(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(dt(arguments[t]));return e}function yt(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var bt,gt,ht,Ot,mt,vt,jt,Tt,Et,kt,xt,St,Ct,wt=function(e){function t(t){return e.call(this,t)||this}return at(t,e),t.prototype.operation=function(e,t){this.props.controller.run("operation",lt({opType:e},t))},t.prototype.run=function(e,t){this.props.controller.run(e,t)},Object.defineProperty(t.prototype,"topic",{get:function(){return this.props.model.getTopic(this.props.topicKey)},enumerable:!0,configurable:!0}),t}(o.PureComponent),Rt=y()("node:drag-scroll-widget"),Kt=d.default.div(bt||(bt=yt(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: scroll;\n"],["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: scroll;\n"]))),Dt=d.default.div(gt||(gt=yt(["\n  position: relative;\n  width: max-content;\n"],["\n  position: relative;\n  width: max-content;\n"]))),Lt=function(e){function t(t){var n=e.call(this,t)||this;return n.contentResizeCallback=function(e,t){if(n.oldContentRect){var o={width:n.content.clientWidth+2*n.viewBox.clientWidth,height:n.content.clientHeight+2*n.viewBox.clientHeight};n.bigView.style.width=o.width+"px",n.bigView.style.height=o.height+"px"}n.oldContentRect=e[0].contentRect},n.contentResizeObserver=new p.a(n.contentResizeCallback),n.contentRef=function(e){e&&(n.content=e,n.contentResizeObserver.observe(n.content))},n.viewBoxRef=function(e){e&&(n.viewBox=e,n.props.enableMouseWheel||(Rt("addEventListener onwheel"),n.viewBox.addEventListener("wheel",(function(e){Rt("onwheel"),(e.ctrlKey||e.altKey)&&e.preventDefault()}),{passive:!1})),n.setViewBoxScroll(n.viewBox.clientWidth,n.viewBox.clientHeight))},n.bigViewRef=function(e){e&&(n.bigView=e)},n.setWidgetStyle=function(){n.content&&n.viewBox&&n.bigView&&(n.bigView.style.width=2*(n.content.clientWidth+n.viewBox.clientWidth)+"px",n.bigView.style.height=2*(n.content.clientHeight+n.viewBox.clientHeight)+"px",n.content.style.left=n.viewBox.clientWidth+"px",n.content.style.top=n.viewBox.clientHeight+"px")},n.setViewBoxScroll=function(e,t){Rt("setViewBoxScroll "+e+" "+t),n.viewBox&&(n.viewBox.scrollLeft=e,n.viewBox.scrollTop=t)},n.setViewBoxScrollDelta=function(e,t){Rt("setViewBoxScrollDelta "+e+" "+t),n.viewBox&&(n.viewBox.scrollLeft+=e,n.viewBox.scrollTop+=t)},n.onMouseDown=function(e){var t=n.props,o=t.mouseKey,r=t.needKeyPressed,c=t.canDragFunc;if((!c||c())&&(0===e.button&&"left"===o||2===e.button&&"right"===o)){if(r&&!e.ctrlKey)return;n._lastCoordX=n.viewBox.scrollLeft+e.nativeEvent.clientX,n._lastCoordY=n.viewBox.scrollTop+e.nativeEvent.clientY;var i=n.viewBox;i.addEventListener("mousemove",n.onMouseMove),i.addEventListener("mouseup",n.onMouseUp)}},n.onMouseUp=function(e){var t=n.viewBox;t.removeEventListener("mousemove",n.onMouseMove),t.removeEventListener("mouseup",n.onMouseUp)},n.onMouseMove=function(e){n.viewBox.scrollLeft=n._lastCoordX-e.clientX,n.viewBox.scrollTop=n._lastCoordY-e.clientY},n.handleContextMenu=function(e){e.preventDefault()},n.state={widgetStyle:{width:"10000px",height:"10000px"}},n}return at(t,e),t.prototype.componentDidMount=function(){this.setWidgetStyle(),document.addEventListener("contextmenu",this.handleContextMenu)},t.prototype.componentWillUnmount=function(){document.removeEventListener("contextmenu",this.handleContextMenu)},t.prototype.setZoomFactor=function(e){this.bigView.style.transform="scale("+e+")",this.bigView.style.transformOrigin="50% 50%"},t.prototype.render=function(){var e=lt({},this.state.widgetStyle);return Object(o.createElement)(Kt,{ref:this.viewBoxRef,onMouseDown:this.onMouseDown},Object(o.createElement)("div",{style:e,ref:this.bigViewRef},Object(o.createElement)(Dt,{ref:this.contentRef,style:this.state.contentStyle},this.props.children(this.setViewBoxScroll,this.setViewBoxScrollDelta))))},t.defaultProps={mouseKey:"left",needKeyPressed:!1},t}(o.Component),It=y()("node:save-ref"),_t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getRef=function(e){return It(t),t[e]},t.saveRef=function(e){return function(n){n&&(t[e]=n,t.fireListener(e,n))}},t.deleteRef=function(e){It("deleteRef:",e),delete t[e]},t.observers=new Map,t.fireListener=function(e,n){var o,r;if(t.observers.has(e)){var c=t.observers.get(e);try{for(var i=pt(c),a=i.next();!a.done;a=i.next()){(0,a.value)(e,n)}}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}}},t.registerRefListener=function(e,n){t.observers.has(e)?t.observers.get(e).push(n):t.observers.set(e,[n])},t}return at(t,e),t.prototype.render=function(){return this.props.children(this.saveRef,this.getRef,this.deleteRef,this.registerRefListener.bind(this))},t}(o.Component),Mt=d.default.div(ht||(ht=yt(["\n  display: flex;\n  flex-direction: ",";\n  align-items: ",";\n  justify-content: ",";\n"],["\n  display: flex;\n  flex-direction: ",";\n  align-items: ",";\n  justify-content: ",";\n"])),(function(e){return e.flexDirection?e.flexDirection:"row"}),(function(e){return e.alignItems}),(function(e){return e.justifyContent})),At=d.default.div(Ot||(Ot=yt(["\n  margin: ",";\n"],["\n  margin: ",";\n"])),(function(e){return e.margin})),Ft=d.default.a(mt||(mt=yt(["\n  font-size: 20px !important;\n"],["\n  font-size: 20px !important;\n"]))),Pt=d.default.div(vt||(vt=yt(["\n  padding: 5px;\n  cursor: pointer;\n"],["\n  padding: 5px;\n  cursor: pointer;\n"]))),Nt=d.default.div(jt||(jt=yt(["\n  cursor: pointer;\n  &:hover {\n    color: #1ea7fd;\n  }\n"],["\n  cursor: pointer;\n  &:hover {\n    color: #1ea7fd;\n  }\n"]))),Bt=Object(d.default)(b.e)(Tt||(Tt=yt(["\n  margin-bottom: 0px !important;\n"],["\n  margin-bottom: 0px !important;\n"]))),zt=Object(d.default)(Nt)(Et||(Et=yt(["\n  position: absolute;\n  right: 5px;\n  top: 5px;\n  //padding: 5px;\n"],["\n  position: absolute;\n  right: 5px;\n  top: 5px;\n  //padding: 5px;\n"]))),Vt=d.default.div(kt||(kt=yt(["\n  height: 16px;\n"],["\n  height: 16px;\n"]))),Ht=d.default.span(xt||(xt=yt(["\n  margin: 0px 10px;\n  &:hover {\n    color: palevioletred;\n  }\n"],["\n  margin: 0px 10px;\n  &:hover {\n    color: palevioletred;\n  }\n"]))),Gt=d.default.div(St||(St=yt(["\n  z-index: ",";\n"],["\n  z-index: ",";\n"])),(function(e){return e.zIndex})),Ut=d.default.div(Ct||(Ct=yt(["\n  min-width: 360px;\n  max-height: 470px;\n  overflow: auto;\n"],["\n  min-width: 360px;\n  max-height: 470px;\n  overflow: auto;\n"]))),Wt=y()("plugin:event");function Zt(){var e={};return{handleTopicClick:function(e){Wt("handleTopicClick");var t=e.controller,n=e.model,o=e.topicKey;Wt(n.zoomFactor),null===n.editingDescKey&&n.editingContentKey!==o&&(n.focusKey===o&&n.focusMode===M||t.run("operation",lt(lt({},e),{opType:X,focusMode:_})))},handleTopicDoubleClick:function(e){var t=e.controller;null===e.model.editingDescKey&&t.run("operation",lt(lt({},e),{opType:X,focusMode:M}))},handleTopicContextMenu:function(e){e.controller.run("operation",lt(lt({},e),{opType:X,focusMode:F}))},handleActiveModalClose:function(e){var t=e.controller,n=t.run("getActiveModalProps",e);return null==n?null:"edit-desc"===n.name?function(){t.run("operation",lt(lt({},e),{focusMode:_,opType:X}))}:void 0},addEventListener:function(t){var n=t.key,o=t.listener,r=t.once,c=t.controller;function i(){o(),c.run("removeEventListener",{key:n,listener:o})}e[n]||(e[n]=[]),r?(i.origin=o,e[n].push(i)):e[n].push(o)},removeEventListener:function(t){var n=t.key,o=t.listener;e[n]&&(e[n]=e[n].filter((function(e){return e!==o&&e.origin!==o})))},fireEvent:function(t){var n=t.key;e[n]&&e[n].forEach((function(e){return e()}))}}}var Yt="show-menu",Jt="close",Xt="color-picker",qt="notes",Qt="plus",$t="minus",en="collapse",tn="expand",nn="center",on="search";function rn(e){return"icon iconfont bm-"+e}function cn(e){return Object(o.createElement)("span",{className:rn(e)})}function an(e){return"content-"+e}function ln(e){return"content-editor-"+e}function un(e){return"desc-editor-"+e}function sn(e){return"topic-widget-"+e}function pn(e){return"topic-"+e}function dn(e){return"links-"+e}function fn(e){return"links-svg-"+e}function yn(e){return"collapse-"+e}function bn(e,t){return"dropArea-"+t+"-"+e}var gn="DIAGRAM-ROOT",hn="DragScrollWidget",On="svg-highlight",mn="focus-highlight",vn="drop-effect",jn="CENTER_ROOT_TOPIC",Tn="DIAGRAM_CUSTOMIZE_BASE_Z_INDEX",En="TOPIC_CONTEXT_MENU_ENABLED",kn="TOPIC_TITLE",xn=function(e){e.stopPropagation()};function Sn(e,t){!function(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.click()}("data:text/plain,"+encodeURIComponent(e),t)}function Cn(e){var t=document.createElement("input");return t.type="file",t.accept=e,new Promise((function(e,n){t.addEventListener("change",(function(t){var o=t.target.files[0],r=new FileReader;r.onload=function(t){var n=t.target.result;e(n)},r.onerror=function(e){n(e.target.error)},r.readAsText(o)})),t.click()}))}function wn(e){var t=e.top,n=void 0===t?0:t,o=e.right,r=void 0===o?0:o,c=e.bottom,i=void 0===c?0:c,a=e.left;return n+"px "+r+"px "+i+"px "+(void 0===a?0:a)+"px"}function Rn(e){return(e.top+e.bottom)/2}function Kn(e,t){return(e.x+t.x)/2}function Dn(e,t){return(e.y+t.y)/2}function Ln(e){return[(e.left+e.right)/2,(e.top+e.bottom)/2]}function In(e,t,n){void 0===n&&(n=1);var o=e.getBoundingClientRect(),r=Ln(t.getBoundingClientRect()),c=Ln(o);c[0]=(c[0]-r[0])/n,c[1]=(c[1]-r[1])/n;var i=o.width/n,a=o.height/n;return{left:c[0]-i/2,right:c[0]+i/2,top:c[1]-a/2,bottom:c[1]+a/2,width:i,height:a}}function _n(e,t){var n=e.getBoundingClientRect(),o=Ln(t.getBoundingClientRect()),r=Ln(n);return[r[0]-o[0],r[1]-o[1]]}var Mn="ADD_CHILD",An="ADD_SIBLING",Fn="DELETE_TOPIC",Pn="EDIT_CONTENT",Nn="EDIT_NOTES",Bn="SET_EDITOR_ROOT";function zn(){return{customizeHotKeys:function(e){var t=function(t){return function(n){!function(e,t){var n=t.topicKey,o=t.model,r=t.controller;void 0===n&&(t=lt(lt({},t),{topicKey:o.focusKey})),r.run("operation",lt(lt({},t),{opType:e}))}(t,e)}};return{topicHotKeys:new Map([[Mn,{label:"add child",combo:"tab",onKeyDown:t(Z)}],[An,{label:"add sibling",combo:"enter",onKeyDown:t(Y)}],[Fn,{label:"delete topic",combo:"del",onKeyDown:t(J)}],[Pn,{label:"edit content",combo:"space",onKeyDown:t(ne)}],[Nn,{label:"edit notes",combo:"alt + d",onKeyDown:t(oe)}],[Bn,{label:"set editor root",combo:"alt + shift + f",onKeyDown:t(ce)}]]),globalHotKeys:new Map}}}}var Vn=y()("plugin:operation");function Hn(){var e=new Map([[H,be.toggleCollapse],[G,be.collapseAll],[U,be.expandAll],[W,be.expandTo],[Z,be.addChild],[Y,be.addSibling],[J,be.deleteTopic],[X,be.focusTopic],[q,be.setFocusMode],[Q,be.setStyle],[$,be.setTheme],[ee,be.setBlockData],[te,be.deleteBlock],[ne,function(e){var t=e.model,n=e.topicKey;return be.focusTopic({model:t,topicKey:n,focusMode:M})}],[oe,function(e){var t=e.model,n=e.topicKey,o=t.getTopic(n).getBlock(I);return null!=o.block&&null!=o.block.data||(t=be.setBlockData({model:t,topicKey:n,blockType:I,data:""})),t=be.focusTopic({model:t,topicKey:n,focusMode:A})}],[re,function(e){var t=e.srcKey,n=e.dstKey,o=e.dropDir,r=e.model,c=r.getTopic(t),i=r.getTopic(n),a=c.parentKey,l=r.getTopic(a).subKeys,u=l.indexOf(t);if(l=l.delete(u),"in"===o){var s=i.subKeys;s=s.push(t),r=r.withMutations((function(e){e.setIn(["topics",a,"subKeys"],l).setIn(["topics",t,"parentKey"],n).setIn(["topics",n,"subKeys"],s).setIn(["topics",n,"collapse"],!1)}))}else{var p=i.parentKey,d=r.getTopic(p).subKeys,f=d.indexOf(n);if(a===p){var y=Object(j.List)();d.forEach((function(e){e!==t&&(y=e===n?"prev"===o?y.push(t).push(e):y.push(e).push(t):y.push(e))})),r=r.withMutations((function(e){e.setIn(["topics",p,"subKeys"],y)}))}else"prev"===o?d=d.insert(f,t):"next"===o&&(d=d.insert(f+1,t)),r=r.withMutations((function(e){e.setIn(["topics",a,"subKeys"],l).setIn(["topics",t,"parentKey"],p).setIn(["topics",p,"subKeys"],d).setIn(["topics",p,"collapse"],!1)}))}return r}],[ce,be.setEditorRootTopicKey]]),t=Object(j.Stack)(),n=Object(j.Stack)(),o=!0,r=new Set;return{isOperationEnabled:function(e){return o},enableOperation:function(){o=!0},disableOperation:function(e){var t=e.whiteList;o=!1,t?r=new Set(t):r.clear()},getOpMap:function(t){return e},getAllowUndo:function(e){var t=e.model,n=e.opType;if(n)switch(n){case X:case ne:case oe:return!1}switch(t.focusMode){case"EDITING_DESC":case"EDITING_CONTENT":return!1}return t.config.allowUndo},getUndoRedoStack:function(){return{undoStack:t,redoStack:n}},setUndoStack:function(e){Vn("setUndoStack",e.undoStack),t=e.undoStack},setRedoStack:function(e){Vn("setRedoStack",e.redoStack),n=e.redoStack},canUndo:function(e){var t=e.controller,n=t.run("getUndoRedoStack",e).undoStack,o=t.run("getAllowUndo",e);return n.size>0&&o},canRedo:function(e){var t=e.controller,n=t.run("getUndoRedoStack",e).redoStack,o=t.run("getAllowUndo",e);return n.size>0&&o},undo:function(e){var t=e.controller,n=e.model;if(t.run("getAllowUndo",e)){var o=t.run("getUndoRedoStack",e),r=o.undoStack,c=o.redoStack,i=r.peek();i&&(t.run("setUndoStack",lt(lt({},e),{undoStack:r.shift()})),t.run("setRedoStack",lt(lt({},e),{redoStack:c.push(n)})),Vn(i),t.change(i))}},redo:function(e){var t=e.controller,n=e.model;if(t.run("getAllowUndo",e)){var o=t.run("getUndoRedoStack",e),r=o.undoStack,c=o.redoStack,i=c.peek();i&&(t.run("setUndoStack",lt(lt({},e),{undoStack:r.push(n)})),t.run("setRedoStack",lt(lt({},e),{redoStack:c.shift()})),t.change(i))}},operation:function(e){var t=e.controller,n=e.opType,o=e.model,c=e.opArray,i=e.callback;if(null!=c&&!Array.isArray(c))throw new Error("operation: the type of opArray must be array!");if(null!=n&&null!=c)throw new Error("operation: opType and opArray conflict!");if(!t.run("isOperationEnabled",e)){if(0===r.size)return;if(null!=c){var a=c.filter((function(e){return!r.has(e.opType)}));if(a&&a.length>0)return}else if(!r.has(n))return}Vn("operation:",n),Vn("operation:",o),Vn("operation:",e);var l,u=t.run("getOpMap",e);if(t.run("beforeOperation",e),t.run("getAllowUndo",e)){var s=t.run("getUndoRedoStack",e).undoStack;t.run("setUndoStack",lt(lt({},e),{undoStack:s.push(o)}))}if(null!=c)l=c.reduce((function(e,n){var o=n.opType;if(!u.has(o))throw new Error("opType:"+o+" not exist!");var r=u.get(o),c=lt(lt({controller:t},n),{model:e}),i=t.run("beforeOpFunction",c);return i=r(lt(lt({},c),{model:i})),i=t.run("afterOpFunction",lt(lt({},c),{model:i}))}),o);else{if(!u.has(n))throw new Error("opType:"+n+" not exist!");var p=u.get(n);l=t.run("beforeOpFunction",e),l=p(lt(lt({},e),{model:l})),l=t.run("afterOpFunction",lt(lt({},e),{model:l}))}Vn("newModel:",l),t.change(l,i),t.run("afterOperation",e)},deleteRefKey:function(e){var t,n,o=e.model,r=e.topicKey,c=e.deleteRef,i=pe(o,r);i.push(r);try{for(var a=pt(i),l=a.next();!l.done;l=a.next()){var u=l.value;c(dn(u)),c(fn(u)),c(an(u)),c(ln(u)),c(un(u)),c(sn(u)),c(pn(u)),c(yn(u)),c(bn(u,"next")),c(bn(u,"prev"))}}catch(s){t={error:s}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}},beforeOperation:function(e){},afterOperation:function(e){},beforeOpFunction:function(e){var t=e.controller,n=e.opType,o=e.model,r=e.topicKey;return n===J&&r!==o.editorRootTopicKey&&t.run("deleteRefKey",e),o},afterOpFunction:function(e){return e.model}}}var Gn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return at(t,e),t.prototype.render=function(){var e=this.props.controller;return Object(o.createElement)(b.n,null,e.run("customizeTopicContextMenu",this.props))},t}(wt),Un=[{icon:"edit",label:"edit",shortcut:"Space",rootCanUse:!0,opType:ne},{icon:"add-sibling",label:"add sibling",shortcut:"Enter",opType:Y},{icon:"add-child",label:"add child",shortcut:"Tab",rootCanUse:!0,opType:Z},{icon:"notes",label:"edit notes",shortcut:"Alt + D",rootCanUse:!0,opType:oe},{icon:"delete-node",label:"delete node",shortcut:"Del",opType:J},{icon:"root",label:"set as editor root",shortcut:"Alt + Shift + F",opType:ce}];var Wn,Zn,Yn=y()("node:topic-drop-effect"),Jn=d.default.svg(Wn||(Wn=yt(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"],["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"]))),Xn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={content:null},t}return at(t,e),t.prototype.layout=function(){var e=this.props,t=this.props,n=t.getRef,r=t.model,c=t.zoomFactor,i=t.controller.run("getDragTargetProps",e),a=i.key,l=i.dropDir;if(Yn("layout",l),null!==a){var u=n("in"===l?an(a):bn(a,l)),s=n("svg-drop-effect"),p=n(hn).bigView,d=In(u,p,c),f=In(s,p,c),y=d.left-f.left-3,b=d.top-f.top-3,g=d.width+6,h=d.height+6;this.setState({content:Object(o.createElement)("g",null,Object(o.createElement)("rect",{x:y,y:b,width:g,height:h,fill:"none",stroke:r.config.theme.highlightColor,strokeDasharray:"5,5",strokeWidth:2}))})}else this.setState({content:null})},t.prototype.render=function(){var e=this.props.saveRef;return Object(o.createElement)(Jn,{ref:e("svg-drop-effect")},this.state.content)},t}(wt),qn=y()("plugin:drag-and-drop"),Qn=d.default.div(Zn||(Zn=yt(["\n  height: ",";\n  width: 100%;\n  margin: 5px 0px;\n"],["\n  height: ",";\n  width: 100%;\n  margin: 5px 0px;\n"])),(function(e){return e.height+"px"}));function $n(){var e=null,t=null;return{renderTopicDropArea:function(e){var t=e.topicKey,n=e.dropDir,r=e.saveRef,c=e.controller,i=e.model,a={onDragEnter:function(o){qn("onDragEnter",t,n),c.run("handleTopicDragEnter",lt(lt({},e),{ev:o,dropDir:n}))},onDragLeave:function(o){qn("onDragLeave",t,n),c.run("handleTopicDragLeave",lt(lt({},e),{ev:o,dropDir:n}))},onDragOver:function(e){e.preventDefault()},onDrop:function(o){qn("onDrop",t,n),c.run("handleTopicDrop",lt(lt({},e),{ev:o,dropDir:n}))}};return Object(o.createElement)(Qn,lt({height:i.config.theme.marginV/2,ref:r(bn(t,n))},a))},renderDragAndDropEffect:function(e){qn("renderDragAndDropEffect");var t=e.saveRef;return Object(o.createElement)(Xn,lt({ref:t(vn)},e))},getDragTargetProps:function(n){return{key:e,dropDir:t}},handleTopicDragStart:function(e){var t=e.controller;e.ev.stopPropagation(),t.run("operation",lt(lt({},e),{opType:X,focusMode:P}))},canDrop:function(e){var t=e.srcKey,n=e.dstKey,o=e.model,r=e.dropDir;return t!==o.editorRootTopicKey&&t!==n&&de(o,t,n)!==N&&((n!==o.editorRootTopicKey||"in"===r)&&(o.getTopic(t).parentKey!==n||"in"!==r))},handleTopicDragEnter:function(n){var o=n.dropDir,r=n.topicKey,c=n.controller,i=n.model;qn("handleTopicDragEnter:",r,o),c.run("canDrop",lt(lt({},n),{srcKey:i.focusKey,dstKey:r}))&&(e=r,t=o,c.change(i))},handleTopicDragLeave:function(n){var o=n.controller,r=n.model,c=n.topicKey,i=n.dropDir,a=n.getRef,l=n.ev.nativeEvent.relatedTarget;qn("handleTopicDragLeave:",c,i);var u=a(an(c));u==l||u.contains(l)||(e=null,t=null,o.change(r))},handleTopicDrop:function(n){qn("handleTopicDrop");var o=n.controller,r=n.topicKey,c=n.model;n=lt(lt({},n),{srcKey:c.focusKey,dstKey:r}),e=null,t=null,o.run("canDrop",n)&&o.run("operation",lt(lt({},n),{opType:re}))}}}var eo,to,no,oo,ro,co,io,ao,lo,uo,so,po=Object(d.default)(Gt)(eo||(eo=yt(["\n  position: absolute;\n  width: 20%;\n  padding: 0 5px;\n  background: white;\n  left: 30px;\n  top: 20px;\n  border-radius: 2px;\n"],["\n  position: absolute;\n  width: 20%;\n  padding: 0 5px;\n  background: white;\n  left: 30px;\n  top: 20px;\n  border-radius: 2px;\n"]))),fo=d.default.div(to||(to=yt(["\n  max-width: 600px;\n"],["\n  max-width: 600px;\n"]))),yo=d.default.span(no||(no=yt([""],[""]))),bo=function(e){function t(t){var n=e.call(this,t)||this;return n.setEditorRootTopicKey=function(e){return function(){var t=n.props,o=t.model,r=t.controller;o.editorRootTopicKey!==e&&r.change(be.setEditorRootTopicKey({model:o,topicKey:e}))}},n.breadcrumbRenderer=function(e){var t=e.text,n=ut(e,["text"]),r=t.length>8,c=r?t.substr(0,8)+"...":t,i={content:Object(o.createElement)(fo,null,t),position:b.u.BOTTOM_RIGHT},a=Object(o.createElement)(b.b,lt({},n),Object(o.createElement)(yo,null,c));return r?Object(o.createElement)(b.x,lt({},i),a):a},n.state={show:!1},n}return at(t,e),t.prototype.render=function(){var e=this.props,t=e.model,n=e.controller,r=e.zIndex,c=t.editorRootTopicKey;if(c===t.rootTopicKey)return null;for(var i=[],a=t.getTopic(c);null!=a;){var l=n.getValue(kn,lt(lt({},e),{topicKey:a.key}));i.unshift({text:l,onClick:this.setEditorRootTopicKey(a.key)}),a=t.getTopic(a.parentKey)}var u={items:i,breadcrumbRenderer:this.breadcrumbRenderer};return Object(o.createElement)(po,{zIndex:r},Object(o.createElement)(b.c,lt({},u)))},t}(wt),go=d.default.div(oo||(oo=yt(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 5px;\n"],["\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 5px;\n"]))),ho=d.default.div(ro||(ro=yt(["\n  width: 100%;\n  height: 100%;\n  background: ",";\n"],["\n  width: 100%;\n  height: 100%;\n  background: ",";\n"])),(function(e){return e.theme.background})),Oo=function(e){function t(t){var n=e.call(this,t)||this;return n.setZoomFactor=function(e){n.dragScrollWidget.setZoomFactor(e)},n.onWheel=function(e){if(e.altKey||e.ctrlKey){var t=n.props.controller,o=t.run("getZoomFactor",n.props);(o-=e.nativeEvent.deltaY>0?.1:-.1)<.5&&(o=.5),o>4&&(o=4),t.run("setZoomFactor",lt(lt({},n.props),{zoomFactor:o}))}},n}return at(t,e),t.prototype.renderHotkeys=function(){var e=this.props,t=e.controller,n=e.model,r=t.run("customizeHotKeys",e);if(null===r)return null;if(!(r.topicHotKeys instanceof Map&&r.globalHotKeys instanceof Map))throw new TypeError("topicHotKeys and globalHotKeys must be a Map");var c=[];return n.focusMode!==_&&n.focusMode!==F||r.topicHotKeys.forEach((function(e,t){c.push(Object(o.createElement)(b.j,lt({key:t},e,{global:!0})))})),r.globalHotKeys.forEach((function(e,t){c.push(Object(o.createElement)(b.j,lt({key:t},e,{global:!0})))})),Object(o.createElement)(b.k,null,c)},t.prototype.componentDidMount=function(){var e=this.props,t=e.getRef,n=e.model;e.controller.run("addZoomFactorChangeEventListener",lt(lt({},this.props),{listener:this.setZoomFactor}));var o=t(pn(n.editorRootTopicKey)),r=t("node-layer"),c=o.getBoundingClientRect(),i=r.getBoundingClientRect();this.dragScrollWidget.setViewBoxScrollDelta(0,c.top-i.top-this.dragScrollWidget.viewBox.getBoundingClientRect().height/2+c.height),this.layout()},t.prototype.componentWillUnmount=function(){this.props.controller.run("removeZoomFactorChangeEventListener",lt(lt({},this.props),{listener:this.setZoomFactor}))},Object.defineProperty(t.prototype,"dragScrollWidget",{get:function(){return this.props.getRef(hn)},enumerable:!0,configurable:!0}),t.prototype.componentDidUpdate=function(){this.props.controller.run("fireEvent",lt(lt({},this.props),{key:jn})),this.layout()},t.prototype.layout=function(){this.props.controller.run("layout",this.props)},t.prototype.render=function(){var e=this,t=this.props,n=t.saveRef,r=t.model,c=t.controller,i=r.editorRootTopicKey;return Object(o.createElement)(ho,{onWheel:this.onWheel},Object(o.createElement)(Lt,lt({},this.state,{enableMouseWheel:!1,zoomFactor:r.zoomFactor,ref:n(hn)}),(function(t,r){var a=lt(lt({},e.props),{topicKey:i,setViewBoxScroll:t,setViewBoxScrollDelta:r});return Object(o.createElement)(go,{ref:n("node-layer")},c.run("renderRootWidget",a))})))},t=st([b.l],t)}(o.Component),mo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClose=function(){var e=t.props.controller.run("handleActiveModalClose",t.props);e&&e()},t}return at(t,e),t.prototype.render=function(){var e=this.props.controller,t=e.run("renderModal",this.props),n=e.run("getActiveModalProps",this.props);return Object(o.createElement)(b.g,{onClose:this.handleClose,isOpen:null!==t,autoFocus:!0,enforceFocus:!0,usePortal:!0,title:n&&n.title,style:n&&n.style},Object(o.createElement)("div",{className:g.a.DIALOG_BODY,style:{minHeight:0}},t))},t}(wt),vo=d.default.svg(co||(co=yt(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"],["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"]))),jo=y()("node:root-sub-links"),To=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={curves:[]},t}return at(t,e),t.prototype.layout=function(){var e,t,n,r=this.props,c=r.model,i=r.getRef,a=r.topicKey,l=r.zoomFactor,u=r.controller,s=c.getTopic(a),p=i(an(a)),d=i(fn(a)),f=i(hn).bigView,y=In(p,f,l),b=In(d,f,l);e={x:(n=y,(n.left+n.right)/2-b.left),y:Rn(y)-b.top};var g=[];s.subKeys.forEach((function(n){var c,a=u.run("getLinkStyle",lt(lt({},r),{topicKey:n})),s=a.lineType,p=In(i(an(n)),f,l);if(t={x:(t=p.left>y.right?{x:p.left,y:Rn(p)}:{x:p.right,y:Rn(p)}).x-b.left,y:t.y-b.top},"curve"===s)c="M "+e.x+" "+e.y+" C "+e.x+" "+Dn(e,t)+" "+Kn(e,t)+" "+t.y+" "+t.x+" "+t.y;else if("line"===s)c="M "+e.x+" "+e.y+" L "+t.x+" "+t.y;else if("round"===s){var d=t.y>e.y?1:-1,h=t.x>e.x?1:-1,O=a.lineRadius;if(null==O)throw new Error("link line type is round, but lineRadius is not provided!");c=t.y===e.y?"M "+e.x+" "+e.y+" H "+t.x:"M "+e.x+" "+e.y+"  V "+(t.y-d*O)+" A "+O+" "+O+" 0 0 "+(d*h===1?0:1)+" "+(e.x+O*h)+" "+t.y+" H "+t.x}g.push(Object(o.createElement)("path",{key:"link-"+n,d:c,strokeWidth:a.lineWidth,stroke:a.lineColor,fill:"none"}))})),this.setState({curves:g})},t.prototype.render=function(){jo("render");var e=this.props,t=e.topicKey,n=e.saveRef;return Object(o.createElement)(vo,{ref:n(fn(t))},Object(o.createElement)("g",null,this.state.curves))},t}(wt),Eo=y()("RootNode"),ko=d.default.div(io||(io=yt(["\n  display: flex;\n  position: relative;\n\n  align-items: ",";\n  flex-direction: column;\n\n  padding: ",";\n"],["\n  display: flex;\n  position: relative;\n\n  align-items: ",";\n  flex-direction: column;\n\n  padding: ",";\n"])),(function(e){return e.topicDirection===C?"flex-end":"flex-start"}),(function(e){return e.topicDirection===C?"15px 60px 15px 0px":"15px 0px 15px 60px"})),xo=d.default.div(ao||(ao=yt(["\n  display: flex;\n  position: relative;\n  align-items: center;\n  z-index: 3;\n"],["\n  display: flex;\n  position: relative;\n  align-items: center;\n  z-index: 3;\n"]))),So=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return at(t,e),t.prototype.renderPartTopics=function(e,t){var n=this.props,r=n.controller,c=n.saveRef,i=r.run("createSubTopics",lt(lt({},this.props),{dir:t,isRoot:!0,topics:e}));if(!i)return null;var a=i.subTopics,l="bm-layer-"+(t===C?"left":"right");return Object(o.createElement)(ko,{topicDirection:t,ref:c(l)},a)},t.prototype.render=function(){Eo("render");var e=this.props,t=e.model,n=e.topicKey,r=e.saveRef,c=e.controller,i=c.run("getTopicContentStyle",e),a=t.config,l=c.run("renderTopicContent",lt(lt({},e),{topicStyle:i,dir:R})),u=c.run("getPartTopics",{layout:a.layoutDir,model:t,topicKey:n}),s=Object(o.createElement)(xo,{ref:r(pn(n))},l),p=c.run("renderRootWidgetOtherChildren",e);switch(a.layoutDir){case x.LEFT_AND_RIGHT:return Object(o.createElement)(o.Fragment,null,this.renderPartTopics(u.L,"L"),s,this.renderPartTopics(u.R,"R"),p);case x.LEFT_TO_RIGHT:return Object(o.createElement)(o.Fragment,null,s,this.renderPartTopics(u.R,"R"),p);case x.RIGHT_TO_LEFT:return Object(o.createElement)(o.Fragment,null,this.renderPartTopics(u.L,"L"),s,p);case x.TOP_TO_BOTTOM:return Object(o.createElement)(o.Fragment,null,s,this.renderPartTopics(u.B,"B"),p)}return null},t}(o.Component),Co=d.default.div(so||(so=yt(["\n  position: absolute;\n  top: calc(50% - 10px);\n  ",";\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  //@ts-ignore\n  background: ",";\n  cursor: pointer;\n  padding: 0;\n  font-size: 14px;\n  line-height: 20px;\n  border: 0;\n  z-index: 2;\n"],["\n  position: absolute;\n  top: calc(50% - 10px);\n  ",";\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  //@ts-ignore\n  background: ",";\n  cursor: pointer;\n  padding: 0;\n  font-size: 14px;\n  line-height: 20px;\n  border: 0;\n  z-index: 2;\n"])),(function(e){var t=e.dir;return t===w?Object(d.css)(lo||(lo=yt(["\n        right: -25px;\n      "],["\n        right: -25px;\n      "]))):t===C?Object(d.css)(uo||(uo=yt(["\n        left: -25px;\n      "],["\n        left: -25px;\n      "]))):void 0}),(function(e){return e.background}));function wo(e){var t,n=e.model,r=e.topicKey,c=e.topicStyle,i=e.dir,a=e.saveRef,l=e.onClickCollapse,u=n.getTopic(r);return u.subKeys.size>0?Object(o.createElement)(Co,{ref:a(yn(r)),onClick:l,background:c.background,dir:i,className:nt()((t={icon:!0,iconfont:!0},t["bm-"+(u.collapse?"plus":"minus")]=!0,t))}):null}var Ro,Ko,Do=y()("node:topic-content2"),Lo=d.default.div(Ro||(Ro=yt(["\n  position: relative;\n"],["\n  position: relative;\n"]))),Io=d.default.div(Ko||(Ko=yt(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: auto;\n  z-index: 10;\n  color: black;\n"],["\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: auto;\n  z-index: 10;\n  color: black;\n"]))),_o=function(e){Do("cancelEvent"),e.preventDefault(),e.stopPropagation()};function Mo(e){var t,n=e.controller,r=e.model,c=e.topicKey,i=e.getRef,a=r.editingContentKey!==c,l=n.run("renderTopicContentEditor",lt(lt({},e),{readOnly:a}));if(a)t=l;else{var u,s={width:50,height:40},d=i("content-editor-"+c);d&&(s=d.getBoundingClientRect());var f=new p.a((function(e,t){var n=e[0].contentRect;u.style.left=(s.width-n.width)/2+"px",u.style.top=(s.height-n.height)/2+"px"}));Do(s),t=Object(o.createElement)(o.Fragment,null,Object(o.createElement)("div",{style:{width:s.width,height:s.height}}),Object(o.createElement)(Io,{ref:function(e){e&&(u=e,f.observe(u))}},l))}return Object(o.createElement)(Lo,{onDragEnter:_o,onDragOver:_o},t)}var Ao,Fo,Po,No=y()("node:topic-content-widget"),Bo=d.default.div(Ao||(Ao=yt(["\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  //overflow: hidden;\n  position: relative;\n"],["\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  //overflow: hidden;\n  position: relative;\n"]))),zo=d.default.div(Fo||(Fo=yt(["\n  position: relative;\n"],["\n  position: relative;\n"]))),Vo=function(e){function t(t){var n=e.call(this,t)||this;return n.onDragStart=function(e){n.run("handleTopicDragStart",lt(lt({},n.props),{ev:e}))},n.onDragOver=function(e){e.preventDefault()},n.onDragEnter=function(e){No("onDragEnter",n.props.topicKey),n.run("handleTopicDragEnter",lt(lt({},n.props),{ev:e,dropDir:"in"}))},n.onDragLeave=function(e){n.run("handleTopicDragLeave",lt(lt({},n.props),{ev:e,dropDir:"in"}))},n.onDrop=function(e){No("onDrop"),n.run("handleTopicDrop",lt(lt({},n.props),{ev:e,dropDir:"in"}))},n.onClick=function(e){var t=n.props.controller;n.handleTopicClickTimeout=setTimeout((function(){t.run("handleTopicClick",lt(lt({},n.props),{ev:e}))}),200)},n.onDoubleClick=function(e){clearTimeout(n.handleTopicClickTimeout),n.props.controller.run("handleTopicDoubleClick",lt(lt({},n.props),{ev:e}))},n.needRelocation=!1,n.onClickCollapse=function(e){e.stopPropagation();var t=n.props,o=t.topicKey,r=t.getRef;n.needRelocation=!0;var c=r(yn(o)).getBoundingClientRect();No("oldRect",c),n.oldCollapseIconVector=[c.left+c.width/2,c.top+c.height/2],No("oldCollapseIconVector",n.oldCollapseIconVector),n.operation(H,n.props)},n.state={dragEnter:!1},n}return at(t,e),t.prototype.renderContextMenu=function(){var e=this.props.controller;if(e.getValue(En,lt({},this.props)))return this.operation(X,lt(lt({},this.props),{focusMode:F})),e.run("renderTopicContextMenu",this.props)},t.prototype.onContextMenuClose=function(){},t.prototype.componentDidUpdate=function(){if(this.needRelocation){var e=this.props,t=e.getRef,n=e.topicKey,o=e.setViewBoxScrollDelta,r=t(yn(n)).getBoundingClientRect(),c=[r.left+r.width/2,r.top+r.height/2];No("newVector:",c),No("oldVector:",this.oldCollapseIconVector);var i=[c[0]-this.oldCollapseIconVector[0],c[1]-this.oldCollapseIconVector[1]];No("vector",i),o(i[0],i[1]),this.needRelocation=!1}},t.prototype.render=function(){var e=this.props,t=e.saveRef,n=e.topicKey,r=e.model,c=e.controller,i=e.topicStyle,a=e.dir;No("render",n,r.focusMode);var l=c.run("isOperationEnabled",e)&&r.editingContentKey!==n,u=c.run("renderTopicCollapseIcon",lt(lt({},e),{onClickCollapse:this.onClickCollapse.bind(this)})),s=c.run("renderTopicDropArea",lt(lt({},e),{dropDir:"prev"})),p=c.run("renderTopicDropArea",lt(lt({},e),{dropDir:"next"})),d={onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDragOver:this.onDragOver,onDrop:this.onDrop};return Object(o.createElement)(zo,null,s,Object(o.createElement)(Bo,lt({style:i,draggable:l,ref:t(an(n)),onDragStart:this.onDragStart,onClick:this.onClick,onDoubleClick:this.onDoubleClick},d),c.run("renderTopicBlocks",e),c.run("renderTopicContentOthers",e)),p,a!==R&&u)},t=st([b.f],t)}(wt),Ho=y()("node:topic-desc"),Go=d.default.div(Po||(Po=yt(["\n  overflow: auto;\n"],["\n  overflow: auto;\n"])));function Uo(e){var t=e.controller,n=e.model,r=e.topicKey,c=e.getRef,i=n.editingDescKey===r;Ho("isEditing",i);var a=n.getTopic(r).getBlock(I);if(!i&&t.run("isBlockEmpty",lt(lt({},e),{block:a.block})))return null;var l=t.run("renderTopicDescEditor",e),u=c(gn),s={maxWidth:"800px",maxHeight:"600px"};if(u){var p=u.getBoundingClientRect();s.maxWidth=.6*p.width+"px",s.maxHeight=.8*p.height+"px"}var d={autoFocus:!1,content:Object(o.createElement)(Go,{onClick:xn,classname:g.a.POPOVER_DISMISS,style:s},l),target:Object(o.createElement)(Ht,{onClick:function(n){n.stopPropagation(),t.run("operation",lt(lt({},e),{opType:oe}))},className:rn(qt),tabIndex:-1}),interactionKind:b.t.HOVER,hoverOpenDelay:500};return a.block&&Object(o.createElement)(b.s,lt({},d))}var Wo,Zo,Yo,Jo,Xo,qo,Qo,$o,er,tr=d.default.svg(Wo||(Wo=yt(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"],["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"]))),nr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={content:null},t}return at(t,e),t.prototype.layout=function(){var e=this.props,t=e.getRef,n=e.model,r=e.zoomFactor,c=n.focusKey,i=n.focusMode;if(c&&i!==M){var a=t(an(c)),l=t(hn).bigView,u=t(On),s=In(a,l,r),p=In(u,l,r),d=s.left-p.left-3,f=s.top-p.top-3,y=s.width+6,b=s.height+6;this.setState({content:Object(o.createElement)("rect",{x:d,y:f,width:y,height:b,fill:"none",stroke:n.config.theme.highlightColor,strokeWidth:2})})}else this.setState({content:null})},t.prototype.render=function(){var e=this.props.saveRef;return Object(o.createElement)(tr,{ref:e(On)},this.state.content)},t}(wt),or=d.default.svg(Zo||(Zo=yt(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"],["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"]))),rr=y()("node:topic-sub-links"),cr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={curves:[]},t}return at(t,e),t.prototype.layout=function(){var e,t,n,r=this.props,c=r.model,i=r.getRef,a=r.topicKey,l=r.dir,u=r.controller,s=u.run("getZoomFactor",r),p=c.getTopic(a),d=i(an(a)),f=i(fn(a)),y=i(yn(a)),b=i(hn).bigView,g=In(f,b,s),h=In(y,b,s),O=In(d,b,s);rr(a),rr("svgRect",g),rr("collapseRect",h),rr("contentRect",O),l===w?(e={x:0,y:Rn(O)-g.top},t={x:h.right-g.left+10,y:e.y}):l===C&&(e={x:g.right-g.left,y:Rn(O)-g.top},t={x:h.left-g.left-10,y:e.y});var m=[];p.subKeys.forEach((function(c){var a,d=u.run("getLinkStyle",lt(lt({},r),{topicKey:c})),f=i(an(c));if(f){var y=In(f,b,s);l===w&&(n={x:y.left-g.left,y:Rn(y)-g.top}),l===C&&(n={x:y.right-g.left,y:Rn(y)-g.top});var h=d.lineType;if("curve"===h)a="M "+e.x+" "+e.y+" L "+t.x+" "+t.y+" C "+t.x+" "+Dn(t,n)+" "+Kn(t,n)+" "+n.y+" "+n.x+" "+n.y;else if("round"===h){var O=n.y>e.y?1:-1,v=n.x>e.x?1:-1,j=d.lineRadius;a=1===p.subKeys.size||Math.abs(n.y-e.y)<=1?"M "+e.x+" "+e.y+" L "+n.x+" "+n.y:"M "+e.x+" "+e.y+" H "+t.x+" V "+(n.y-O*j)+" A "+j+" "+j+" 0 0 "+(O*v===1?0:1)+" "+(t.x+j*v)+" "+n.y+" H "+n.x}else"line"===h&&(a="M "+e.x+" "+e.y+" H "+t.x+" L "+n.x+" "+n.y);m.push(Object(o.createElement)("path",{key:"link-"+c,d:a,strokeWidth:d.lineWidth,stroke:d.lineColor,fill:"none"}))}})),this.setState({curves:m})},t.prototype.render=function(){var e=this.props,t=e.topicKey,n=e.saveRef;return Object(o.createElement)(or,{ref:n(fn(t))},Object(o.createElement)("g",null,this.state.curves))},t}(wt),ir=y()("node:topic-widget"),ar=d.default.div(Yo||(Yo=yt(["\n  display: flex;\n  align-items: center;\n  flex-direction: ",";\n"],["\n  display: flex;\n  align-items: center;\n  flex-direction: ",";\n"])),(function(e){return e.topicDirection===w?"row":"row-reverse"})),lr=d.default.div(Jo||(Jo=yt(["\n  position: relative;\n  padding: ",";\n"],["\n  position: relative;\n  padding: ",";\n"])),(function(e){return e.dir===w?"0 0 0 "+e.marginH+"px":"0 "+e.marginH+"px 0 0"})),ur=d.default.div(Xo||(Xo=yt(["\n  display: flex;\n  position: relative;\n  align-items: center;\n\n  flex-direction: ",";\n"],["\n  display: flex;\n  position: relative;\n  align-items: center;\n\n  flex-direction: ",";\n"])),(function(e){return e.topicDirection===w?"row":"row-reverse"})),sr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return at(t,e),t.prototype.renderSubTopics=function(){var e=this.props,t=e.controller,n=e.model,r=e.topicKey,c=e.dir,i=n.getTopic(r).subKeys.toArray(),a=t.run("createSubTopics",lt(lt({},e),{topics:i}));if(!a)return null;var l=a.subTopics,u=t.run("renderSubLinks",e);return Object(o.createElement)(lr,{dir:c,marginH:n.config.theme.marginH},l," ",u)},t.prototype.layoutLinks=function(){var e=this.props,t=e.getRef,n=e.topicKey,o=e.model.getTopic(n);if(0!==o.subKeys.size&&!o.collapse){ir("layoutLinks",n);var r=t(dn(n));r&&r.layout()}},t.prototype.render=function(){var e=this.props,t=e.controller,n=e.topicKey,r=e.dir,c=e.saveRef;ir("render",n);var i=t.run("getTopicContentStyle",e),a=lt(lt({},e),{topicStyle:i}),l=t.run("renderTopicContent",a);return Object(o.createElement)(ar,{topicDirection:r},Object(o.createElement)(ur,{topicDirection:r,ref:c(pn(n))},l),this.renderSubTopics())},t}(o.Component),pr=y()("node:view-port-viewer"),dr=Object(d.default)(Gt)(qo||(qo=yt(["\n  position: absolute;\n  background: white;\n  right: 30px;\n  bottom: 20px;\n  border-radius: 2px;\n  display: flex;\n  flex-direction: row;\n  user-select: none;\n"],["\n  position: absolute;\n  background: white;\n  right: 30px;\n  bottom: 20px;\n  border-radius: 2px;\n  display: flex;\n  flex-direction: row;\n  user-select: none;\n"]))),fr=Object(d.default)(Nt)(Qo||(Qo=yt(["\n  margin: 10px;\n"],["\n  margin: 10px;\n"]))),yr=d.default.span($o||($o=yt(["\n  display: inline-block;\n  width: 80px;\n  height: 18px;\n"],["\n  display: inline-block;\n  width: 80px;\n  height: 18px;\n"]))),br=function(e){return Object(o.createElement)(b.x,{content:e.tooltip,position:h.a.TOP,className:g.a.ICON},Object(o.createElement)(fr,{onClick:e.onClick,tabIndex:-1},e.children))},gr=function(e){function t(t){var n=e.call(this,t)||this;return n.zoomFactorChange=function(e){pr("zoomFactorChange",e),n.setState({zoomFactor:e})},n.onClickResetZoom=function(e){var t=n.props;t.controller.run("setZoomFactor",lt(lt({},t),{zoomFactor:1}))},n.onClickAddZoom=function(e){var t=n.props,o=t.controller,r=o.run("getZoomFactor",t);o.run("setZoomFactor",lt(lt({},t),{zoomFactor:r+.1}))},n.onClickMinusZoom=function(e){var t=n.props,o=t.controller,r=o.run("getZoomFactor",t);o.run("setZoomFactor",lt(lt({},t),{zoomFactor:r-.1}))},n.onClickCollapseAll=function(e){var t=n.props,o=t.controller;o.run("addEventListener",lt(lt({},t),{key:jn,listener:n.centerRootTopic,once:!0})),o.run("operation",lt(lt({},t),{opType:G}))},n.onClickExpandAll=function(e){var t=n.props,o=t.controller;o.run("addEventListener",lt(lt({},t),{key:jn,listener:n.centerRootTopic,once:!0})),o.run("operation",lt(lt({},t),{opType:U}))},n.centerRootTopic=function(){var e=n.props,t=e.model;e.controller.run("moveTopicToCenter",lt(lt({},n.props),{topicKey:t.editorRootTopicKey}))},n}return at(t,e),t.prototype.componentDidMount=function(){var e=this.props;e.controller.run("addZoomFactorChangeEventListener",lt(lt({},e),{listener:this.zoomFactorChange}))},t.prototype.componentWillUnmount=function(){var e=this.props;e.controller.run("removeZoomFactorChangeEventListener",lt(lt({},e),{listener:this.zoomFactorChange}))},t.prototype.render=function(){pr("render");var e=this.props,t=e.controller,n=e.zIndex,r=t.run("getZoomFactor",e);return Object(o.createElement)(dr,{zIndex:n},Object(o.createElement)(br,{onClick:this.onClickCollapseAll,tooltip:"collapse all"},cn(en)),Object(o.createElement)(br,{onClick:this.onClickExpandAll,tooltip:"expand all"},cn(tn)),Object(o.createElement)(br,{onClick:this.centerRootTopic,tooltip:"center root topic"},cn(nn)),Object(o.createElement)(br,{onClick:this.onClickMinusZoom,tooltip:"zoom in"},cn($t)),Object(o.createElement)(br,{onClick:this.onClickResetZoom,tooltip:"reset zoom"},Object(o.createElement)(yr,null,"zoom:"+Math.floor(100*r)+"%")),Object(o.createElement)(br,{onClick:this.onClickAddZoom,tooltip:"zoom out"},cn(Qt)))},t}(wt),hr=d.default.div(er||(er=yt(["\n  overflow: auto;\n  padding: 0px 0px 0px 20px;\n  background: #88888850;\n"],["\n  overflow: auto;\n  padding: 0px 0px 0px 20px;\n  background: #88888850;\n"])));function Or(e){var t=e.controller,n=e.model,r=e.topicKey;if(n.focusMode===A){var c=t.run("renderTopicDescEditor",e);return Object(o.createElement)(b.i,{key:"drawer",title:"Edit Notes",icon:cn("note"),isOpen:!0,hasBackdrop:!0,backdropProps:{onMouseDown:xn},isCloseButtonShown:!1,onClose:function(n){n.stopPropagation();var o="topic-desc-data-"+r,c=t.run("deleteTempValue",{key:o});t.run("operation",lt(lt({},e),{opType:ee,topicKey:r,blockType:I,data:c,focusMode:_}))},size:"70%"},Object(o.createElement)(hr,null,c))}}function mr(e){var t=e.theme,n=e.children;return Object(o.createElement)(d.ThemeProvider,{theme:t},Object(o.createElement)(o.Fragment,null,n))}var vr,jr=y()("plugin:rendering");function Tr(){var e,t=d.default.div(vr||(vr=yt(["\n    width: 100%;\n    height: 100%;\n    background: ",";\n    position: relative;\n  "],["\n    width: 100%;\n    height: 100%;\n    background: ",";\n    position: relative;\n  "])),(function(e){return e.theme.background}));return{getDiagramProps:function(){return e},renderDiagram:function(n){var r=n.model,c=n.controller;return Object(o.createElement)(_t,null,(function(i,a,l){return e=lt(lt({},n),{saveRef:i,getRef:a,deleteRef:l}),jr("renderDiagram",r),Object(o.createElement)(mr,{theme:r.config.theme},Object(o.createElement)(t,{ref:i(gn)},Object(o.createElement)(Oo,lt({},e)),c.run("renderDiagramCustomize",e)))}))},renderDrawer:Or,renderDiagramCustomize:function(e){var t=e.controller,n=e.model,o=t.getValue(Tn),r=lt(lt({},e),{zIndex:o,topicKey:n.focusKey});return[t.run("renderEditorRootBreadcrumbs",r),t.run("renderRightTopPanel",r),t.run("renderModals",lt(lt({},r),{zIndex:o+1})),t.run("renderDrawer",lt(lt({},r),{zIndex:o+1})),t.run("renderViewPortViewer",r)]},renderEditorRootBreadcrumbs:function(e){return Object(o.createElement)(bo,lt({key:"EditorRootBreadcrumbs"},e))},renderModals:function(e){return Object(o.createElement)(mo,lt({key:"modals"},e))},renderModal:function(e){return null},getActiveModalProps:function(e){return null},renderDoc:function(e){return e.children},renderRootWidget:function(e){return Object(o.createElement)(So,lt({},e))},renderTopicWidget:function(e){return Object(o.createElement)(sr,lt({},e))},renderTopicContent:function(e){return Object(o.createElement)(Vo,lt({},e))},renderTopicCollapseIcon:function(e){return Object(o.createElement)(wo,lt({},e))},renderTopicContentOthers:function(e){return[]},renderTopicBlocks:function(e){var t=e.model,n=e.topicKey,r=e.controller,c=t.getTopic(n).blocks,i=[],a=0;return c.forEach((function(t){var n=r.run("renderTopicBlock",lt(lt({},e),{block:t,blockKey:"block-"+a}));n&&(i.push(Object(o.createElement)(o.Fragment,{key:"block-"+a},n)),a++)})),i},renderTopicBlock:function(e){var t=e.controller;switch(e.block.type){case L:return t.run("renderTopicBlockContent",e);case I:return t.run("renderTopicBlockDesc",e)}return null},renderTopicBlockContent:function(e){return Object(o.createElement)(Mo,lt({},e))},renderTopicBlockDesc:function(e){return Object(o.createElement)(Uo,lt({},e))},renderSubLinks:function(e){var t=e.saveRef,n=e.topicKey,r=e.model.getTopic(n);return 0===r.subKeys.size||r.collapse?null:Object(o.createElement)(cr,lt({ref:t(dn(n))},e))},renderRootSubLinks:function(e){var t=e.saveRef,n=e.topicKey;return Object(o.createElement)(To,lt({ref:t(dn(n))},e))},renderFocusItemHighlight:function(e){var t=e.saveRef;return Object(o.createElement)(nr,lt({ref:t(mn)},e))},renderRootWidgetOtherChildren:function(e){var t=e.controller,n=t.run("getZoomFactor",e);return e=lt(lt({},e),{zoomFactor:n}),Object(o.createElement)(o.Fragment,null,t.run("renderRootSubLinks",e),t.run("renderFocusItemHighlight",e),t.run("renderDragAndDropEffect",e))},renderViewPortViewer:function(e){return Object(o.createElement)(gr,lt({key:"view-port-viewer"},e))}}}var Er,kr,xr=Object(d.default)(Gt)(Er||(Er=yt(["\n  position: absolute;\n  background: white;\n  right: 30px;\n  top: 20px;\n  border-radius: 2px;\n  user-select: none;\n"],["\n  position: absolute;\n  background: white;\n  right: 30px;\n  top: 20px;\n  border-radius: 2px;\n  user-select: none;\n"]))),Sr=Object(d.default)(b.w)(kr||(kr=yt(["\n  padding: 0px 10px;\n"],["\n  padding: 0px 10px;\n"])));function Cr(e){var t=e.controller,n=e.zIndex,r=e.selectedTabId,c=e.handleTabIdChange,i=dt(Object(o.useState)(!1),2),a=i[0],l=i[1];return a?Object(o.createElement)(xr,{zIndex:n},Object(o.createElement)(Vt,null,Object(o.createElement)(zt,{className:rn(Jt),onClick:function(){return l(!1)}})),Object(o.createElement)(Sr,{id:r,onChange:c},t.run("renderRightTopPanelTabs",e))):Object(o.createElement)(xr,{zIndex:n},Object(o.createElement)(Pt,{onClick:function(){return l(!0)}},Object(o.createElement)(Ft,{className:rn(Yt)})))}var wr,Rr,Kr,Dr,Lr,Ir,_r,Mr=d.default.div(wr||(wr=yt(["\n  margin-top: 10px;\n  margin-bottom: 5px;\n  font-weight: bold;\n"],["\n  margin-top: 10px;\n  margin-bottom: 5px;\n  font-weight: bold;\n"]))),Ar=d.default.span(Rr||(Rr=yt(["\n  margin: 0px 10px 0px 0px;\n"],["\n  margin: 0px 10px 0px 0px;\n"]))),Fr=d.default.div(Kr||(Kr=yt(["\n  padding: 10px;\n  margin: 0 0 10px 0;\n  border: rgba(16, 22, 26, 0.15) solid 1px;\n  border-radius: 5px;\n"],["\n  padding: 10px;\n  margin: 0 0 10px 0;\n  border: rgba(16, 22, 26, 0.15) solid 1px;\n  border-radius: 5px;\n"]))),Pr=Object(d.default)(Ar)(Dr||(Dr=yt([""],[""]))),Nr=d.default.div(Lr||(Lr=yt(["\n  display: flex;\n  align-items: center;\n  //justify-content: center;\n  margin: 5px 0;\n"],["\n  display: flex;\n  align-items: center;\n  //justify-content: center;\n  margin: 5px 0;\n"]))),Br=d.default.div(Ir||(Ir=yt(["\n  height: 3px;\n  width: 80%;\n  margin-left: 10%;\n  margin-right: 10%;\n  margin-bottom: 2px;\n  background: ",";\n"],["\n  height: 3px;\n  width: 80%;\n  margin-left: 10%;\n  margin-right: 10%;\n  margin-bottom: 2px;\n  background: ",";\n"])),(function(e){return e.color})),zr=d.default.div(_r||(_r=yt(["\n  border: 1px solid grey;\n  cursor: pointer;\n  font-weight: bold;\n"],["\n  border: 1px solid grey;\n  cursor: pointer;\n  font-weight: bold;\n"])));function Vr(e){return Object(o.createElement)("div",null,e.children,Object(o.createElement)(b.h,{style:{margin:"10px 0"}}))}function Hr(e){var t=e.color,n=e.handleColorChange;return Object(o.createElement)(Ar,null,Object(o.createElement)(b.s,null,Object(o.createElement)(zr,null,Object(o.createElement)("div",{className:rn(Xt)}),Object(o.createElement)(Br,{color:t})),Object(o.createElement)("div",null,Object(o.createElement)(rt.a,{color:t,onChangeComplete:function(e){return n(e.hex)}}))))}function Gr(e){var t=e.title,n=e.handleClick;return Object(o.createElement)(Ar,null,Object(o.createElement)(b.d,{onClick:n},t))}function Ur(e){var t=e.layout,n=void 0===t?"h":t,r=e.title,c=ut(e,["layout","title"]),i={flexDirection:"h"===n?"row":"column",alignItems:"center"};return Object(o.createElement)(Ar,null,Object(o.createElement)(Mt,lt({},i),Object(o.createElement)(At,{margin:"0 5px 0 0"},r),Object(o.createElement)(b.q,lt({},c))))}function Wr(e){var t=e.text,n=e.items,r=e.itemRenderer,c=e.onItemSelect,i=ot.a.ofType(),a={items:n,itemRenderer:r,onItemSelect:c,filterable:!1};return Object(o.createElement)(Ar,null,Object(o.createElement)(i,lt({},a),Object(o.createElement)(b.d,{text:t})))}var Zr=function(e){return function(t,n){var r=n.handleClick;return Object(o.createElement)(b.p,{text:""+t+e,key:t,onClick:r})}},Yr=(ot.a.ofType(),ft(Array(7).keys())),Jr=ft(Array(7).keys()),Xr=[0,5,10,15,20,25,30,35],qr=["none","solid","dotted","dashed","double"];function Qr(e){var t=e.contentStyle,n=e.setContentStyle;return Object(o.createElement)(Vr,null,Object(o.createElement)(Mr,null,"Border"),Object(o.createElement)("div",null,Object(o.createElement)(Wr,{text:"width: "+(t.borderWidth?t.borderWidth:"0px"),items:Jr,itemRenderer:Zr("px"),onItemSelect:function(e){n({borderWidth:e+"px"})}}),Object(o.createElement)(Wr,{text:"style: "+(t.borderStyle?t.borderStyle:"none"),items:qr,itemRenderer:Zr(""),onItemSelect:function(e){n({borderStyle:e})}}),Object(o.createElement)(Wr,{text:"radius: "+t.borderRadius,items:Xr,itemRenderer:Zr("px"),onItemSelect:function(e){n({borderRadius:e+"px"})}}),Object(o.createElement)(Hr,{color:t.borderColor,handleColorChange:function(e){n({borderColor:e})}})))}var $r=["curve","round","line"],ec=function(e,t){var n=t.handleClick;t.modifiers,t.query;return Object(o.createElement)(b.p,{text:""+e,key:e,onClick:n})};function tc(e){var t=e.showLinkStyle,n=void 0===t||t,r=e.showSubLinkStyle,c=void 0===r||r,i=e.linkStyle,a=void 0===i?{}:i,l=e.subLinkStyle,u=void 0===l?{}:l,s=e.setLinkStyle,p=e.setSubLinkStyle;return Object(o.createElement)(Vr,null,Object(o.createElement)(Mr,null,"Link"),n&&Object(o.createElement)(Nr,{alignItems:"center"},Object(o.createElement)(At,{margin:"0 5px 0 0"},"LinkToParent: "),Object(o.createElement)(Wr,{text:"width: "+(a?a.lineWidth:"0px"),items:Yr,itemRenderer:Zr("px"),onItemSelect:function(e){s({lineWidth:e+"px"})}}),Object(o.createElement)(Wr,{text:"lineType: "+a.lineType,items:$r,itemRenderer:ec,onItemSelect:function(e){s({lineType:e})}}),Object(o.createElement)(Hr,{color:a.lineColor,handleColorChange:function(e){s({lineColor:e})}})),c&&Object(o.createElement)(Nr,{alignItems:"center"},Object(o.createElement)(At,{margin:"0 5px 0 0"},"SubLinks: "),Object(o.createElement)(Wr,{text:"width: "+(u?u.lineWidth:"0px"),items:Yr,itemRenderer:Zr("px"),onItemSelect:function(e){p({lineWidth:e+"px"})}}),Object(o.createElement)(Wr,{text:"lineType: "+u.lineType,items:$r,itemRenderer:ec,onItemSelect:function(e){p({lineType:e})}}),Object(o.createElement)(Hr,{color:u.lineColor,handleColorChange:function(e){p({lineColor:e})}})))}function nc(e){var t=e.contentStyle,n=e.setContentStyle,r={title:"FontSize:",min:12,max:100,value:parseInt(t.fontSize),style:{width:50},onValueChange:function(e){n({fontSize:e})}},c={style:{width:50},value:t.lineHeight||"",onChange:function(e){n({lineHeight:e.target.value})}};return Object(o.createElement)(Vr,null,Object(o.createElement)(Mr,null,"Text Editor"),Object(o.createElement)(Mt,null,Object(o.createElement)(Ur,lt({},r)),Object(o.createElement)(Ar,null,Object(o.createElement)(Mt,{alignItems:"center"},Object(o.createElement)(At,{margin:"0 5px 0 0"},"LineHeight: "),Object(o.createElement)(b.m,lt({},c)))),Object(o.createElement)(Hr,{color:t.color,handleColorChange:function(e){n({color:e})}})))}var oc,rc=y()("node:style-editor");function cc(e){var t=e.controller,n=e.model,r=e.topicKey,c=n.getTopic(r),i=function(n){t.run("setTopicContentStyle",lt(lt({},e),{style:n}))};if(!n.focusKey)return null;var a=t.run("getTopicContentStyle",e),l={linkStyle:t.run("getLinkStyle",e),subLinkStyle:t.run("getSubLinkStyle",e),setLinkStyle:function(n){t.run("setLinkStyle",lt(lt({},e),{linkStyle:n}))},setSubLinkStyle:function(n){t.run("setSubLinkStyle",lt(lt({},e),{subLinkStyle:n}))}},u={contentStyle:a,setContentStyle:i};return Object(o.createElement)(Ut,null,Object(o.createElement)(Qr,lt({},u)),Object(o.createElement)(nc,lt({},u)),Object(o.createElement)(Vr,null,Object(o.createElement)(Mr,null,"Background"),Object(o.createElement)(Hr,{color:a.background,handleColorChange:function(e){i({background:e})}})),Object(o.createElement)(tc,lt({},l)),Object(o.createElement)(Vr,null,Object(o.createElement)(Gr,{title:"Clear Topic Style",handleClick:function(){c.style&&t.run("operation",lt(lt({},e),{opType:Q,style:null}))}}),Object(o.createElement)(Gr,{title:"Copy Style",handleClick:function(){oc=t.run("getTopicStyle",e),rc(oc)}}),Object(o.createElement)(Gr,{title:"Paste Style",handleClick:function(){oc&&t.run("operation",lt(lt({},e),{opType:Q,style:JSON.stringify(oc)}))}})),function(e){var t=e.controller;return Object(o.createElement)(Vr,null,Object(o.createElement)(Ar,null,Object(o.createElement)(b.d,{onClick:function(n){t.run("clearAllCustomStyle",e)}},"Clear All Custom Styles")))}(e))}var ic=n(110);function ac(e){var t=e.contentStyle,n=e.setContentStyle,r=ic("padding",t.padding||"0"),c={layout:"v",min:0,max:99,style:{width:38}},i=parseInt(r["padding-top"]),a=parseInt(r["padding-right"]),l=parseInt(r["padding-bottom"]),u=parseInt(r["padding-left"]),s={top:i,right:a,bottom:l,left:u},p=function(e){return function(t){var o;n({padding:wn(lt(lt({},s),(o={},o[e]=t,o)))})}},d=lt(lt({},c),{title:"top",value:i,onValueChange:p("top")}),f=lt(lt({},c),{title:"right",value:a,onValueChange:p("right")}),y=lt(lt({},c),{title:"bottom",value:l,onValueChange:p("bottom")}),b=lt(lt({},c),{title:"left",value:u,onValueChange:p("left")});return Object(o.createElement)(Vr,null,Object(o.createElement)(Mr,null,"Padding"),Object(o.createElement)(Nr,null,Object(o.createElement)(Ur,lt({},d)),Object(o.createElement)(Ur,lt({},f)),Object(o.createElement)(Ur,lt({},y)),Object(o.createElement)(Ur,lt({},b))))}var lc,uc=d.default.div(lc||(lc=yt(["\n  height: 250px;\n  overflow: auto;\n"],["\n  height: 250px;\n  overflow: auto;\n"])));function sc(e){var t=e.topicStyle,n=e.setTopicStyle,r=t.contentStyle,c=void 0===r?{}:r,i=t.linkStyle,a=void 0===i?{}:i,l=t.subLinkStyle,u=function(e){n({contentStyle:e})},s={contentStyle:c,setContentStyle:u},p={showLinkStyle:!1,linkStyle:a,subLinkStyle:void 0===l?{}:l,setLinkStyle:function(e){n({linkStyle:e})},setSubLinkStyle:function(e){n({subLinkStyle:e})}};return Object(o.createElement)(uc,null,Object(o.createElement)(Qr,lt({},s)),Object(o.createElement)(ac,lt({},s)),Object(o.createElement)(nc,lt({},s)),Object(o.createElement)(Vr,null,Object(o.createElement)(Mr,null,"Background"),Object(o.createElement)(Hr,{color:c.background,handleColorChange:function(e){u({background:e})}})),Object(o.createElement)(tc,lt({},p)))}var pc="normal";function dc(e){var t,n=dt(Object(o.useState)(!1),2),r=(n[0],n[1],dt(Object(o.useState)(!1),2)),c=r[0],i=r[1],a=e.model,l=e.controller,u=a.config.theme,s=u.rootTopic,p=u.primaryTopic,d=u.normalTopic,f=function(t){l.run("operation",lt(lt({},e),{opType:$,theme:Object(ct.clone)(t)}))},y=(t=function(e){f(Object(ct.merge)(u,{randomColor:e}))},function(e){return t(e.target.checked)}),g={topicStyle:s,setTopicStyle:function(e){f(Object(ct.merge)(u,{rootTopic:e}))}},h=Object(o.createElement)(sc,lt({},g)),O={topicStyle:p,setTopicStyle:function(e){f(Object(ct.merge)(u,{primaryTopic:e}))}},m=Object(o.createElement)(sc,lt({},O)),v={topicStyle:d,setTopicStyle:function(e){f(Object(ct.merge)(u,{normalTopic:e}))}},j=Object(o.createElement)(sc,lt({},v)),T={id:pc,handleTabIdChange:function(e){pc=e}},E=Object(o.createElement)(Fr,null,Object(o.createElement)(b.w,lt({},T),Object(o.createElement)(b.v,{id:"normal",title:"NormalTopic",panel:j}),Object(o.createElement)(b.v,{id:"primary",title:"PrimaryTopic",panel:m}),Object(o.createElement)(b.v,{id:"root",title:"RootTopic",panel:h}))),k={isOpen:c,onClose:function(e){i(!1)}},x=Object(o.createElement)(b.a,lt({},k),Object(o.createElement)("p",null,"File format error"));return Object(o.createElement)(Ut,null,Object(o.createElement)(Vr,null,Object(o.createElement)(Mr,null,"Global"),Object(o.createElement)(Nr,null,Object(o.createElement)(Pr,null,"Background:"),Object(o.createElement)(Hr,{color:u.background,handleColorChange:function(e){f(Object(ct.merge)(u,{background:e}))}}),Object(o.createElement)(Pr,null,"Highlight:"),Object(o.createElement)(Hr,{color:u.highlightColor,handleColorChange:function(e){f(Object(ct.merge)(u,{highlightColor:e}))}}),Object(o.createElement)(Pr,null,"Random Color:"),Object(o.createElement)(Bt,{checked:u.randomColor,onChange:y}))),E,Object(o.createElement)(Vr,null,Object(o.createElement)(Gr,{title:"Export Theme",handleClick:function(e){Sn(JSON.stringify(u),"blink-mind-theme.json")}}),Object(o.createElement)(Gr,{title:"Import Theme",handleClick:function(e){Cn(".json,.txt").then((function(e){var t,n=JSON.parse(e);null!=(t=n).name&&null!=t.background&&null!=t.highlightColor?f(n):i(!0)}))}})),x)}function fc(){var e="topic-style",t=function(t){e=t};return{renderRightTopPanel:function(n){var r=lt(lt({},n),{key:"right-top-panel",selectedTabId:e,handleTabIdChange:t});return Object(o.createElement)(Cr,lt({},r))},renderRightTopPanelTabs:function(e){var t=e.controller;return[t.run("renderTopicStyleEditor",e),t.run("renderThemeEditor",e)]},renderTopicStyleEditor:function(e){var t={id:"topic-style",key:"topic-style",title:"TopicStyle",panel:Object(o.createElement)(cc,lt({},e))};return Object(o.createElement)(b.v,lt({},t))},renderThemeEditor:function(e){var t={id:"theme-editor",key:"theme-editor",title:"Theme",panel:Object(o.createElement)(dc,lt({},e))};return Object(o.createElement)(b.v,lt({},t))}}}var yc=y()("plugin:utils");function bc(){var e=new Map,t=new Map;return{addTempValueChangeListener:function(e){var n=e.key,o=e.listener;t.has(n)||t.set(n,[]),t.get(n).push(o)},removeTempValueChangeListener:function(e){var n=e.key,o=e.listener;t.has(n)&&(t[n]=t.get(n).filter((function(e){return e!==o})))},getTempValue:function(t){var n=t.key;return yc("getTempValue",n),e.get(n)},setTempValue:function(n){var o,r,c=n.key,i=n.value;if(yc("setTempValue",c),e.set(c,i),t.has(c)){var a=t.get(c);try{for(var l=pt(a),u=l.next();!u.done;u=l.next()){(0,u.value)(i)}}catch(s){o={error:s}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(o)throw o.error}}}},deleteTempValue:function(t){var n=t.key;yc("deleteTempValue",n);var o=e.get(n);return e.delete(n),o}}}var gc=y()("plugin:StylePlugin");function hc(){var e=new Map,t=0;return{getTopicStyle:function(e){var t=e.controller;return{contentStyle:t.run("getTopicContentStyle",e),linkStyle:t.run("getLinkStyle",e),subLinkStyle:t.run("getSubLinkStyle",e)}},getTopicContentStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;gc("getTopicContentStyle:",t,n);var r,c=n.getTopicVisualLevel(t),i=n.config.theme;if(r=c===K?i.rootTopic:c===D?i.primaryTopic:i.normalTopic,r=lt(lt({},i.contentStyle),r.contentStyle),i.randomColor){var a=o.run("getRandomColor",e);r=lt(lt({},r),{background:a,borderColor:a,subLinkStyle:lt(lt({},r.subLinkStyle),{lineColor:a})})}var l=n.getTopic(t);if(!l.style)return r;var u=JSON.parse(l.style);return lt(lt({},r),u.contentStyle)},getLinkStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;gc("getLinkStyle",t);var r,c=n.getTopicVisualLevel(t),i=n.config.theme,a=i.linkStyle;r=c===K?i.rootTopic.linkStyle:c===D?i.primaryTopic.linkStyle:i.normalTopic.linkStyle,a=lt(lt({},a),r);var l=n.getTopic(t);if(null!=l.parentKey){var u=o.run("getSubLinkStyle",lt(lt({},e),{topicKey:l.parentKey}));a=lt(lt({},a),u)}if(!l.style)return a;var s=JSON.parse(l.style);return lt(lt({},a),s.linkStyle)},getSubLinkStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;gc("getLinkStyle",t);var r,c=n.getTopicVisualLevel(t),i=n.config.theme,a=i.linkStyle;r=c===K?i.rootTopic.subLinkStyle:c===D?i.primaryTopic.subLinkStyle:i.normalTopic.subLinkStyle,a=lt(lt({},a),r);var l=n.getTopic(t);if(i.randomColor){var u=o.run("getRandomColor",e);gc(u),a=lt(lt({},a),{lineColor:u})}if(!l.style)return a;var s=JSON.parse(l.style);return lt(lt({},a),s.subLinkStyle)},setTopicContentStyle:function(e){var t=e.topicKey,n=e.controller,o=e.style,r=e.model.getTopic(t).style,c=r?JSON.parse(r):{},i=lt(lt({},c),{contentStyle:lt(lt({},c.contentStyle),o)});if(!Object(ct.isEqual)(c,i)){var a=JSON.stringify(i);n.run("operation",lt(lt({},e),{opType:Q,style:a}))}},setLinkStyle:function(e){var t=e.topicKey,n=e.controller,o=e.linkStyle,r=e.model.getTopic(t).style,c=r?JSON.parse(r):{},i=lt(lt({},c),{linkStyle:lt(lt({},c.linkStyle),o)});if(!Object(ct.isEqual)(c,i)){var a=JSON.stringify(i);n.run("operation",lt(lt({},e),{opType:Q,style:a}))}},setSubLinkStyle:function(e){var t=e.topicKey,n=e.controller,o=e.subLinkStyle,r=e.model.getTopic(t).style,c=r?JSON.parse(r):{},i=lt(lt({},c),{subLinkStyle:lt(lt({},c.subLinkStyle),o)});if(!Object(ct.isEqual)(c,i)){var a=JSON.stringify(i);n.run("operation",lt(lt({},e),{opType:Q,style:a}))}},getTopicThemeStyle:function(e){var t=e.topicKey,n=e.model,o=n.getTopicVisualLevel(t),r=n.config.theme;return o===K?r.rootTopic:o===D?r.primaryTopic:r.normalTopic},getRandomColor:function(n){var o=n.topicKey;if(e.has(o))return e.get(o);var r=["#00CC99","#FFEE88","#A167A5","#E5F993","#F5C396","#DB995A","#83BCFF","#ED7B84","#739E82","#D3BCC0","#FFA0FD","#EFD3D7","#C6878F"],c=r[++t%r.length];return e.set(o,c),gc("getRandomColor",o,c),c},clearAllCustomStyle:function(e){var t=e.model,n=e.controller,o=t.withMutations((function(e){e.topics.keySeq().forEach((function(t){e.setIn(["topics",t,"style"],null)}))}));n.change(o)}}}function Oc(){return[[Tr(),bc(),{renderTopicContextMenu:function(e){return Object(o.createElement)(Gn,lt({},e))},customizeTopicContextMenu:function(e){var t=e.topicKey,n=e.model,r=e.controller,c=t===n.editorRootTopicKey;function i(t){return function(n){t.opType&&r.run("operation",lt(lt({},e),{opType:t.opType}))}}return Un.map((function(e){return c&&!e.rootCanUse?null:Object(o.createElement)(b.p,{key:e.label,icon:cn(e.icon),text:e.label,labelElement:Object(o.createElement)("kbd",null,e.shortcut),onClick:i(e)})}))}},fc(),$n()],{getPartTopics:function(e){var t=e.layout,n=e.model,o=e.topicKey,r=n.getTopic(o),c=r.subKeys.size,i=r.subKeys.toArray();switch(t){case x.LEFT_TO_RIGHT:return{R:i};case x.RIGHT_TO_LEFT:return{L:i};case x.LEFT_AND_RIGHT:return{L:i.slice(Math.ceil(c/2),c),R:i.slice(0,Math.ceil(c/2))};case x.TOP_TO_BOTTOM:return{B:i}}},createSubTopics:function(e){var t=e.model,n=e.topicKey,o=e.controller,r=e.topics,c=e.saveRef,i=t.getTopic(n);if(0===r.size||i.collapse)return null;var a=[];return r.forEach((function(t){var n=lt(lt({},e),{topicKey:t,key:t,ref:c(sn(t))});a.push(o.run("renderTopicWidget",n))})),{subTopics:a}},layout:function(e){var t=e.getRef,n=e.model,o=t(dn(n.editorRootTopicKey)),r=t(mn),c=t(vn);o&&o.layout(),r&&r.layout(),c&&c.layout(),function e(o){var r,c;if(o.key!==n.editorRootTopicKey){var i=t(sn(o.key));i&&i.layoutLinks()}if(!o.collapse)try{for(var a=pt(o.subKeys),l=a.next();!l.done;l=a.next()){var u=l.value;e(n.getTopic(u))}}catch(s){r={error:s}}finally{try{l&&!l.done&&(c=a.return)&&c.call(a)}finally{if(r)throw r.error}}}(n.getTopic(n.editorRootTopicKey))},setLayoutDir:function(e){var t=e.layoutDir,n=e.model;e.controller.change(be.setLayoutDir({model:n,layoutDir:t}))},getRelativeRect:function(e){var t=e.element,n=e.controller,o=e.getRef,r=n.run("getZoomFactor",e);return In(t,o(hn).bigView,r)},getRelativeRectFromViewPort:function(e){var t=e.element,n=e.controller,o=e.getRef,r=n.run("getZoomFactor",e);return In(t,o(hn).viewBox,r)},getRelativeVectorFromViewPort:function(e){return _n(e.element,(0,e.getRef)(hn).viewBox)},addZoomFactorChangeEventListener:function(e){e.controller.run("addTempValueChangeListener",lt({key:"ZoomFactor"},e))},removeZoomFactorChangeEventListener:function(e){e.controller.run("removeTempValueChangeListener",lt({key:"ZoomFactor"},e))},setZoomFactor:function(e){var t=e.controller,n=e.zoomFactor;return t.run("setTempValue",{key:"ZoomFactor",value:n})},getZoomFactor:function(e){return e.controller.run("getTempValue",{key:"ZoomFactor"})||1},moveTopicToCenter:function(e){var t=e.getRef,n=e.topicKey,o=e.model;if(o.editorRootTopicKey!==n&&de(o,n,o.editorRootTopicKey)!==B)throw new Error("moveTopicToCenter error: topicKey "+n+" is not the DESCENDANT of editor root topic");var r=t(pn(n)),c=t(hn),i=c.viewBox;if(!r||!i)throw new Error("moveTopicToCenter error: topic or viewBox is null");var a=_n(r,i);c.setViewBoxScrollDelta(a[0],a[1])},focusTopicAndMoveToCenter:function(e){var t=e.controller,n=e.topicKey;t.run("operation",lt(lt({},e),{opArray:[{opType:X,topicKey:n,focusMode:_},{opType:W,topicKey:n}],callback:function(){t.run("moveTopicToCenter",lt(lt({},e),{topicKey:n}))}}))}},Hn(),hc(),Zt(),zn(),{getValue:function(e,t){var n=e.propKey,o=e.controller;switch(n){case Tn:return 3;case En:return o.run("isOperationEnabled",e);case kn:return o.run("getTopicTitle",e)}return t()}},et()]}y()("node:Diagram");var mc=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.resolveController=Object(k.a)((function(e,n){void 0===e&&(e=[]);var o=n();t.controller=new ve({plugins:[e,o],construct:!1,onChange:t.props.onChange})})),t}return at(t,e),t.prototype.getDiagramProps=function(){return this.controller.run("getDiagramProps")},t.prototype.openNewModel=function(e){var t=this,n=this.getDiagramProps(),o=n.model,r=n.controller;r.run("deleteRefKey",lt(lt({},n),{topicKey:o.rootTopicKey})),r.run("operation",lt(lt({},n),{opType:W,topicKey:e.focusKey,model:e,callback:function(){var e=t.getDiagramProps(),n=e.model;r.run("moveTopicToCenter",lt(lt({},e),{topicKey:n.focusKey}))}}))},t.prototype.render=function(){var e=this.props.plugins;return this.resolveController(e,Oc),this.diagramProps=lt(lt({},this.props),{controller:this.controller}),this.controller.run("renderDiagram",this.diagramProps)},t}(o.Component);function vc(e){return!0===(null!=(t=e)&&"object"===typeof t&&!1===Array.isArray(t))&&"[object Object]"===Object.prototype.toString.call(e);var t}var jc=function(e){var t,n;return!1!==vc(e)&&("function"===typeof(t=e.constructor)&&(!1!==vc(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))};var Tc,Ec=function(e,t){},kc="L",xc="R",Sc="M";!function(e){e[e.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT",e[e.LEFT_AND_RIGHT=2]="LEFT_AND_RIGHT",e[e.TOP_TO_BOTTOM=3]="TOP_TO_BOTTOM"}(Tc||(Tc={}));var Cc=0,wc=1,Rc="CONTENT",Kc="DESC",Dc="NORMAL",Lc="EDITING_CONTENT",Ic="EDITING_DESC",_c="SHOW_POPUP",Mc="DRAGGING",Ac="ANCESTOR",Fc="DESCENDANT",Pc="SIBLING",Nc="NONE",Bc="TOGGLE_COLLAPSE",zc="COLLAPSE_ALL",Vc="EXPAND_ALL",Hc="EXPAND_TO",Gc="ADD_CHILD",Uc="ADD_SIBLING",Wc="DELETE_TOPIC",Zc="FOCUS_TOPIC",Yc="SET_FOCUS_MODE",Jc="SET_STYLE",Xc="CLEAR_ALL_CUSTOM_STYLE",qc="SET_THEME",Qc="SET_TOPIC_BLOCK",$c="DELETE_TOPIC_BLOCK",ei="START_EDITING_CONTENT",ti="START_EDITING_DESC",ni="DRAG_AND_DROP",oi="SET_EDITOR_ROOT",ri="SET_LAYOUT_DIR",ci=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"data",get:function(){return this.get("data")}},{key:"type",get:function(){return this.get("type")}}],[{key:"create",value:function(e){return new n(e)}},{key:"createList",value:function(e){if(j.List.isList(e)||Array.isArray(e))return Object(j.List)(e.map(n.create));throw new Error("Block.createList only accepts Array or List, but you passed it: ".concat(e))}}]),n}(Object(j.Record)({type:null,key:null,data:null}));var ii={readOnly:!1,allowUndo:!0,layoutDir:Tc.LEFT_AND_RIGHT,theme:{name:"default",randomColor:!0,background:"rgb(57,60,65)",highlightColor:"#50C9CE",marginH:60,marginV:20,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5,lineType:"curve",lineWidth:"3px"},rootTopic:{contentStyle:{fontSize:"34px",borderRadius:"35px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},primaryTopic:{contentStyle:{borderWidth:"1px",borderStyle:"solid",borderRadius:"20px",fontSize:"17px",padding:"10px 15px 10px 15px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},normalTopic:{contentStyle:{border:"1px solid #e8eaec",borderRadius:"20px",fontSize:"17px",padding:"4px 10px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"white"}}}},ai=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"layoutDir",get:function(){return this.get("layoutDir")}},{key:"readOnly",get:function(){return this.get("readOnly")}},{key:"allowUndo",get:function(){return this.get("allowUndo")}},{key:"theme",get:function(){return this.get("theme")}}],[{key:"fromJSON",value:function(e){return new n(e)}}]),n}(Object(j.Record)(ii));function li(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var ui=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"key",get:function(){return this.get("key")}},{key:"parentKey",get:function(){return this.get("parentKey")}},{key:"collapse",get:function(){return this.get("collapse")}},{key:"subKeys",get:function(){return this.get("subKeys")}},{key:"blocks",get:function(){return this.get("blocks")}},{key:"relations",get:function(){return this.get("relations")}},{key:"style",get:function(){return this.get("style")}},{key:"getBlock",value:function(e){var t=this.blocks.findIndex((function(t){return t.type===e}));return-1===t?{index:t,block:null}:{index:t,block:this.blocks.get(t)}}}],[{key:"fromJSON",value:function(e){var t=e.key,o=e.parentKey,r=void 0===o?null:o,c=e.blocks,i=e.subKeys,a=void 0===i?[]:i,l=e.collapse;return new n({key:t,parentKey:r,collapse:void 0!==l&&l,subKeys:Object(j.List)(a),blocks:ci.createList(c)})}},{key:"create",value:function(e){var t=e.key,o=e.parentKey,r=void 0===o?null:o,c=e.content,i=void 0===c?"":c,a=e.subKeys,l=void 0===a?[]:a,u=e.collapse,s=void 0!==u&&u,p=ci.create({type:Rc,data:i,key:null});return new n({key:t,parentKey:r,blocks:Object(j.List)([p]),subKeys:Object(j.List)(l),collapse:s})}}]),n}(Object(j.Record)({key:null,parentKey:null,collapse:!1,subKeys:null,blocks:null,relations:null,style:null}));function si(e,t){var n=e.getTopic(t),o=[];if(n.subKeys.size>0){var r,c=n.subKeys.toArray();(r=o).push.apply(r,Object(v.a)(c)),o=c.reduce((function(t,n){return t.push.apply(t,Object(v.a)(si(e,n))),t}),o)}return o}function pi(e,t,n){var o=e.getTopic(t),r=e.getTopic(n);if(o&&r){if(o.parentKey==r.parentKey)return Pc;for(var c=o;c.parentKey;){if(c.parentKey===r.key)return Fc;c=e.getParentTopic(c.key)}for(c=r;c.parentKey;){if(c.parentKey===o.key)return Ac;c=e.getParentTopic(c.key)}}return Nc}var di=y()("modifier");function fi(e){var t=e.model,n=e.topicKey,o=e.focusMode;return di("focus topic"),n!==t.focusKey&&(t=t.set("focusKey",n)),o!==t.focusMode&&(t=t.set("focusMode",o)),t}var yi={addChild:function(e){var t=e.model,n=e.topicKey;di("addChild:",n);var o=t.getTopic(n);if(o){var r=ui.create({key:li(),parentKey:o.key});return o=o.set("collapse",!1).update("subKeys",(function(e){return e.push(r.key)})),fi({model:t=t.update("topics",(function(e){return e.set(n,o).set(r.key,r)})),topicKey:r.key,focusMode:Lc})}return t},addSibling:function(e){var t=e.model,n=e.topicKey;if(n===t.rootTopicKey)return t;var o=t.getTopic(n);if(o){var r=t.getTopic(o.parentKey),c=r.subKeys.indexOf(n),i=ui.create({key:li(),parentKey:r.key});return fi({model:t=t.update("topics",(function(e){return e.set(i.key,i)})).updateIn(["topics",r.key,"subKeys"],(function(e){return e.insert(c+1,i.key)})),topicKey:i.key,focusMode:Lc})}return t},toggleCollapse:function(e){var t=e.model,n=e.topicKey,o=t.getTopic(n);return o&&0!==o.subKeys.size&&(o=o.merge({collapse:!o.collapse}),t=t.updateIn(["topics",o.key,"collapse"],(function(e){return!e}))),t=fi({model:t,topicKey:n,focusMode:Dc})},collapseAll:function(e){var t=e.model,n=si(t,t.editorRootTopicKey);return di(t),t=fi({model:t=t.withMutations((function(e){n.forEach((function(t){e.setIn(["topics",t,"collapse"],!0)}))})),topicKey:t.editorRootTopicKey,focusMode:Dc})},expandAll:function(e){var t=e.model,n=si(t,t.editorRootTopicKey);return di(t),t=t.withMutations((function(e){n.forEach((function(t){e.setIn(["topics",t,"collapse"],!1)}))})),di(t),t},expandTo:function(e){var t=e.model,n=e.topicKey,o=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[t],r=e.getTopic(t);r.parentKey;)n?o.push(r.parentKey):o.unshift(r.parentKey),r=e.getParentTopic(r.key);return o}(t,n).filter((function(e){return e!==n}));return pi(t=t.withMutations((function(e){o.forEach((function(t){e.setIn(["topics",t,"collapse"],!1)}))})),n,t.editorRootTopicKey)!==Fc&&(t=t.set("editorRootTopicKey",t.rootTopicKey)),t},focusTopic:fi,setFocusMode:function(e){var t=e.model,n=e.focusMode;return di("setFocusMode"),n!==t.focusMode&&(t=t.set("focusMode",n)),t},deleteTopic:function(e){var t=e.model,n=e.topicKey;if(n===t.editorRootTopicKey)return t;var o=t.getTopic(n);return o&&(t=t.withMutations((function(e){e.update("topics",(function(e){e=e.delete(n);var o=si(t,n);return e=e.withMutations((function(e){o.forEach((function(t){e.delete(t)}))}))})),e.updateIn(["topics",o.parentKey,"subKeys"],(function(e){return e.delete(e.indexOf(n))})),e.focusKey===n&&e.set("focusKey",null).set("focusMode",null)}))),t},setBlockData:function(e){var t=e.model,n=e.topicKey,o=e.blockType,r=e.focusMode,c=e.data,i=t.getTopic(n);if(i){var a=i.getBlock(o),l=a.index,u=a.block;-1===l?t=t.updateIn(["topics",n,"blocks"],(function(e){return e.push(ci.create({type:o,data:c}))})):u.data!==c&&(t=t.updateIn(["topics",n,"blocks",l,"data"],(function(e){return c}))),r&&(t=fi({model:t,topicKey:n,focusMode:r}))}return t},deleteBlock:function(e){var t=e.model,n=e.topicKey,o=e.blockType,r=t.getTopic(n);if(r){var c=r.getBlock(o).index;-1!==c&&(t=t.updateIn(["topics",n,"blocks"],(function(e){return e.delete(c)}))),t=fi({model:t,topicKey:null,focusMode:null})}return t},setStyle:function(e){var t=e.model,n=e.topicKey,o=e.style,r=t.getTopic(n);return r&&o!==r.style&&(t=t.updateIn(["topics",n,"style"],(function(e){return o}))),t},clearAllCustomStyle:function(e){var t=e.model;return t=t.withMutations((function(e){e.topics.keySeq().forEach((function(t){e.setIn(["topics",t,"style"],null)}))}))},setTheme:function(e){var t=e.model,n=e.theme;return t=t.setIn(["config","theme"],n)},setLayoutDir:function(e){var t=e.model,n=e.layoutDir;return t.config.layoutDir===n?t:t=t.setIn(["config","layoutDir"],n)},setEditorRootTopicKey:function(e){var t=e.model,n=e.topicKey;return t.editorRootTopicKey!==n&&(t=t.set("editorRootTopicKey",n)),t.getTopic(n).collapse&&(t=t.setIn(["topics",n,"collapse"],!1)),t},setZoomFactor:function(e){var t=e.model,n=e.zoomFactor;return t.zoomFactor!==n&&(t=t.set("zoomFactor",n)),t}},bi={topics:Object(j.Map)(),extData:Object(j.Map)(),config:new ai,rootTopicKey:null,editorRootTopicKey:null,focusKey:null,focusMode:null,formatVersion:null,zoomFactor:1},gi=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"toJS",value:function(){return{rootTopicKey:this.rootTopicKey,topics:Object.values(this.topics.toJS()),config:this.config,extData:this.extData,zoomFactor:this.zoomFactor}}},{key:"extData",get:function(){return this.get("extData")}},{key:"topics",get:function(){return this.get("topics")}},{key:"config",get:function(){return this.get("config")}},{key:"formatVersion",get:function(){return this.get("formatVersion")}},{key:"rootTopicKey",get:function(){return this.get("rootTopicKey")}},{key:"editorRootTopicKey",get:function(){return this.get("editorRootTopicKey")}},{key:"focusKey",get:function(){return this.get("focusKey")}},{key:"focusMode",get:function(){return this.get("focusMode")}},{key:"editingContentKey",get:function(){return this.focusMode===Lc?this.focusKey:null}},{key:"editingDescKey",get:function(){return this.focusMode===Ic?this.focusKey:null}},{key:"getTopic",value:function(e){return this.topics.get(e)}},{key:"getExtDataItem",value:function(e,t){return this.extData.get(e)||new t}},{key:"getParentTopic",value:function(e){var t=this.getTopic(e);return t.parentKey?this.getTopic(t.parentKey):null}},{key:"getTopicVisualLevel",value:function(e){for(var t=this.getTopic(e),n=0;t&&t.key!==this.editorRootTopicKey;)n++,t=this.getParentTopic(t.key);return n}},{key:"rootTopic",get:function(){return this.getTopic(this.rootTopicKey)}},{key:"zoomFactor",get:function(){return this.get("zoomFactor")}}],[{key:"isModel",value:function(e){return e instanceof n}},{key:"create",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null==t)return n.createEmpty();if(n.isModel(t)&&(e=t),jc(t)&&(e=n.fromJSON(t)),e)return null==e.focusKey&&(e=e.set("focusKey",e.rootTopicKey)),null==e.focusMode&&(e=e.set("focusMode",Dc)),e;throw new Error("`Value.create` only accepts objects or values, but you passed it: ".concat(t))}},{key:"createEmpty",value:function(){var e=new n,t=ui.create({key:li(),content:"RootTopic"});return e.update("topics",(function(e){return e.set(t.key,t)})).set("rootTopicKey",t.key).set("editorRootTopicKey",t.key).set("focusKey",t.key).set("focusMode",Dc)}},{key:"fromJSON",value:function(e){var t=new n,o=e.topics,r=void 0===o?[]:o,c=e.config,i=void 0===c?{}:c,a=e.rootTopicKey,l=e.editorRootTopicKey;return void 0===l&&(l=a),t=(t=t.merge({rootTopicKey:a,editorRootTopicKey:l})).withMutations((function(e){r.forEach((function(t){e.update("topics",(function(e){return e.set(t.key,ui.fromJSON(t))}))})),e.set("config",ai.fromJSON(i))}))}}]),n}(Object(j.Record)(bi));function hi(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.plugins,n=void 0===t?[]:t;return Object(v.a)(n)}y()("core:controller");function Oi(e,t){if(Array.isArray(t))t.forEach((function(t){return Oi(e,t)}));else if(null!=t)for(var n in t){var o=t[n];e.middleware[n]=e.middleware[n]||[],e.middleware[n].push(o)}}function mi(e){if(!Array.isArray(e))throw new TypeError("Middleware stack must be an array!");var t,n=Object(m.a)(e);try{for(n.s();!(t=n.n()).done;){if("function"!==typeof t.value)throw new TypeError("Middleware must be composed of functions!")}}catch(o){n.e(o)}finally{n.f()}return function(t,n){var r=-1;return function c(i){if(i<=r)throw new Error("next() called multiple times");r=i;var a=e[i];i===e.length&&(a=n);if(!a)return null;try{return a(t,c.bind(null,i+1))}catch(o){throw o}}(0)}}var vi,ji,Ti,Ei,ki,xi,Si,Ci,wi,Ri,Ki,Di,Li,Ii,_i,Mi,Ai,Fi,Pi,Ni,Bi,zi,Vi,Hi,Gi,Ui,Wi,Zi,Yi,Ji,Xi,qi,Qi,$i,ea,ta,na,oa,ra,ca,ia,aa,la,ua,sa,pa,da,fa,ya,ba,ga,ha,Oa,ma,va,ja,Ta,Ea=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(a.a)(this,e);var n=t.plugins,o=void 0===n?[]:n,r=t.onChange,c=t.readOnly;this.readOnly=c,this.onChange=r,this.middleware=new Map;var i=hi({plugins:o});Oi(this,i)}return Object(l.a)(e,[{key:"run",value:function(e){var t=this.middleware,n=t[e]||[];Ec(0!==n.length,"the middleware function ".concat(e," is not found!"));for(var o=Object(k.a)(mi)(n),r=arguments.length,c=new Array(r>1?r-1:0),i=1;i<r;i++)c[i-1]=arguments[i];return o.apply(void 0,c)}},{key:"getValue",value:function(e,t){return this.run("getValue",Object(O.a)(Object(O.a)({},t),{},{propKey:e}))}},{key:"change",value:function(e,t){this.onChange(e,t),this.currentModel=e}}]),e}(),ka=n(83),xa=n(55),Sa=n(56),Ca=n(61),wa=n(41),Ra=n(65),Ka=n(6),Da=(n(519),["title"]),La=["layout","title"],Ia=["layout","title"],_a=["controller","children","onClick"],Ma=["text"],Aa=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){return Object(a.a)(this,n),t.call(this,e)}return Object(l.a)(n,[{key:"operation",value:function(e,t){this.props.controller.run("operation",Object(O.a)({opType:e},t))}},{key:"run",value:function(e,t){this.props.controller.run(e,t)}},{key:"topic",get:function(){return this.props.model.getTopic(this.props.topicKey)}}]),n}(o.Component),Fa=y()("node:drag-scroll-widget"),Pa=d.default.div(vi||(vi=Object(Ka.a)(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: scroll;\n"]))),Na=d.default.div(ji||(ji=Object(Ka.a)(["\n  position: relative;\n  width: max-content;\n"]))),Ba=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).contentResizeCallback=function(e,t){if(o.oldContentRect){var n={width:o.content.clientWidth+2*o.viewBox.clientWidth,height:o.content.clientHeight+2*o.viewBox.clientHeight};o.bigView.style.width=n.width+"px",o.bigView.style.height=n.height+"px"}o.oldContentRect=e[0].contentRect},o.contentResizeObserver=new p.a(o.contentResizeCallback),o.contentRef=function(e){e&&(o.content=e,o.contentResizeObserver.observe(o.content))},o.viewBoxRef=function(e){e&&(o.viewBox=e,o.props.enableMouseWheel||(Fa("addEventListener onwheel"),o.viewBox.addEventListener("wheel",(function(e){Fa("onwheel"),(e.ctrlKey||e.altKey)&&e.preventDefault()}),{passive:!1})),o.setViewBoxScroll(o.viewBox.clientWidth,o.viewBox.clientHeight))},o.bigViewRef=function(e){e&&(o.bigView=e)},o.setWidgetStyle=function(){o.content&&o.viewBox&&o.bigView&&(o.bigView.style.width=2*(o.content.clientWidth+o.viewBox.clientWidth)+"px",o.bigView.style.height=2*(o.content.clientHeight+o.viewBox.clientHeight)+"px",o.content.style.left=o.viewBox.clientWidth+"px",o.content.style.top=o.viewBox.clientHeight+"px")},o.setViewBoxScroll=function(e,t){Fa("setViewBoxScroll ".concat(e," ").concat(t)),o.viewBox&&(o.viewBox.scrollLeft=e,o.viewBox.scrollTop=t)},o.setViewBoxScrollDelta=function(e,t){Fa("setViewBoxScrollDelta ".concat(e," ").concat(t)),o.viewBox&&(o.viewBox.scrollLeft+=e,o.viewBox.scrollTop+=t)},o.onMouseDown=function(e){var t=o.props,n=t.mouseKey,r=t.needKeyPressed,c=t.canDragFunc;if((!c||c())&&(0===e.button&&"left"===n||2===e.button&&"right"===n)){if(r&&!e.ctrlKey)return;o._lastCoordX=o.viewBox.scrollLeft+e.nativeEvent.clientX,o._lastCoordY=o.viewBox.scrollTop+e.nativeEvent.clientY;var i=o.viewBox;i.addEventListener("mousemove",o.onMouseMove),i.addEventListener("mouseup",o.onMouseUp)}},o.onMouseUp=function(e){var t=o.viewBox;t.removeEventListener("mousemove",o.onMouseMove),t.removeEventListener("mouseup",o.onMouseUp)},o.onMouseMove=function(e){o.viewBox.scrollLeft=o._lastCoordX-e.clientX,o.viewBox.scrollTop=o._lastCoordY-e.clientY},o.handleContextMenu=function(e){e.preventDefault()},o.state={widgetStyle:{width:"10000px",height:"10000px"}},o}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.setWidgetStyle(),document.addEventListener("contextmenu",this.handleContextMenu)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("contextmenu",this.handleContextMenu)}},{key:"setZoomFactor",value:function(e){this.bigView.style.transform="scale(".concat(e,")"),this.bigView.style.transformOrigin="50% 50%"}},{key:"render",value:function(){var e=Object(O.a)({},this.state.widgetStyle);return Object(o.createElement)(Pa,{ref:this.viewBoxRef,onMouseDown:this.onMouseDown},Object(o.createElement)("div",{style:e,ref:this.bigViewRef},Object(o.createElement)(Na,{ref:this.contentRef,style:this.state.contentStyle},this.props.children(this.setViewBoxScroll,this.setViewBoxScrollDelta))))}}]),n}(o.Component);Ba.defaultProps={mouseKey:"left",needKeyPressed:!1};var za=y()("node:save-ref"),Va=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).getRef=function(t){return za(Object(Ra.a)(e)),e[t]},e.saveRef=function(t){return function(n){n&&(e[t]=n,e.fireListener(t,n))}},e.deleteRef=function(t){za("deleteRef:",t),delete e[t]},e.observers=new Map,e.fireListener=function(t,n){if(e.observers.has(t)){var o,r=e.observers.get(t),c=Object(m.a)(r);try{for(c.s();!(o=c.n()).done;){(0,o.value)(t,n)}}catch(i){c.e(i)}finally{c.f()}}},e.registerRefListener=function(t,n){e.observers.has(t)?e.observers.get(t).push(n):e.observers.set(t,[n])},e}return Object(l.a)(n,[{key:"render",value:function(){return this.props.children(this.saveRef,this.getRef,this.deleteRef,this.registerRefListener.bind(this))}}]),n}(o.Component),Ha=d.default.div(Ti||(Ti=Object(Ka.a)(["\n  display: flex;\n  flex-direction: ",";\n  align-items: ",";\n  justify-content: ",";\n"])),(function(e){return e.flexDirection?e.flexDirection:"row"}),(function(e){return e.alignItems}),(function(e){return e.justifyContent})),Ga=d.default.div(Ei||(Ei=Object(Ka.a)(["\n  margin: ",";\n"])),(function(e){return e.margin})),Ua=d.default.a(ki||(ki=Object(Ka.a)(["\n  font-size: 20px !important;\n"]))),Wa=d.default.div(xi||(xi=Object(Ka.a)(["\n  padding: 5px;\n  cursor: pointer;\n"]))),Za=d.default.div(Si||(Si=Object(Ka.a)(["\n  cursor: pointer;\n  &:hover {\n    color: #1ea7fd;\n  }\n"]))),Ya=Object(d.default)(b.e)(Ci||(Ci=Object(Ka.a)(["\n  margin-bottom: 0px !important;\n"]))),Ja=Object(d.default)(Za)(wi||(wi=Object(Ka.a)(["\n  position: absolute;\n  right: 5px;\n  top: 5px;\n  //padding: 5px;\n"]))),Xa=d.default.div(Ri||(Ri=Object(Ka.a)(["\n  height: 16px;\n"]))),qa=d.default.span(Ki||(Ki=Object(Ka.a)(["\n  margin: 0px 10px;\n  &:hover {\n    color: palevioletred;\n  }\n"]))),Qa=d.default.div(Di||(Di=Object(Ka.a)(["\n  z-index: ",";\n"])),(function(e){return e.zIndex})),$a=d.default.div(Li||(Li=Object(Ka.a)(["\n  min-width: 380px;\n  max-width: 482px;\n  max-height: 470px;\n  overflow: auto;\n"]))),el=d.default.div(Ii||(Ii=Object(Ka.a)(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n"]))),tl=(d.default.div(_i||(_i=Object(Ka.a)(["\n  max-height: ",";\n  overflow-y: auto;\n  overflow-x: hidden;\n"])),(function(e){return e.maxHeight||"300px"})),d.default.div(Mi||(Mi=Object(Ka.a)(["\n  margin-top: 10px;\n  margin-bottom: 5px;\n  font-weight: bold;\n"])))),nl=d.default.span(Ai||(Ai=Object(Ka.a)(["\n  margin: 0 10px 0 2px;\n"]))),ol=d.default.div(Fi||(Fi=Object(Ka.a)(["\n  padding: 10px;\n  margin: 0 0 10px 0;\n  border: rgba(16, 22, 26, 0.15) solid 1px;\n  border-radius: 5px;\n"]))),rl=Object(d.default)(nl)(Pi||(Pi=Object(Ka.a)([""]))),cl=d.default.div(Ni||(Ni=Object(Ka.a)(["\n  display: flex;\n  align-items: center;\n  //justify-content: center;\n  margin: 5px 0;\n"]))),il=d.default.div(Bi||(Bi=Object(Ka.a)(["\n  height: 3px;\n  width: 80%;\n  margin-left: 10%;\n  margin-right: 10%;\n  margin-bottom: 2px;\n  background: ",";\n"])),(function(e){return e.color})),al=d.default.div(zi||(zi=Object(Ka.a)(["\n  border: 1px solid grey;\n  cursor: pointer;\n  font-weight: bold;\n"]))),ll="show-menu",ul="close",sl="color-picker",pl="notes",dl="plus",fl="minus",yl="collapse",bl="expand",gl="center",hl="layout-left-and-right";function Ol(e){return"icon iconfont bm-".concat(e)}function ml(e){return Object(o.createElement)("span",{className:Ol(e)})}function vl(e){return"content-".concat(e)}function jl(e){return"content-editor-".concat(e)}function Tl(e){return"desc-editor-".concat(e)}function El(e){return"topic-widget-".concat(e)}function kl(e){return"topic-".concat(e)}function xl(e){return"links-".concat(e)}function Sl(e){return"links-svg-".concat(e)}function Cl(e){return"collapse-".concat(e)}function wl(e,t){return"dropArea-".concat(t,"-").concat(e)}var Rl="DIAGRAM-ROOT",Kl="DragScrollWidget",Dl="svg-highlight",Ll="focus-highlight",Il="drop-effect",_l="CENTER_ROOT_TOPIC",Ml="DIAGRAM_CUSTOMIZE_BASE_Z_INDEX",Al="TOPIC_CONTEXT_MENU_ENABLED",Fl="TOPIC_TITLE",Pl="DRAG_DROP_STATE",Nl="RIGHT_TOP_PANEL_STATE",Bl="OPERATION_ENABLED",zl="CONFIRM",Vl="CANCEL",Hl="DEFAULT",Gl="SEARCH",Ul="LEFT_AND_RIGHT",Wl="ONLY_LEFT",Zl="ONLY_RIGHT",Yl="EDIT",Jl="ADD_SIBLING",Xl="ADD_CHILD",ql="EDIT_NOTES",Ql="DELETE",$l="SET_AS_EDITOR_ROOT",eu="EDIT_TOPOLOGY_DIAGRAM",tu="SET_TOPIC_REFERENCES",nu="TOPIC_STYLE",ou="STYLE",ru="TEXT_EDITOR",cu="LINK",iu="LINK_TO_PARENT",au="SUB_LINKS",lu="COPY_STYLE",uu="PASTE_STYLE",su="CLEAR_TOPIC_STYLE",pu="CLEAR_ALL_CUSTOM_STYLE",du="LINE_TYPE",fu="THEME",yu="GLOBAL",bu="HIGHLIGHT",gu="RANDOM_COLOR",hu="NORMAL_TOPIC",Ou="PRIMARY_TOPIC",mu="ROOT_TOPIC",vu="EXPORT_THEME",ju="IMPORT_THEME",Tu="TAGS",Eu="TAGS_MANAGER",ku="TAG_NAME",xu="ADD_TAG",Su="UPDATE_TAG",Cu="ALREADY_ADDED",wu="CAN_BE_ADDED",Ru="TOPICS_THAT_USE_THIS_TAG",Ku="BACKGROUND",Du="COLOR",Lu="BORDER",Iu="WIDTH",_u="RADIUS",Mu="FONT_SIZE",Au="LINE_HEIGHT",Fu="PADDING",Pu="TOP",Nu="BOTTOM",Bu="LEFT",zu="RIGHT",Vu="NONE",Hu="SOLID",Gu="DOTTED",Uu="DASHED",Wu="DOUBLE",Zu="ROUND",Yu="CURVE",Ju="LINE",Xu="COLLAPSE_ALL",qu="EXPAND_ALL",Qu="CENTER_ROOT_TOPIC",$u="ZOOM",es="ZOOM_IN",ts="ZOOM_OUT",ns="RESET",os="RESET_ZOOM",rs="NOTE_PLACEHOLDER",cs="TOPOLOGY_DIAGRAM_EDITOR",is="BASIC",as="FLOW_GRAPH",ls="ACTIVITY_DIAGRAM",us="SEQUENCE_DIAGRAM",ss="CLASS_DIAGRAM",ps="REFERENCE_TOPICS",ds="REFERENCED_TOPICS",fs="SELECT_REF_TOPICS_TIP",ys="TAG_NAME_OVER_MAX_TIP",bs="DELETE_TAG_TIP",gs="DELETE_TOPOLOGY_TIP",hs=function(e){e.stopPropagation()};function Os(e,t){!function(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.click()}("data:text/plain,".concat(encodeURIComponent(e)),t)}function ms(e){var t=e.top,n=void 0===t?0:t,o=e.right,r=void 0===o?0:o,c=e.bottom,i=void 0===c?0:c,a=e.left,l=void 0===a?0:a;return"".concat(n,"px ").concat(r,"px ").concat(i,"px ").concat(l,"px")}function vs(e,t){return Array.isArray(t)?t.map((function(t){return e.controller.run("getI18nText",Object(O.a)(Object(O.a)({},e),{},{key:t}))})):e.controller.run("getI18nText",Object(O.a)(Object(O.a)({},e),{},{key:t.toUpperCase()}))}function js(e){return(e.top+e.bottom)/2}function Ts(e,t){return(e.x+t.x)/2}function Es(e,t){return(e.y+t.y)/2}function ks(e){return[(e.left+e.right)/2,(e.top+e.bottom)/2]}function xs(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=e.getBoundingClientRect(),r=t.getBoundingClientRect(),c=ks(r),i=ks(o);i[0]=(i[0]-c[0])/n,i[1]=(i[1]-c[1])/n;var a=o.width/n,l=o.height/n;return{left:i[0]-a/2,right:i[0]+a/2,top:i[1]-l/2,bottom:i[1]+l/2,width:a,height:l}}function Ss(e,t){var n=e.getBoundingClientRect(),o=ks(t.getBoundingClientRect()),r=ks(n);return[r[0]-o[0],r[1]-o[1]]}function Cs(e){return Object(o.createElement)("div",null,e.children,Object(o.createElement)(b.h,{style:{margin:"10px 0"}}))}function ws(e){var t=e.title,n=e.layout,r=void 0===n?"h":n,c=e.color,i=e.handleColorChange,a={flexDirection:"h"===r?"row":"column",alignItems:"center"};return Object(o.createElement)(nl,null,Object(o.createElement)(Ha,Object.assign({},a),null!=t&&Object(o.createElement)(Ga,{margin:"0 5px 0 0"},t),Object(o.createElement)(b.s,null,Object(o.createElement)(al,null,Object(o.createElement)("div",{className:Ol(sl)}),Object(o.createElement)(il,{color:c})),Object(o.createElement)("div",null,Object(o.createElement)(rt.a,{color:c,onChangeComplete:function(e){return i(e.hex)}})))))}function Rs(e){var t=e.title,n=Object(wa.a)(e,Da);return Object(o.createElement)(nl,null,Object(o.createElement)(b.d,Object.assign({},n),t))}function Ks(e){var t=e.layout,n=void 0===t?"h":t,r=e.title,c=Object(wa.a)(e,La),i={flexDirection:"h"===n?"row":"column",alignItems:"center"};return Object(o.createElement)(nl,null,Object(o.createElement)(Ha,Object.assign({},i),Object(o.createElement)(Ga,{margin:"0 5px 0 0"},r),Object(o.createElement)(b.q,Object.assign({},c))))}function Ds(e){var t=e.layout,n=void 0===t?"h":t,r=e.title,c=Object(wa.a)(e,Ia),i={flexDirection:"h"===n?"row":"column",alignItems:"center"};return Object(o.createElement)(nl,null,Object(o.createElement)(Ha,Object.assign({},i),Object(o.createElement)(Ga,{margin:"0 5px 0 0"},r," "),Object(o.createElement)(b.m,Object.assign({},c))))}function Ls(e){var t=e.text,n=e.items,r=e.itemRenderer,c=e.onItemSelect,i=ot.a.ofType(),a={items:n,itemRenderer:r,onItemSelect:c,filterable:!1};return Object(o.createElement)(nl,null,Object(o.createElement)(i,Object.assign({},a),Object(o.createElement)(b.d,{text:t})))}var Is=function(e){return function(t,n){var r=n.handleClick;return Object(o.createElement)(b.p,{text:"".concat(t).concat(e),key:t,onClick:r})}},_s=function(e){return function(t,n){var r=n.handleClick;return Object(o.createElement)(b.p,{text:vs(e,t),key:t,onClick:r})}},Ms=(ot.a.ofType(),Object(v.a)(Array(7).keys())),As=d.default.div(Vi||(Vi=Object(Ka.a)(["\n  position: relative;\n  padding: 6px;\n  width: 40px;\n  height: 40px;\n  cursor: pointer;\n  color: ",";\n  font-size: 24px;\n  display: inline-block;\n  &:hover {\n    color: ",";\n  }\n"])),(function(e){return e.disabled?"grey":"black"}),(function(e){return e.disabled?"grey":"rgb(44, 184, 146)"}));function Fs(e){var t=e.controller,n=e.children,r=e.onClick,c=Object(wa.a)(e,_a),i=e.disabled;i=i||!t.getValue(Bl,e);var a=Object(O.a)({controller:t,disabled:i,onClick:function(e){i||r(e)}},c);return Object(o.createElement)(As,Object.assign({},a),n)}var Ps=y()("plugin:event");function Ns(){var e={};return{handleTopicClick:function(e){Ps("handleTopicClick");var t=e.controller,n=e.model,o=e.topicKey;Ps(n.zoomFactor),null===n.editingDescKey&&n.editingContentKey!==o&&(n.focusKey===o&&n.focusMode===Lc||t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Zc,focusMode:Dc})))},handleTopicDoubleClick:function(e){var t=e.controller;null===e.model.editingDescKey&&t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Zc,focusMode:Lc}))},handleTopicContextMenu:function(e){e.controller.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Zc,focusMode:_c}))},handleActiveModalClose:function(e){var t=e.controller,n=t.run("getActiveModalProps",e);return null==n?null:"edit-desc"===n.name?function(){t.run("operation",Object(O.a)(Object(O.a)({},e),{},{focusMode:Dc,opType:Zc}))}:void 0},addEventListener:function(t){var n=t.key,o=t.listener,r=t.once,c=t.controller;function i(){o(),c.run("removeEventListener",{key:n,listener:o})}e[n]||(e[n]=[]),r?(i.origin=o,e[n].push(i)):e[n].push(o)},removeEventListener:function(t){var n=t.key,o=t.listener;e[n]&&(e[n]=e[n].filter((function(e){return e!==o&&e.origin!==o})))},fireEvent:function(t){var n=t.key;e[n]&&e[n].forEach((function(e){return e()}))}}}var Bs="ADD_CHILD",zs="ADD_SIBLING",Vs="DELETE_TOPIC",Hs="EDIT_CONTENT",Gs="EDIT_NOTES",Us="SET_EDITOR_ROOT",Ws=0,Zs=1;function Ys(){return{customizeHotKeys:function(e){var t=function(t){return function(n){!function(e,t){var n=t,o=n.topicKey,r=n.model,c=n.controller;void 0===o&&(t=Object(O.a)(Object(O.a)({},t),{},{topicKey:r.focusKey})),c.run("operation",Object(O.a)(Object(O.a)({},t),{},{opType:e}))}(t,e)}};return{topicHotKeys:new Map([[Bs,{label:"add child",combo:"tab",onKeyDown:t(Gc)}],[zs,{label:"add sibling",combo:"enter",onKeyDown:t(Uc)}],[Vs,{label:"delete topic",combo:"del",onKeyDown:t(Wc)}],[Hs,{label:"edit content",combo:"space",onKeyDown:t(ei)}],[Gs,{label:"edit notes",combo:"alt + d",onKeyDown:t(ti)}],[Us,{label:"set editor root",combo:"alt + shift + f",onKeyDown:t(oi)}]]),globalHotKeys:new Map}}}}function Js(){var e=new Map([[zl,"Confirm"],[Vl,"Cancel"],[Hl,"Default"],[Gl,"Search"],[Ul,"Left And Right"],[Wl,"Only Left"],[Zl,"Only Right"],[Yl,"Edit"],[Xl,"Add Child"],[Jl,"Add Sibling"],[ql,"Edit Notes"],[Ql,"Delete"],[$l,"Set as Editor Root"],[eu,"Edit Topology Diagram"],[tu,"Set Topic References"],[nu,"TopicStyle"],[ou,"Style"],[ru,"Text Editor"],[cu,"Link"],[iu,"LinkToParent"],[au,"SubLinks"],[lu,"Copy Style"],[uu,"Paste Style"],[su,"Clear Topic Style"],[pu,"Clear All Custom Style"],[du,"LineType"],[fu,"Theme"],[yu,"Global"],[bu,"Highlight"],[gu,"Random Color"],[hu,"NormalTopic"],[Ou,"PrimaryTopic"],[mu,"RootTopic"],[vu,"Export Theme"],[ju,"Import Theme"],[Tu,"Tags"],[Eu,"Tags Manager"],[ku,"Tag Name"],[xu,"Add Tag"],[Su,"Update Tag"],[Cu,"Already Added"],[wu,"Can be Added"],[Ru,"Topics that Use this Tag"],[Ku,"Background"],[Du,"Color"],[Lu,"Border"],[Iu,"Width"],[_u,"Radius"],[Mu,"FontSize"],[Au,"LineHeight"],[Fu,"Padding"],[Pu,"Top"],[Nu,"Bottom"],[Bu,"Left"],[zu,"Right"],[Vu,"None"],[Hu,"Solid"],[Gu,"Dotted"],[Uu,"Dashed"],[Wu,"Double"],[Zu,"Round"],[Yu,"Curve"],[Ju,"Line"],[Xu,"Collapse All"],[qu,"Expand All"],[Qu,"Center Root Topic"],[$u,"zoom"],[es,"Zoom In"],[ts,"Zoom Out"],[ns,"Reset"],[os,"Reset Zoom"],[rs,"Write topic notes here"],[cs,"Topology Diagram Editor"],[is,"Basic"],[as,"Flow Graph"],[ls,"Activity Diagram"],[us,"Sequence Diagram"],[ss,"Class Diagram"],[ps,"Reference Topics"],[ds,"Referenced Topics"],[fs,"Please select the topics you want to reference. After selection, click the confirm button."],[ys,"The length of tag name over the maximum length: 50!"],[bs,"All the relationship about this tag will be lost if you delete this tag! Are you confirm?"],[gs,"Are you confirm to delete this topology diagram?"]]);return{getI18nTextMap:function(){return e},getI18nText:function(e){var t=e.controller,n=e.key,o=t.run("getI18nTextMap",e);if(!o.has(n))throw new Error("i18n key ".concat(n," is not exist"));return o.get(n)}}}var Xs=y()("plugin:operation");function qs(){var e=new Map([[Bc,yi.toggleCollapse],[zc,yi.collapseAll],[Vc,yi.expandAll],[Hc,yi.expandTo],[Gc,yi.addChild],[Uc,yi.addSibling],[Wc,yi.deleteTopic],[Zc,yi.focusTopic],[Yc,yi.setFocusMode],[Jc,yi.setStyle],[Xc,yi.clearAllCustomStyle],[qc,yi.setTheme],[Qc,yi.setBlockData],[$c,yi.deleteBlock],[ei,function(e){var t=e.model,n=e.topicKey;return yi.focusTopic({model:t,topicKey:n,focusMode:Lc})}],[ti,function(e){var t=e.model,n=e.topicKey,o=t.getTopic(n).getBlock(Kc);return null!=o.block&&null!=o.block.data||(t=yi.setBlockData({model:t,topicKey:n,blockType:Kc,data:""})),t=yi.focusTopic({model:t,topicKey:n,focusMode:Ic})}],[ni,function(e){var t=e.srcKey,n=e.dstKey,o=e.dropDir,r=e.model,c=r.getTopic(t),i=r.getTopic(n),a=c.parentKey,l=r.getTopic(a).subKeys,u=l.indexOf(t);if(l=l.delete(u),"in"===o){var s=i.subKeys;s=s.push(t),r=r.withMutations((function(e){e.setIn(["topics",a,"subKeys"],l).setIn(["topics",t,"parentKey"],n).setIn(["topics",n,"subKeys"],s).setIn(["topics",n,"collapse"],!1)}))}else{var p=i.parentKey,d=r.getTopic(p).subKeys,f=d.indexOf(n);if(a===p){var y=Object(j.List)();d.forEach((function(e){e!==t&&(y=e===n?"prev"===o?y.push(t).push(e):y.push(e).push(t):y.push(e))})),r=r.withMutations((function(e){e.setIn(["topics",p,"subKeys"],y)}))}else"prev"===o?d=d.insert(f,t):"next"===o&&(d=d.insert(f+1,t)),r=r.withMutations((function(e){e.setIn(["topics",a,"subKeys"],l).setIn(["topics",t,"parentKey"],p).setIn(["topics",p,"subKeys"],d).setIn(["topics",p,"collapse"],!1)}))}return r}],[oi,yi.setEditorRootTopicKey],[ri,yi.setLayoutDir]]),t=Object(j.Stack)(),n=Object(j.Stack)(),o=!0,r=new Set;return{isOperationEnabled:function(e){return o},enableOperation:function(){o=!0},disableOperation:function(e){var t=e.whiteList;o=!1,t?r=new Set(t):r.clear()},getOpMap:function(t){return e},getAllowUndo:function(e){var t=e.model,n=e.opType,o=e.allowUndo;if(!1===(void 0===o||o))return!1;if(n)switch(n){case Zc:case Yc:case ei:case ti:return!1}switch(t.focusMode){case"EDITING_DESC":case"EDITING_CONTENT":return!1}return t.config.allowUndo},getUndoRedoStack:function(){return{undoStack:t,redoStack:n}},setUndoStack:function(e){Xs("setUndoStack",e.undoStack),t=e.undoStack},setRedoStack:function(e){Xs("setRedoStack",e.redoStack),n=e.redoStack},canUndo:function(e){var t=e.controller;if(!t.run("isOperationEnabled",e))return!1;var n=t.run("getUndoRedoStack",e).undoStack,o=t.run("getAllowUndo",e);return n.size>0&&o},canRedo:function(e){var t=e.controller;if(!t.run("isOperationEnabled",e))return!1;var n=t.run("getUndoRedoStack",e).redoStack,o=t.run("getAllowUndo",e);return n.size>0&&o},undo:function(e){var t=e.controller,n=e.model;if(t.run("getAllowUndo",e)){var o=t.run("getUndoRedoStack",e),r=o.undoStack,c=o.redoStack,i=r.peek();i&&(t.run("setUndoStack",Object(O.a)(Object(O.a)({},e),{},{undoStack:r.shift()})),t.run("setRedoStack",Object(O.a)(Object(O.a)({},e),{},{redoStack:c.push(n)})),Xs(i),t.change(i))}},redo:function(e){var t=e.controller,n=e.model;if(t.run("getAllowUndo",e)){var o=t.run("getUndoRedoStack",e),r=o.undoStack,c=o.redoStack,i=c.peek();i&&(t.run("setUndoStack",Object(O.a)(Object(O.a)({},e),{},{undoStack:r.push(n)})),t.run("setRedoStack",Object(O.a)(Object(O.a)({},e),{},{redoStack:c.shift()})),t.change(i))}},operation:function(e){var t=e.controller,n=e.opType,o=e.model,c=e.opArray,i=e.callback;if(null!=c&&!Array.isArray(c))throw new Error("operation: the type of opArray must be array!");if(null!=n&&null!=c)throw new Error("operation: opType and opArray conflict!");if(!t.run("isOperationEnabled",e)){if(0===r.size)return;if(null!=c){var a=c.filter((function(e){return!r.has(e.opType)}));if(a&&a.length>0)return}else if(!r.has(n))return}Xs("operation:",n||c.map((function(e){return e.opType}))),Xs("operation:",o),Xs("operation:",e);var l,u=t.run("getOpMap",e);if(t.run("beforeOperation",e),t.run("getAllowUndo",e)){var s=t.run("getUndoRedoStack",e).undoStack;t.run("setUndoStack",Object(O.a)(Object(O.a)({},e),{},{undoStack:s.push(o)}))}if(null!=c)l=c.reduce((function(e,n){var o=n.opType;if(!u.has(o))throw new Error("opType:".concat(o," not exist!"));var r=u.get(o),c=Object(O.a)(Object(O.a)({controller:t},n),{},{model:e}),i=t.run("beforeOpFunction",c);return i=r(Object(O.a)(Object(O.a)({},c),{},{model:i})),i=t.run("afterOpFunction",Object(O.a)(Object(O.a)({},c),{},{model:i}))}),o);else{if(!u.has(n))throw new Error("opType:".concat(n," not exist!"));var p=u.get(n);l=t.run("beforeOpFunction",e),l=p(Object(O.a)(Object(O.a)({},e),{},{model:l})),l=t.run("afterOpFunction",Object(O.a)(Object(O.a)({},e),{},{model:l}))}Xs("newModel:",l),t.change(l,i?i(l):null),t.run("afterOperation",e)},deleteRefKey:function(e){var t=e.model,n=e.topicKey,o=e.deleteRef,r=si(t,n);r.push(n);var c,i=Object(m.a)(r);try{for(i.s();!(c=i.n()).done;){var a=c.value;o(xl(a)),o(Sl(a)),o(vl(a)),o(jl(a)),o(Tl(a)),o(El(a)),o(kl(a)),o(Cl(a)),o(wl(a,"next")),o(wl(a,"prev"))}}catch(l){i.e(l)}finally{i.f()}},beforeOperation:function(e){},afterOperation:function(e){},beforeOpFunction:function(e){var t=e.controller,n=e.opType,o=e.model,r=e.topicKey;return n===Wc&&r!==o.editorRootTopicKey&&t.run("deleteRefKey",e),o},afterOpFunction:function(e){return e.model},openNewModel:function(e){var t=e.model,n=e.controller,o=e.newModel;n.run("deleteRefKey",Object(O.a)(Object(O.a)({},e),{},{topicKey:t.rootTopicKey})),n.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Hc,topicKey:o.focusKey,model:o,callback:function(t){return function(){n.run("moveTopicToCenter",Object(O.a)(Object(O.a)({},e),{},{model:t,topicKey:t.focusKey}))}}}))}}}var Qs=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.controller;return Object(o.createElement)(b.n,null,e.run("customizeTopicContextMenu",this.props))}}]),n}(Aa),$s=[{icon:"edit",label:Yl,shortcut:"Space",rootCanUse:!0,opType:ei},{icon:"add-sibling",label:Jl,shortcut:"Enter",opType:Uc},{icon:"add-child",label:Xl,shortcut:"Tab",rootCanUse:!0,opType:Gc},{icon:"notes",label:ql,shortcut:"Alt + D",rootCanUse:!0,opType:ti},{icon:"delete-node",label:Ql,shortcut:"Del",opType:Wc},{icon:"root",label:$l,shortcut:"Alt + Shift + F",opType:oi}];function ep(){return{renderTopicContextMenu:function(e){return Object(o.createElement)(Qs,Object.assign({},e))},customizeTopicContextMenu:function(e){var t=e.topicKey,n=e.model,r=e.controller,c=t===n.editorRootTopicKey;function i(t){return function(n){t.opType&&r.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:t.opType}))}}return $s.map((function(t){return c&&!t.rootCanUse?null:Object(o.createElement)(b.p,{key:t.label,icon:ml(t.icon),text:vs(e,t.label),labelElement:Object(o.createElement)("kbd",null,t.shortcut),onClick:i(t)})}))}}}var tp=y()("node:topic-drop-effect"),np=d.default.svg(Hi||(Hi=Object(Ka.a)(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"]))),op=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).state={content:null},e}return Object(l.a)(n,[{key:"layout",value:function(){var e=this.props,t=e.getRef,n=e.model,r=e.zoomFactor,c=e.diagramState.dragDrop;if(null!=c){var i=c.targetKey,a=c.targetDir;if(tp("layout",a),null!=i){var l=t("in"===a?vl(i):wl(i,a)),u=t("svg-drop-effect"),s=t(Kl).bigView,p=xs(l,s,r),d=xs(u,s,r),f=p.left-d.left-3,y=p.top-d.top-3,b=p.width+6,g=p.height+6;this.setState({content:Object(o.createElement)("g",null,Object(o.createElement)("rect",{x:f,y:y,width:b,height:g,fill:"none",stroke:n.config.theme.highlightColor,strokeDasharray:"5,5",strokeWidth:2}))})}else this.setState({content:null})}else this.setState({content:null})}},{key:"render",value:function(){var e=this.props.saveRef;return Object(o.createElement)(np,{ref:e("svg-drop-effect")},this.state.content)}}]),n}(Aa),rp=y()("plugin:drag-and-drop"),cp=d.default.div(Gi||(Gi=Object(Ka.a)(["\n  height: ",";\n  width: 100%;\n  margin: 5px 0px;\n"])),(function(e){return"".concat(e.height,"px")}));function ip(){return{renderTopicDropArea:function(e){var t=e.topicKey,n=e.dropDir,r=e.saveRef,c=e.controller,i=e.model,a={onDragEnter:function(o){rp("onDragEnter",t,n),c.run("handleTopicDragEnter",Object(O.a)(Object(O.a)({},e),{},{ev:o,dropDir:n}))},onDragLeave:function(o){rp("onDragLeave",t,n),c.run("handleTopicDragLeave",Object(O.a)(Object(O.a)({},e),{},{ev:o,dropDir:n}))},onDragOver:function(e){e.preventDefault()},onDrop:function(o){rp("onDrop",t,n),c.run("handleTopicDrop",Object(O.a)(Object(O.a)({},e),{},{ev:o,dropDir:n}))}};return Object(o.createElement)(cp,Object.assign({height:i.config.theme.marginV/2,ref:r(wl(t,n))},a))},renderDragAndDropEffect:function(e){rp("renderDragAndDropEffect");var t=e.saveRef;return Object(o.createElement)(op,Object.assign({ref:t(Il)},e))},handleTopicDragStart:function(e){var t=e.controller;e.ev.stopPropagation(),t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Zc,focusMode:Mc}))},canDrop:function(e){var t=e.srcKey,n=e.dstKey,o=e.model,r=e.dropDir;return t!==o.editorRootTopicKey&&t!==n&&pi(o,t,n)!==Ac&&((n!==o.editorRootTopicKey||"in"===r)&&(o.getTopic(t).parentKey!==n||"in"!==r))},handleTopicDragEnter:function(e){var t=e.dropDir,n=e.topicKey,o=e.controller,r=e.model,c=e.diagramState,i=e.setDiagramState;rp("handleTopicDragEnter:",n,t),o.run("canDrop",Object(O.a)(Object(O.a)({},e),{},{srcKey:r.focusKey,dstKey:n}))&&i(Object(O.a)(Object(O.a)({},c),{},{dragDrop:{targetKey:n,targetDir:t}}))},handleTopicDragLeave:function(e){var t=e.topicKey,n=e.dropDir,o=e.getRef,r=e.ev,c=e.diagramState,i=e.setDiagramState,a=r.nativeEvent.relatedTarget;rp("handleTopicDragLeave:",t,n);var l=o(vl(t));l==a||l.contains(a)||i(Object(O.a)(Object(O.a)({},c),{},{dragDrop:null}))},handleTopicDrop:function(e){rp("handleTopicDrop");var t=e,n=t.controller,o=t.topicKey,r=t.model,c=t.diagramState,i=t.setDiagramState;e=Object(O.a)(Object(O.a)({},e),{},{srcKey:r.focusKey,dstKey:o}),i(Object(O.a)(Object(O.a)({},c),{},{dragDrop:null})),n.run("canDrop",e)&&n.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:ni}))}}}function ap(e,t,n,o){var r,c=arguments.length,i=c<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(c<3?r(i):c>3?r(t,n,i):r(t,n))||i);return c>3&&i&&Object.defineProperty(t,n,i),i}var lp=d.default.div(Ui||(Ui=Object(Ka.a)(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 5px;\n"]))),up=d.default.div(Wi||(Wi=Object(Ka.a)(["\n  width: 100%;\n  height: 100%;\n  background: ",";\n"])),(function(e){return e.theme.background})),sp=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).setZoomFactor=function(e){o.dragScrollWidget.setZoomFactor(e)},o.onWheel=function(e){if(e.altKey||e.ctrlKey){var t=o.props.controller,n=t.run("getZoomFactor",o.props);(n-=e.nativeEvent.deltaY>0?.1:-.1)<.5&&(n=.5),n>4&&(n=4),t.run("setZoomFactor",Object(O.a)(Object(O.a)({},o.props),{},{zoomFactor:n}))}},o}return Object(l.a)(n,[{key:"renderHotkeys",value:function(){var e=this.props,t=e.controller,n=e.model,r=t.run("customizeHotKeys",e);if(null===r)return null;if(!(r.topicHotKeys instanceof Map&&r.globalHotKeys instanceof Map))throw new TypeError("topicHotKeys and globalHotKeys must be a Map");var c=[];return n.focusMode!==Dc&&n.focusMode!==_c||r.topicHotKeys.forEach((function(e,t){c.push(Object(o.createElement)(b.j,Object.assign({key:t},e,{global:!0})))})),r.globalHotKeys.forEach((function(e,t){c.push(Object(o.createElement)(b.j,Object.assign({key:t},e,{global:!0})))})),Object(o.createElement)(b.k,null,c)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.getRef,n=e.model;e.controller.run("addZoomFactorChangeEventListener",Object(O.a)(Object(O.a)({},this.props),{},{listener:this.setZoomFactor}));var o=t(kl(n.editorRootTopicKey)),r=t("node-layer"),c=o.getBoundingClientRect(),i=r.getBoundingClientRect();this.dragScrollWidget.setViewBoxScrollDelta(0,c.top-i.top-this.dragScrollWidget.viewBox.getBoundingClientRect().height/2+c.height),this.layout()}},{key:"componentWillUnmount",value:function(){this.props.controller.run("removeZoomFactorChangeEventListener",Object(O.a)(Object(O.a)({},this.props),{},{listener:this.setZoomFactor}))}},{key:"dragScrollWidget",get:function(){return this.props.getRef(Kl)}},{key:"componentDidUpdate",value:function(){this.props.controller.run("fireEvent",Object(O.a)(Object(O.a)({},this.props),{},{key:_l})),this.layout()}},{key:"layout",value:function(){this.props.controller.run("layout",this.props)}},{key:"render",value:function(){var e=this,t=this.props,n=t.saveRef,r=t.model,c=t.controller,i=r.editorRootTopicKey;return Object(o.createElement)(up,{onWheel:this.onWheel},Object(o.createElement)(Ba,Object.assign({},this.state,{enableMouseWheel:!1,zoomFactor:r.zoomFactor,ref:n(Kl)}),(function(t,r){var a=Object(O.a)(Object(O.a)({},e.props),{},{topicKey:i,setViewBoxScroll:t,setViewBoxScrollDelta:r});return Object(o.createElement)(lp,{ref:n("node-layer")},c.run("renderRootWidget",a))})))}}]),n}(o.PureComponent);sp=ap([b.l],sp);var pp=d.default.div(Zi||(Zi=Object(Ka.a)(["\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: 100%;\n"]))),dp=d.default.div(Yi||(Yi=Object(Ka.a)(["\n  width: 100%;\n  //height: 100%;\n  overflow: auto;\n  flex-grow: 1;\n  background: ",";\n  position: relative;\n"])),(function(e){return e.theme.background}));function fp(e){var t=e.controller,n=e.saveRef,r=Object(o.useState)(t.run("getInitialDiagramState",e)),c=Object(Ca.a)(r,2),i=c[0],a=c[1],l=Object(O.a)(Object(O.a)({},e),{},{diagramState:i,setDiagramState:a});return Object(o.createElement)(pp,null,t.run("renderToolbar",e),Object(o.createElement)(dp,{ref:n(Rl)},Object(o.createElement)(sp,Object.assign({},l)),t.run("renderDiagramCustomize",l)))}var yp=Object(d.default)(Qa)(Ji||(Ji=Object(Ka.a)(["\n  position: absolute;\n  width: 20%;\n  padding: 0 5px;\n  background: white;\n  left: 30px;\n  top: 20px;\n  border-radius: 2px;\n"]))),bp=d.default.div(Xi||(Xi=Object(Ka.a)(["\n  max-width: 600px;\n"]))),gp=d.default.span(qi||(qi=Object(Ka.a)([""]))),hp=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).setEditorRootTopicKey=function(e){return function(){var t=r.props,n=t.model,o=t.controller;n.editorRootTopicKey!==e&&o.run("operation",Object(O.a)(Object(O.a)({},r.props),{},{opType:oi,topicKey:e}))}},r.breadcrumbRenderer=function(e){var t=e.text,n=Object(wa.a)(e,Ma),r=t.length>8,c=r?t.substr(0,8)+"...":t,i={content:Object(o.createElement)(bp,null,t),position:b.u.BOTTOM_RIGHT},a=Object(o.createElement)(b.b,Object.assign({},n),Object(o.createElement)(gp,null,c));return r?Object(o.createElement)(b.x,Object.assign({},i),a):a},r}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.model,n=e.controller,r=e.zIndex,c=t.editorRootTopicKey;if(c===t.rootTopicKey)return null;for(var i=[],a=t.getTopic(c);null!=a;){var l=n.getValue(Fl,Object(O.a)(Object(O.a)({},e),{},{topicKey:a.key}));i.unshift({text:l,onClick:this.setEditorRootTopicKey(a.key)}),a=t.getTopic(a.parentKey)}var u={items:i,breadcrumbRenderer:this.breadcrumbRenderer};return Object(o.createElement)(yp,{zIndex:r},Object(o.createElement)(b.c,Object.assign({},u)))}}]),n}(Aa),Op=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).handleClose=function(){var t=e.props.controller.run("handleActiveModalClose",e.props);t&&t()},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.controller,t=e.run("renderModal",this.props),n=e.run("getActiveModalProps",this.props);return Object(o.createElement)(b.g,{onClose:this.handleClose,isOpen:null!==t,autoFocus:!0,enforceFocus:!0,usePortal:!0,title:n&&n.title,style:n&&n.style},Object(o.createElement)("div",{className:g.a.DIALOG_BODY,style:{minHeight:0}},t))}}]),n}(Aa),mp=d.default.svg(Qi||(Qi=Object(Ka.a)(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"]))),vp=y()("node:root-sub-links"),jp=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).state={curves:[]},e}return Object(l.a)(n,[{key:"layout",value:function(){var e,t,n,r=this.props,c=r.model,i=r.getRef,a=r.topicKey,l=r.zoomFactor,u=r.controller,s=c.getTopic(a),p=i(vl(a)),d=i(Sl(a)),f=i(Kl).bigView,y=xs(p,f,l),b=xs(d,f,l);e={x:(n=y,(n.left+n.right)/2-b.left),y:js(y)-b.top};var g=[];s.subKeys.forEach((function(n){var c,a=u.run("getLinkStyle",Object(O.a)(Object(O.a)({},r),{},{topicKey:n})),s=a.lineType,p=xs(i(vl(n)),f,l);if(t={x:(t=p.left>y.right?{x:p.left,y:js(p)}:{x:p.right,y:js(p)}).x-b.left,y:t.y-b.top},"curve"===s)c="M ".concat(e.x," ").concat(e.y," C ").concat(e.x," ").concat(Es(e,t)," ").concat(Ts(e,t)," ").concat(t.y," ").concat(t.x," ").concat(t.y);else if("line"===s)c="M ".concat(e.x," ").concat(e.y," L ").concat(t.x," ").concat(t.y);else if("round"===s){var d=t.y>e.y?1:-1,h=t.x>e.x?1:-1,m=a.lineRadius;if(null==m)throw new Error("link line type is round, but lineRadius is not provided!");c=t.y===e.y?"M ".concat(e.x," ").concat(e.y," H ").concat(t.x):"M ".concat(e.x," ").concat(e.y,"  V ").concat(t.y-d*m," A ").concat(m," ").concat(m," 0 0 ").concat(d*h===1?0:1," ").concat(e.x+m*h," ").concat(t.y," H ").concat(t.x)}g.push(Object(o.createElement)("path",{key:"link-".concat(n),d:c,strokeWidth:a.lineWidth,stroke:a.lineColor,fill:"none"}))})),this.setState({curves:g})}},{key:"render",value:function(){vp("render");var e=this.props,t=e.topicKey,n=e.saveRef;return Object(o.createElement)(mp,{ref:n(Sl(t))},Object(o.createElement)("g",null,this.state.curves))}}]),n}(Aa),Tp=y()("RootNode"),Ep=d.default.div($i||($i=Object(Ka.a)(["\n  display: flex;\n  position: relative;\n\n  align-items: ",";\n  flex-direction: column;\n\n  padding: ",";\n"])),(function(e){return e.topicDirection===kc?"flex-end":"flex-start"}),(function(e){return e.topicDirection===kc?"15px 60px 15px 0px":"15px 0px 15px 60px"})),kp=d.default.div(ea||(ea=Object(Ka.a)(["\n  display: flex;\n  position: relative;\n  align-items: center;\n  z-index: 3;\n"]))),xp=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"renderPartTopics",value:function(e,t){var n=this.props,r=n.controller,c=n.saveRef,i=r.run("createSubTopics",Object(O.a)(Object(O.a)({},this.props),{},{dir:t,isRoot:!0,topics:e}));if(!i)return null;var a=i.subTopics,l="bm-layer-".concat(t===kc?"left":"right");return Object(o.createElement)(Ep,{topicDirection:t,ref:c(l)},a)}},{key:"render",value:function(){Tp("render");var e=this.props,t=e.model,n=e.topicKey,r=e.saveRef,c=e.controller,i=c.run("getTopicContentStyle",e),a=t.config,l=c.run("renderTopicContent",Object(O.a)(Object(O.a)({},e),{},{topicStyle:i,dir:Sc})),u=c.run("getPartTopics",{layout:a.layoutDir,model:t,topicKey:n}),s=Object(o.createElement)(kp,{ref:r(kl(n))},l),p=c.run("renderRootWidgetOtherChildren",e);switch(a.layoutDir){case Tc.LEFT_AND_RIGHT:return Object(o.createElement)(o.Fragment,null,this.renderPartTopics(u.L,"L"),s,this.renderPartTopics(u.R,"R"),p);case Tc.LEFT_TO_RIGHT:return Object(o.createElement)(o.Fragment,null,s,this.renderPartTopics(u.R,"R"),p);case Tc.RIGHT_TO_LEFT:return Object(o.createElement)(o.Fragment,null,this.renderPartTopics(u.L,"L"),s,p);case Tc.TOP_TO_BOTTOM:return Object(o.createElement)(o.Fragment,null,s,this.renderPartTopics(u.B,"B"),p)}return null}}]),n}(o.Component),Sp=d.default.div(ta||(ta=Object(Ka.a)(["\n  position: absolute;\n  top: calc(50% - 10px);\n  ",";\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  //@ts-ignore\n  background: ",";\n  cursor: pointer;\n  padding: 0;\n  font-size: 14px;\n  line-height: 20px;\n  border: 0;\n  z-index: 2;\n"])),(function(e){var t=e.dir;return t===xc?Object(d.css)(na||(na=Object(Ka.a)(["\n        right: -25px;\n      "]))):t===kc?Object(d.css)(oa||(oa=Object(Ka.a)(["\n        left: -25px;\n      "]))):void 0}),(function(e){return e.background}));function Cp(e){var t=e.model,n=e.topicKey,r=e.topicStyle,c=e.dir,i=e.saveRef,a=e.onClickCollapse,l=t.getTopic(n);return l.subKeys.size>0?Object(o.createElement)(Sp,{ref:i(Cl(n)),onClick:a,background:r.background,dir:c,className:nt()(Object(Sa.a)({icon:!0,iconfont:!0},"bm-".concat(l.collapse?"plus":"minus"),!0))}):null}var wp=y()("node:topic-content2"),Rp=d.default.div(ra||(ra=Object(Ka.a)(["\n  position: relative;\n"]))),Kp=d.default.div(ca||(ca=Object(Ka.a)(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: auto;\n  z-index: 10;\n  color: black;\n"]))),Dp=function(e){wp("cancelEvent"),e.preventDefault(),e.stopPropagation()};function Lp(e){var t,n=e.controller,r=e.model,c=e.topicKey,i=e.getRef,a=r.editingContentKey!==c,l=n.run("renderTopicContentEditor",Object(O.a)(Object(O.a)({},e),{},{readOnly:a}));if(a)t=l;else{var u,s={width:50,height:40},d=i("content-editor-".concat(c));d&&(s=d.getBoundingClientRect());var f=new p.a((function(e,t){var n=e[0].contentRect;u.style.left=(s.width-n.width)/2+"px",u.style.top=(s.height-n.height)/2+"px"}));wp(s),t=Object(o.createElement)(o.Fragment,null,Object(o.createElement)("div",{style:{width:s.width,height:s.height}}),Object(o.createElement)(Kp,{ref:function(e){e&&(u=e,f.observe(u))}},l))}return Object(o.createElement)(Rp,{onDragEnter:Dp,onDragOver:Dp},t)}var Ip=y()("node:topic-content-widget"),_p=d.default.div(ia||(ia=Object(Ka.a)(["\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  //overflow: hidden;\n  position: relative;\n"]))),Mp=d.default.div(aa||(aa=Object(Ka.a)(["\n  position: relative;\n"]))),Ap=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).onDragStart=function(e){o.run("handleTopicDragStart",Object(O.a)(Object(O.a)({},o.props),{},{ev:e}))},o.onDragOver=function(e){e.preventDefault()},o.onDragEnter=function(e){Ip("onDragEnter",o.props.topicKey),o.run("handleTopicDragEnter",Object(O.a)(Object(O.a)({},o.props),{},{ev:e,dropDir:"in"}))},o.onDragLeave=function(e){o.run("handleTopicDragLeave",Object(O.a)(Object(O.a)({},o.props),{},{ev:e,dropDir:"in"}))},o.onDrop=function(e){Ip("onDrop"),o.run("handleTopicDrop",Object(O.a)(Object(O.a)({},o.props),{},{ev:e,dropDir:"in"}))},o.onClick=function(e){var t=o.props.controller;o.handleTopicClickTimeout=setTimeout((function(){t.run("handleTopicClick",Object(O.a)(Object(O.a)({},o.props),{},{ev:e}))}),200)},o.onDoubleClick=function(e){clearTimeout(o.handleTopicClickTimeout),o.props.controller.run("handleTopicDoubleClick",Object(O.a)(Object(O.a)({},o.props),{},{ev:e}))},o.needRelocation=!1,o.onClickCollapse=function(e){e.stopPropagation();var t=o.props,n=t.topicKey,r=t.getRef;o.needRelocation=!0;var c=r(Cl(n)).getBoundingClientRect();Ip("oldRect",c),o.oldCollapseIconVector=[c.left+c.width/2,c.top+c.height/2],Ip("oldCollapseIconVector",o.oldCollapseIconVector),o.operation(Bc,o.props)},o.state={dragEnter:!1},o}return Object(l.a)(n,[{key:"renderContextMenu",value:function(){var e=this.props.controller;if(e.getValue(Al,Object(O.a)({},this.props)))return this.operation(Zc,Object(O.a)(Object(O.a)({},this.props),{},{focusMode:_c})),e.run("renderTopicContextMenu",this.props)}},{key:"onContextMenuClose",value:function(){}},{key:"componentDidUpdate",value:function(){if(this.needRelocation){var e=this.props,t=e.getRef,n=e.topicKey,o=e.setViewBoxScrollDelta,r=t(Cl(n)).getBoundingClientRect(),c=[r.left+r.width/2,r.top+r.height/2];Ip("newVector:",c),Ip("oldVector:",this.oldCollapseIconVector);var i=[c[0]-this.oldCollapseIconVector[0],c[1]-this.oldCollapseIconVector[1]];Ip("vector",i),o(i[0],i[1]),this.needRelocation=!1}}},{key:"render",value:function(){var e=this.props,t=e.saveRef,n=e.topicKey,r=e.model,c=e.controller,i=e.topicStyle,a=e.dir;Ip("render",n,r.focusMode);var l=c.run("isOperationEnabled",e)&&r.editingContentKey!==n,u=c.run("renderTopicCollapseIcon",Object(O.a)(Object(O.a)({},e),{},{onClickCollapse:this.onClickCollapse.bind(this)})),s=c.run("renderTopicDropArea",Object(O.a)(Object(O.a)({},e),{},{dropDir:"prev"})),p=c.run("renderTopicDropArea",Object(O.a)(Object(O.a)({},e),{},{dropDir:"next"})),d={onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDragOver:this.onDragOver,onDrop:this.onDrop};return Object(o.createElement)(Mp,null,s,Object(o.createElement)(_p,Object.assign({style:i,draggable:l,ref:t(vl(n)),onDragStart:this.onDragStart,onClick:this.onClick,onDoubleClick:this.onDoubleClick},d),c.run("renderTopicBlocks",e),c.run("renderTopicContentOthers",e)),p,a!==Sc&&u)}}]),n}(Aa);Ap=ap([b.f],Ap);var Fp=y()("node:topic-desc"),Pp=d.default.div(la||(la=Object(Ka.a)(["\n  overflow: auto;\n"])));function Np(e){var t=e.controller,n=e.model,r=e.topicKey,c=e.getRef,i=n.editingDescKey===r;Fp("isEditing",i);var a=n.getTopic(r).getBlock(Kc);if(!i&&t.run("isBlockEmpty",Object(O.a)(Object(O.a)({},e),{},{block:a.block})))return null;var l=t.run("renderTopicDescEditor",e),u=c(Rl),s={maxWidth:"800px",maxHeight:"600px"};if(u){var p=u.getBoundingClientRect();s.maxWidth="".concat(.6*p.width,"px"),s.maxHeight="".concat(.8*p.height,"px")}var d={autoFocus:!1,content:Object(o.createElement)(Pp,{onClick:hs,classname:g.a.POPOVER_DISMISS,style:s},l),target:Object(o.createElement)(qa,{onClick:function(n){n.stopPropagation(),t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:ti}))},className:Ol(pl),tabIndex:-1}),interactionKind:b.t.HOVER,hoverOpenDelay:500};return a.block&&Object(o.createElement)(b.s,Object.assign({},d))}var Bp=d.default.svg(ua||(ua=Object(Ka.a)(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"]))),zp=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).state={content:null},e}return Object(l.a)(n,[{key:"layout",value:function(){var e=this.props,t=e.getRef,n=e.model,r=e.zoomFactor,c=n.focusKey,i=n.focusMode;if(c&&i!==Lc){var a=t(vl(c)),l=t(Kl).bigView,u=t(Dl),s=xs(a,l,r),p=xs(u,l,r),d=s.left-p.left-3,f=s.top-p.top-3,y=s.width+6,b=s.height+6;this.setState({content:Object(o.createElement)("rect",{x:d,y:f,width:y,height:b,fill:"none",stroke:n.config.theme.highlightColor,strokeWidth:2})})}else this.setState({content:null})}},{key:"render",value:function(){var e=this.props.saveRef;return Object(o.createElement)(Bp,{ref:e(Dl)},this.state.content)}}]),n}(Aa),Vp=d.default.svg(sa||(sa=Object(Ka.a)(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"]))),Hp=y()("node:topic-sub-links"),Gp=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).state={curves:[]},e}return Object(l.a)(n,[{key:"layout",value:function(){var e,t,n,r=this.props,c=r.model,i=r.getRef,a=r.topicKey,l=r.dir,u=r.controller,s=u.run("getZoomFactor",r),p=c.getTopic(a),d=i(vl(a)),f=i(Sl(a)),y=i(Cl(a)),b=i(Kl).bigView,g=xs(f,b,s),h=xs(y,b,s),m=xs(d,b,s);Hp(a),Hp("svgRect",g),Hp("collapseRect",h),Hp("contentRect",m),l===xc?(e={x:0,y:js(m)-g.top},t={x:h.right-g.left+10,y:e.y}):l===kc&&(e={x:g.right-g.left,y:js(m)-g.top},t={x:h.left-g.left-10,y:e.y});var v=[];p.subKeys.forEach((function(c){var a,d=u.run("getLinkStyle",Object(O.a)(Object(O.a)({},r),{},{topicKey:c})),f=i(vl(c));if(f){var y=xs(f,b,s);l===xc&&(n={x:y.left-g.left,y:js(y)-g.top}),l===kc&&(n={x:y.right-g.left,y:js(y)-g.top});var h=d.lineType;if("curve"===h)a="M ".concat(e.x," ").concat(e.y," L ").concat(t.x," ").concat(t.y," C ").concat(t.x," ").concat(Es(t,n)," ").concat(Ts(t,n)," ").concat(n.y," ").concat(n.x," ").concat(n.y);else if("round"===h){var m=n.y>e.y?1:-1,j=n.x>e.x?1:-1,T=d.lineRadius;a=1===p.subKeys.size||Math.abs(n.y-e.y)<=1?"M ".concat(e.x," ").concat(e.y," L ").concat(n.x," ").concat(n.y):"M ".concat(e.x," ").concat(e.y," H ").concat(t.x," V ").concat(n.y-m*T," A ").concat(T," ").concat(T," 0 0 ").concat(m*j===1?0:1," ").concat(t.x+T*j," ").concat(n.y," H ").concat(n.x)}else"line"===h&&(a="M ".concat(e.x," ").concat(e.y," H ").concat(t.x," L ").concat(n.x," ").concat(n.y));v.push(Object(o.createElement)("path",{key:"link-".concat(c),d:a,strokeWidth:d.lineWidth,stroke:d.lineColor,fill:"none"}))}})),this.setState({curves:v})}},{key:"render",value:function(){var e=this.props,t=e.topicKey,n=e.saveRef;return Object(o.createElement)(Vp,{ref:n(Sl(t))},Object(o.createElement)("g",null,this.state.curves))}}]),n}(Aa),Up=y()("node:topic-widget"),Wp=d.default.div(pa||(pa=Object(Ka.a)(["\n  display: flex;\n  align-items: center;\n  flex-direction: ",";\n"])),(function(e){return e.topicDirection===xc?"row":"row-reverse"})),Zp=d.default.div(da||(da=Object(Ka.a)(["\n  position: relative;\n  padding: ",";\n"])),(function(e){return e.dir===xc?"0 0 0 ".concat(e.marginH,"px"):"0 ".concat(e.marginH,"px 0 0")})),Yp=d.default.div(fa||(fa=Object(Ka.a)(["\n  display: flex;\n  position: relative;\n  align-items: center;\n\n  flex-direction: ",";\n"])),(function(e){return e.topicDirection===xc?"row":"row-reverse"})),Jp=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"renderSubTopics",value:function(){var e=this.props,t=e.controller,n=e.model,r=e.topicKey,c=e.dir,i=n.getTopic(r).subKeys.toArray(),a=t.run("createSubTopics",Object(O.a)(Object(O.a)({},e),{},{topics:i}));if(!a)return null;var l=a.subTopics,u=t.run("renderSubLinks",e);return Object(o.createElement)(Zp,{dir:c,marginH:n.config.theme.marginH},l," ",u)}},{key:"layoutLinks",value:function(){var e=this.props,t=e.getRef,n=e.topicKey,o=e.model.getTopic(n);if(0!==o.subKeys.size&&!o.collapse){Up("layoutLinks",n);var r=t(xl(n));r&&r.layout()}}},{key:"render",value:function(){var e=this.props,t=e.controller,n=e.topicKey,r=e.dir,c=e.saveRef;Up("render",n);var i=t.run("getTopicContentStyle",e),a=Object(O.a)(Object(O.a)({},e),{},{topicStyle:i}),l=t.run("renderTopicContent",a);return Object(o.createElement)(Wp,{topicDirection:r},Object(o.createElement)(Yp,{topicDirection:r,ref:c(kl(n))},l),this.renderSubTopics())}}]),n}(o.Component),Xp=y()("node:view-port-viewer"),qp=Object(d.default)(Qa)(ya||(ya=Object(Ka.a)(["\n  position: absolute;\n  background: white;\n  right: 30px;\n  bottom: 20px;\n  border-radius: 2px;\n  display: flex;\n  flex-direction: row;\n  user-select: none;\n"]))),Qp=Object(d.default)(Za)(ba||(ba=Object(Ka.a)(["\n  margin: 10px;\n"]))),$p=d.default.span(ga||(ga=Object(Ka.a)(["\n  display: inline-block;\n  width: 80px;\n  height: 18px;\n"]))),ed=function(e){return Object(o.createElement)(b.x,{content:e.tooltip,position:h.a.TOP,className:g.a.ICON},Object(o.createElement)(Qp,{onClick:e.onClick,tabIndex:-1},e.children))},td=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).zoomFactorChange=function(e){Xp("zoomFactorChange",e),o.setState({zoomFactor:e})},o.onClickResetZoom=function(e){var t=o.props;t.controller.run("setZoomFactor",Object(O.a)(Object(O.a)({},t),{},{zoomFactor:1}))},o.onClickAddZoom=function(e){var t=o.props,n=t.controller,r=n.run("getZoomFactor",t);n.run("setZoomFactor",Object(O.a)(Object(O.a)({},t),{},{zoomFactor:r+.1}))},o.onClickMinusZoom=function(e){var t=o.props,n=t.controller,r=n.run("getZoomFactor",t);n.run("setZoomFactor",Object(O.a)(Object(O.a)({},t),{},{zoomFactor:r-.1}))},o.onClickCollapseAll=function(e){var t=o.props,n=t.controller;n.run("addEventListener",Object(O.a)(Object(O.a)({},t),{},{key:_l,listener:o.centerRootTopic,once:!0})),n.run("operation",Object(O.a)(Object(O.a)({},t),{},{opType:zc}))},o.onClickExpandAll=function(e){var t=o.props,n=t.controller;n.run("addEventListener",Object(O.a)(Object(O.a)({},t),{},{key:_l,listener:o.centerRootTopic,once:!0})),n.run("operation",Object(O.a)(Object(O.a)({},t),{},{opType:Vc}))},o.centerRootTopic=function(){var e=o.props,t=e.model;e.controller.run("moveTopicToCenter",Object(O.a)(Object(O.a)({},o.props),{},{topicKey:t.editorRootTopicKey}))},o}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this.props;e.controller.run("addZoomFactorChangeEventListener",Object(O.a)(Object(O.a)({},e),{},{listener:this.zoomFactorChange}))}},{key:"componentWillUnmount",value:function(){var e=this.props;e.controller.run("removeZoomFactorChangeEventListener",Object(O.a)(Object(O.a)({},e),{},{listener:this.zoomFactorChange}))}},{key:"render",value:function(){Xp("render");var e=this.props,t=e.controller,n=e.zIndex,r=t.run("getZoomFactor",e);return Object(o.createElement)(qp,{zIndex:n},Object(o.createElement)(ed,{onClick:this.onClickCollapseAll,tooltip:vs(e,Xu)},ml(yl)),Object(o.createElement)(ed,{onClick:this.onClickExpandAll,tooltip:vs(e,qu)},ml(bl)),Object(o.createElement)(ed,{onClick:this.centerRootTopic,tooltip:vs(e,Qu)},ml(gl)),Object(o.createElement)(ed,{onClick:this.onClickMinusZoom,tooltip:vs(e,es)},ml(fl)),Object(o.createElement)(ed,{onClick:this.onClickResetZoom,tooltip:vs(e,ns)},Object(o.createElement)($p,null,"".concat(vs(e,$u),":").concat(Math.floor(100*r),"%"))),Object(o.createElement)(ed,{onClick:this.onClickAddZoom,tooltip:vs(e,ts)},ml(dl)))}}]),n}(Aa),nd=d.default.div(ha||(ha=Object(Ka.a)(["\n  overflow: auto;\n  padding: 0px 0px 0px 20px;\n  background: #88888850;\n"])));function od(e){var t=e.controller,n=e.model,r=e.topicKey;if(n.focusMode===Ic){var c=t.run("renderTopicDescEditor",e);return Object(o.createElement)(b.i,{key:"drawer",title:vs(e,ql),icon:ml("note"),isOpen:!0,hasBackdrop:!0,backdropProps:{onMouseDown:hs},isCloseButtonShown:!1,onClose:function(n){n.stopPropagation();var o="topic-desc-data-".concat(r),c=t.run("deleteTempValue",{key:o});t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Qc,topicKey:r,blockType:Kc,data:c,focusMode:Dc}))},size:"70%"},Object(o.createElement)(nd,null,c))}}function rd(e){var t=e.theme,n=e.children;return Object(o.createElement)(d.ThemeProvider,{theme:t},Object(o.createElement)(o.Fragment,null,n))}var cd=y()("plugin:rendering");function id(){var e;return{getDiagramProps:function(){return e},renderDiagram:function(t){var n=t.model;return Object(o.createElement)(Va,null,(function(r,c,i){return e=Object(O.a)(Object(O.a)({},t),{},{saveRef:r,getRef:c,deleteRef:i}),cd("renderDiagram",n),Object(o.createElement)(rd,{theme:n.config.theme},Object(o.createElement)(fp,e))}))},renderDrawer:od,getInitialDiagramState:function(e){return{rightTopPanel:{isOpen:!1,selectedTabId:"topic-style"}}},renderDiagramCustomize:function(e){var t=e.controller,n=e.model,o=t.getValue(Ml),r=Object(O.a)(Object(O.a)({},e),{},{zIndex:o,topicKey:n.focusKey});return[t.run("renderEditorRootBreadcrumbs",r),t.run("renderRightTopPanel",r),t.run("renderModals",Object(O.a)(Object(O.a)({},r),{},{zIndex:o+1})),t.run("renderDrawer",Object(O.a)(Object(O.a)({},r),{},{zIndex:o+1})),t.run("renderViewPortViewer",r)]},renderEditorRootBreadcrumbs:function(e){return Object(o.createElement)(hp,Object.assign({key:"EditorRootBreadcrumbs"},e))},renderModals:function(e){return Object(o.createElement)(Op,Object.assign({key:"modals"},e))},renderModal:function(e){return null},getActiveModalProps:function(e){return null},renderDoc:function(e){return e.children},renderRootWidget:function(e){return Object(o.createElement)(xp,Object.assign({},e))},renderTopicWidget:function(e){return Object(o.createElement)(Jp,Object.assign({},e))},renderTopicContent:function(e){return Object(o.createElement)(Ap,Object.assign({},e))},renderTopicCollapseIcon:function(e){return Object(o.createElement)(Cp,Object.assign({},e))},renderTopicContentOthers:function(e){return[]},renderTopicBlocks:function(e){var t=e.model,n=e.topicKey,r=e.controller,c=t.getTopic(n).blocks,i=[],a=0;return c.forEach((function(t){var n=r.run("renderTopicBlock",Object(O.a)(Object(O.a)({},e),{},{block:t,blockKey:"block-".concat(a)}));n&&(i.push(Object(o.createElement)(o.Fragment,{key:"block-".concat(a)},n)),a++)})),i},renderTopicBlock:function(e){var t=e.controller;switch(e.block.type){case Rc:return t.run("renderTopicBlockContent",e);case Kc:return t.run("renderTopicBlockDesc",e)}return null},renderTopicBlockContent:function(e){return Object(o.createElement)(Lp,Object.assign({},e))},renderTopicBlockDesc:function(e){return Object(o.createElement)(Np,Object.assign({},e))},renderSubLinks:function(e){var t=e.saveRef,n=e.topicKey,r=e.model.getTopic(n);return 0===r.subKeys.size||r.collapse?null:Object(o.createElement)(Gp,Object.assign({ref:t(xl(n))},e))},renderRootSubLinks:function(e){var t=e.saveRef,n=e.topicKey;return Object(o.createElement)(jp,Object.assign({ref:t(xl(n))},e))},renderFocusItemHighlight:function(e){var t=e.saveRef;return Object(o.createElement)(zp,Object.assign({ref:t(Ll)},e))},renderRootWidgetOtherChildren:function(e){var t=e.controller,n=t.run("getZoomFactor",e);return e=Object(O.a)(Object(O.a)({},e),{},{zoomFactor:n}),Object(o.createElement)(o.Fragment,null,t.run("renderRootSubLinks",e),t.run("renderFocusItemHighlight",e),t.run("renderDragAndDropEffect",e))},renderViewPortViewer:function(e){return Object(o.createElement)(td,Object.assign({key:"view-port-viewer"},e))}}}var ad=Object(d.default)(Qa)(Oa||(Oa=Object(Ka.a)(["\n  position: absolute;\n  background: white;\n  right: 30px;\n  top: 20px;\n  border-radius: 2px;\n  user-select: none;\n"]))),ld=Object(d.default)(b.w)(ma||(ma=Object(Ka.a)(["\n  padding: 0px 10px;\n"])));function ud(e){var t=e.controller,n=e.zIndex,r=e.diagramState,c=e.setDiagramState,i=r.rightTopPanel,a=i.isOpen,l=i.selectedTabId,u=function(e){c(Object(O.a)(Object(O.a)({},r),{},{rightTopPanel:Object(O.a)(Object(O.a)({},i),e)}))};if(!a)return Object(o.createElement)(ad,{zIndex:n},Object(o.createElement)(Wa,{onClick:function(){u({isOpen:!0})}},Object(o.createElement)(Ua,{className:Ol(ll)})));return Object(o.createElement)(ad,{zIndex:n},Object(o.createElement)(Xa,null,Object(o.createElement)(Ja,{className:Ol(ul),onClick:function(){u({isOpen:!1})}})),Object(o.createElement)(ld,{id:"tabs",selectedTabId:l,onChange:function(e){u({selectedTabId:e})}},t.run("renderRightTopPanelTabs",e)))}var sd=Object(v.a)(Array(7).keys()),pd=[0,5,10,15,20,25,30,35],dd=["none","solid","dotted","dashed","double"];function fd(e){var t=e.contentStyle,n=e.setContentStyle;return Object(o.createElement)(Cs,null,Object(o.createElement)(tl,null,vs(e,Lu)),Object(o.createElement)(cl,null,Object(o.createElement)(Ls,{text:"".concat(vs(e,Iu),": ").concat(t.borderWidth?t.borderWidth:vs(e,Hl)),items:sd,itemRenderer:Is("px"),onItemSelect:function(e){n({borderWidth:"".concat(e,"px")})}}),Object(o.createElement)(Ls,{text:"".concat(vs(e,ou),": ").concat(t.borderStyle?vs(e,t.borderStyle):vs(e,Vu)),items:dd,itemRenderer:_s(e),onItemSelect:function(e){n({borderStyle:e})}}),Object(o.createElement)(Ls,{text:"".concat(vs(e,_u),": ").concat(t.borderRadius),items:pd,itemRenderer:Is("px"),onItemSelect:function(e){n({borderRadius:"".concat(e,"px")})}}),Object(o.createElement)(ws,{color:t.borderColor,handleColorChange:function(e){n({borderColor:e})}})))}var yd=["curve","round","line"];function bd(e){var t=e.showLinkStyle,n=void 0===t||t,r=e.showSubLinkStyle,c=void 0===r||r,i=e.linkStyle,a=void 0===i?{}:i,l=e.subLinkStyle,u=void 0===l?{}:l,s=e.setLinkStyle,p=e.setSubLinkStyle;return Object(o.createElement)(Cs,null,Object(o.createElement)(tl,null,vs(e,cu)),n&&Object(o.createElement)(cl,{alignItems:"center"},Object(o.createElement)(Ga,{margin:"0 5px 0 0"},vs(e,iu)+":"," "),Object(o.createElement)(Ls,{text:"".concat(vs(e,Iu),": ").concat(a?a.lineWidth:"0px"),items:Ms,itemRenderer:Is("px"),onItemSelect:function(e){s({lineWidth:"".concat(e,"px")})}}),Object(o.createElement)(Ls,{text:"".concat(vs(e,du),": ").concat(vs(e,a.lineType)),items:yd,itemRenderer:_s(e),onItemSelect:function(e){s({lineType:e})}}),Object(o.createElement)(ws,{color:a.lineColor,handleColorChange:function(e){s({lineColor:e})}})),c&&Object(o.createElement)(cl,{alignItems:"center"},Object(o.createElement)(Ga,{margin:"0 5px 0 0"},vs(e,au)+": "),Object(o.createElement)(Ls,{text:"".concat(vs(e,Iu),": ").concat(u?u.lineWidth:"0px"),items:Ms,itemRenderer:Is("px"),onItemSelect:function(e){p({lineWidth:"".concat(e,"px")})}}),Object(o.createElement)(Ls,{text:"".concat(vs(e,du),": ").concat(vs(e,u.lineType)),items:yd,itemRenderer:_s(e),onItemSelect:function(e){p({lineType:e})}}),Object(o.createElement)(ws,{color:u.lineColor,handleColorChange:function(e){p({lineColor:e})}})))}function gd(e){var t=e.contentStyle,n=e.setContentStyle,r={title:"".concat(vs(e,Mu),":"),min:12,max:100,value:parseInt(t.fontSize),style:{width:50},onValueChange:function(e){n({fontSize:e})}},c={title:"".concat(vs(e,Au),":"),style:{width:50},value:t.lineHeight||"",onChange:function(e){n({lineHeight:e.target.value})}};return Object(o.createElement)(Cs,null,Object(o.createElement)(tl,null,vs(e,ru)),Object(o.createElement)(Ha,null,Object(o.createElement)(Ks,Object.assign({},r)),Object(o.createElement)(Ds,Object.assign({},c)),Object(o.createElement)(ws,{color:t.color,handleColorChange:function(e){n({color:e})}})))}var hd,Od=y()("node:style-editor");function md(e){var t=e.controller,n=e.model,r=e.topicKey,c=n.getTopic(r),i=function(n){t.run("setTopicContentStyle",Object(O.a)(Object(O.a)({},e),{},{style:n}))};if(!n.focusKey)return null;var a=t.run("getTopicContentStyle",e),l=t.run("getLinkStyle",e),u=t.run("getSubLinkStyle",e),s=Object(O.a)(Object(O.a)({},e),{},{linkStyle:l,subLinkStyle:u,setLinkStyle:function(n){t.run("setLinkStyle",Object(O.a)(Object(O.a)({},e),{},{linkStyle:n}))},setSubLinkStyle:function(n){t.run("setSubLinkStyle",Object(O.a)(Object(O.a)({},e),{},{subLinkStyle:n}))}}),p=Object(O.a)(Object(O.a)({},e),{},{contentStyle:a,setContentStyle:i});return Object(o.createElement)($a,null,Object(o.createElement)(fd,Object.assign({},p)),Object(o.createElement)(gd,Object.assign({},p)),Object(o.createElement)(Cs,null,Object(o.createElement)(tl,null,vs(e,Ku)),Object(o.createElement)(ws,{color:a.background,handleColorChange:function(e){i({background:e})}})),Object(o.createElement)(bd,Object.assign({},s)),Object(o.createElement)(Cs,null,Object(o.createElement)(Rs,{title:vs(e,su),onClick:function(){c.style&&t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Jc,style:null}))}}),Object(o.createElement)(Rs,{title:vs(e,lu),onClick:function(){hd=t.run("getTopicStyle",e),Od(hd)}}),Object(o.createElement)(Rs,{title:vs(e,uu),onClick:function(){hd&&t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Jc,style:JSON.stringify(hd)}))}})),function(e){var t=e.controller;return Object(o.createElement)(Cs,null,Object(o.createElement)(nl,null,Object(o.createElement)(b.d,{onClick:function(n){t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Xc}))}},vs(e,pu))))}(e))}var vd=n(110);function jd(e){var t=e.contentStyle,n=e.setContentStyle,r=vd("padding",t.padding||"0"),c={layout:"v",min:0,max:99,style:{width:38}},i=parseInt(r["padding-top"]),a=parseInt(r["padding-right"]),l=parseInt(r["padding-bottom"]),u=parseInt(r["padding-left"]),s={top:i,right:a,bottom:l,left:u},p=function(e){return function(t){n({padding:ms(Object(O.a)(Object(O.a)({},s),{},Object(Sa.a)({},e,t)))})}},d=Object(O.a)(Object(O.a)({},c),{},{title:vs(e,Pu),value:i,onValueChange:p("top")}),f=Object(O.a)(Object(O.a)({},c),{},{title:vs(e,zu),value:a,onValueChange:p("right")}),y=Object(O.a)(Object(O.a)({},c),{},{title:vs(e,Nu),value:l,onValueChange:p("bottom")}),b=Object(O.a)(Object(O.a)({},c),{},{title:vs(e,Bu),value:u,onValueChange:p("left")});return Object(o.createElement)(Cs,null,Object(o.createElement)(tl,null,vs(e,Fu)),Object(o.createElement)(cl,null,Object(o.createElement)(Ks,Object.assign({},d)),Object(o.createElement)(Ks,Object.assign({},f)),Object(o.createElement)(Ks,Object.assign({},y)),Object(o.createElement)(Ks,Object.assign({},b))))}var Td=d.default.div(va||(va=Object(Ka.a)(["\n  height: 250px;\n  overflow: auto;\n"])));function Ed(e){var t=e.topicStyle,n=e.setTopicStyle,r=t.contentStyle,c=void 0===r?{}:r,i=t.linkStyle,a=void 0===i?{}:i,l=t.subLinkStyle,u=void 0===l?{}:l,s=function(e){n({contentStyle:e})},p=Object(O.a)(Object(O.a)({},e),{},{contentStyle:c,setContentStyle:s}),d=Object(O.a)(Object(O.a)({},e),{},{showLinkStyle:!1,linkStyle:a,subLinkStyle:u,setLinkStyle:function(e){n({linkStyle:e})},setSubLinkStyle:function(e){n({subLinkStyle:e})}});return Object(o.createElement)(Td,null,Object(o.createElement)(fd,Object.assign({},p)),Object(o.createElement)(jd,Object.assign({},p)),Object(o.createElement)(gd,Object.assign({},p)),Object(o.createElement)(Cs,null,Object(o.createElement)(tl,null,vs(e,Ku)),Object(o.createElement)(ws,{color:c.background,handleColorChange:function(e){s({background:e})}})),Object(o.createElement)(bd,Object.assign({},d)))}y()("node:theme-editor");var kd="normal";function xd(e){var t,n=Object(o.useState)(!1),r=Object(Ca.a)(n,2),c=r[0],i=r[1],a=e.model,l=e.controller,u=Object(ct.cloneDeep)(a.config.theme),s=l.run("getThemeOfTopic",Object(O.a)(Object(O.a)({},e),{},{isClone:!0})),p=s.rootTopic,d=s.primaryTopic,f=s.normalTopic,y=function(t){l.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:qc,theme:t}))},g=(t=function(e){y(Object(ct.merge)(u,{randomColor:e}))},function(e){return t(e.target.checked)}),h=Object(O.a)(Object(O.a)({},e),{},{topicStyle:p,setTopicStyle:function(e){y(Object(ct.merge)(u,{rootTopic:e}))}}),m=Object(o.createElement)(Ed,Object.assign({},h)),v=Object(O.a)(Object(O.a)({},e),{},{topicStyle:d,setTopicStyle:function(e){y(Object(ct.merge)(u,{primaryTopic:e}))}}),j=Object(o.createElement)(Ed,Object.assign({},v)),T=Object(O.a)(Object(O.a)({},e),{},{topicStyle:f,setTopicStyle:function(e){y(Object(ct.merge)(u,{normalTopic:e}))}}),E=Object(o.createElement)(Ed,Object.assign({},T)),k={id:kd,handleTabIdChange:function(e){kd=e}},x=Object(o.createElement)(ol,null,Object(o.createElement)(b.w,Object.assign({},k),Object(o.createElement)(b.v,{id:"normal",title:vs(e,hu),panel:E}),Object(o.createElement)(b.v,{id:"primary",title:vs(e,Ou),panel:j}),Object(o.createElement)(b.v,{id:"root",title:vs(e,mu),panel:m}))),S={isOpen:c,onClose:function(e){i(!1)}},C=Object(o.createElement)(b.a,Object.assign({},S),Object(o.createElement)("p",null,"File format error"));return Object(o.createElement)($a,null,Object(o.createElement)(Cs,null,Object(o.createElement)(tl,null,vs(e,yu)),Object(o.createElement)(cl,null,Object(o.createElement)(rl,null,vs(e,Ku)+":"),Object(o.createElement)(ws,{color:u.background,handleColorChange:function(e){y(Object(ct.merge)(u,{background:e}))}}),Object(o.createElement)(rl,null,vs(e,bu)+":"),Object(o.createElement)(ws,{color:u.highlightColor,handleColorChange:function(e){y(Object(ct.merge)(u,{highlightColor:e}))}}),Object(o.createElement)(rl,null,vs(e,gu)+":"),Object(o.createElement)(Ya,{checked:u.randomColor,onChange:g}))),x,Object(o.createElement)(Cs,null,Object(o.createElement)(Rs,{title:vs(e,vu),onClick:function(e){Os(JSON.stringify(u),"blink-mind-theme.json")}}),Object(o.createElement)(Rs,{title:vs(e,ju),onClick:function(e){(function(e){var t=document.createElement("input");return t.type="file",t.accept=e,new Promise((function(e,n){t.addEventListener("change",(function(t){var o=t.target.files[0],r=new FileReader;r.onload=function(t){var n=t.target.result;e(n)},r.onerror=function(e){n(e.target.error)},r.readAsText(o)})),t.click()}))})(".json,.txt").then((function(e){var t,n=JSON.parse(e);null!=(t=n).name&&null!=t.background&&null!=t.highlightColor?y(n):i(!0)}))}})),C)}function Sd(){return{renderRightTopPanel:function(e){var t=Object(O.a)(Object(O.a)({},e),{},{key:"right-top-panel"});return Object(o.createElement)(ud,Object.assign({},t))},renderRightTopPanelTabs:function(e){var t=e.controller;return[t.run("renderTopicStyleEditor",e),t.run("renderThemeEditor",e)]},renderTopicStyleEditor:function(e){var t={id:"topic-style",key:"topic-style",title:vs(e,nu),panel:Object(o.createElement)(md,Object.assign({},e))};return Object(o.createElement)(b.v,Object.assign({},t))},renderThemeEditor:function(e){var t={id:"theme-editor",key:"theme-editor",title:vs(e,fu),panel:Object(o.createElement)(xd,Object.assign({},e))};return Object(o.createElement)(b.v,Object.assign({},t))}}}var Cd=d.default.div(ja||(ja=Object(Ka.a)(["\n  box-shadow: rgb(170, 170, 170) 0 0 2px;\n  background: white;\n  .iconfont {\n    font-size: 28px !important;\n  }\n"])));function wd(e){var t=e.controller;return Object(o.createElement)(Cd,null,t.run("renderToolbarItems",e))}function Rd(e){var t=[[Tc.LEFT_AND_RIGHT,vs(e,Ul),"layout-left-and-right"],[Tc.LEFT_TO_RIGHT,vs(e,Zl),"layout-right"],[Tc.RIGHT_TO_LEFT,vs(e,Wl),"layout-left"]];return Object(o.createElement)(Fs,Object.assign({className:Ol(hl)},e),Object(o.createElement)(b.s,{enforceFocus:!1},Object(o.createElement)(el,null),Object(o.createElement)(b.n,null,t.map((function(t){return Object(o.createElement)(b.p,{key:t[1],icon:ml(t[2]),text:t[1],onClick:(n=t[0],function(t){e.controller.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:ri,layoutDir:n}))})});var n})))))}function Kd(){return{renderToolbar:function(e){return Object(o.createElement)(wd,Object.assign({},e))},renderToolbarItems:function(e){var t=e.controller.run("customizeToolbar",e);return t.sort((function(e,t){return e.order-t.order})),t.map((function(t){return Object(o.createElement)(t.element,Object(O.a)(Object(O.a)({},e),{},{key:t.order.toString()}))}))},customizeToolbar:function(e){return[{order:100,element:Rd}]}}}var Dd=y()("plugin:utils");function Ld(){var e=new Map,t=new Map;return{addTempValueChangeListener:function(e){var n=e.key,o=e.listener;t.has(n)||t.set(n,[]),t.get(n).push(o)},removeTempValueChangeListener:function(e){var n=e.key,o=e.listener;t.has(n)&&(t[n]=t.get(n).filter((function(e){return e!==o})))},getTempValue:function(t){var n=t.key;return Dd("getTempValue",n),e.get(n)},setTempValue:function(n){var o=n.key,r=n.value;if(Dd("setTempValue",o),e.set(o,r),t.has(o)){var c,i=t.get(o),a=Object(m.a)(i);try{for(a.s();!(c=a.n()).done;){(0,c.value)(r)}}catch(l){a.e(l)}finally{a.f()}}},deleteTempValue:function(t){var n=t.key;Dd("deleteTempValue",n);var o=e.get(n);return e.delete(n),o}}}function Id(){return[id(),Ld(),ep(),Sd(),Kd(),ip()]}var _d=y()("node:text-editor"),Md=d.default.div(Ta||(Ta=Object(Ka.a)(["\n  padding: 6px;\n  background-color: ",";\n  cursor: ",";\n  min-width: 50px;\n"])),(function(e){return e.readOnly?null:"white"}),(function(e){return e.readOnly?"pointer":"text"})),Ad=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).state={content:null},o.onMouseDown=function(e){e.stopPropagation()},o.onMouseMove=function(e){},o.onKeyDown=function(e){},o._handleClick=function(e){!o.root.contains(e.target)&&o.onClickOutSide(e)},o.rootRef=function(e){return function(t){e(t),o.root=t}},o.initState(),o}return Object(l.a)(n,[{key:"onChange",value:function(e){var t=e.value;_d("onChange",t),this.setState({content:t})}},{key:"componentDidMount",value:function(){this.props.readOnly||document.addEventListener("click",this._handleClick)}},{key:"componentWillUnmount",value:function(){this.props.readOnly||document.removeEventListener("click",this._handleClick)}},{key:"onClickOutSide",value:function(e){}},{key:"getCustomizeProps",value:function(){return null}},{key:"getContent",value:function(){var e=this.getCustomizeProps().block.data;return null==e?null:("string"===typeof e&&(e=Fe.a.deserialize(e)),e)}},{key:"initState",value:function(){var e=this.getContent();this.state={content:e}}},{key:"render",value:function(){var e=this.props,t=e.topicKey,n=e.saveRef,r=this.getCustomizeProps(),c=r.readOnly,i=r.getRefKeyFunc,a=r.placeholder,l=r.style;_d(c);var u=i(t),s=c?this.getContent():this.state.content,p=this.onMouseDown,d=this.onMouseMove,f=this.onKeyDown,y={value:s,readOnly:c,onChange:this.onChange.bind(this),placeholder:a,style:l},b={key:u,readOnly:c,ref:this.rootRef(n(u)),onMouseDown:p,onMouseMove:d,onKeyDown:f};return Object(o.createElement)(Md,Object.assign({},b),Object(o.createElement)(Pe.Editor,Object.assign({},y,{autoFocus:!0})))}}]),n}(o.PureComponent),Fd=y()("node:topic-content-editor");function Pd(e){return"content-editor-".concat(e)}var Nd=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).onKeyDown=function(e){e.nativeEvent.ctrlKey&&"Enter"===e.nativeEvent.code&&o.save()},o}return Object(l.a)(n,[{key:"getCustomizeProps",value:function(){var e=this.props,t=e.model,n=e.topicKey,o=e.readOnly;return{block:t.getTopic(n).getBlock(Rc).block,readOnly:o,getRefKeyFunc:Pd,placeholder:"new",style:{whiteSpace:"pre"}}}},{key:"onClickOutSide",value:function(e){Fd("onClickOutSide"),this.save()}},{key:"save",value:function(){var e=this.props,t=e.model,n=e.topicKey;t.editingContentKey!==n||this.props.controller.run("operation",Object(O.a)(Object(O.a)({},this.props),{},{opType:Qc,blockType:Rc,data:this.state.content,focusMode:Dc}))}}]),n}(Ad),Bd=y()("node:topic-desc-editor");function zd(e){return"desc-editor-".concat(e)}var Vd=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),o=t.call(this,e),Bd("constructor"),o}return Object(l.a)(n,[{key:"initState",value:function(){Object(ka.a)(Object(xa.a)(n.prototype),"initState",this).call(this);var e=this.props,t=e.controller,o=e.topicKey,r="topic-desc-data-".concat(o),c=this.state.content;t.run("setTempValue",{key:r,value:c})}},{key:"getCustomizeProps",value:function(){var e=this.props,t=e.model,n=e.topicKey;return{block:t.getTopic(n).getBlock(Kc).block,readOnly:t.editingDescKey!==n,getRefKeyFunc:zd,placeholder:"write topic notes here"}}},{key:"onChange",value:function(e){var t=e.value;Bd("onChange");var n=this.props,o=n.controller,r=n.topicKey;if(!(n.model.editingDescKey!==r)){var c="topic-desc-data-".concat(r);o.run("setTempValue",{key:c,value:t}),this.setState({content:t})}}}]),n}(Ad);var Hd=y()("plugin:StylePlugin");function Gd(){var e=new Map,t=0;return{getTopicStyle:function(e){var t=e.controller;return{contentStyle:t.run("getTopicContentStyle",e),linkStyle:t.run("getLinkStyle",e),subLinkStyle:t.run("getSubLinkStyle",e)}},getTopicContentStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;Hd("getTopicContentStyle:",t,n);var r,c=n.getTopicVisualLevel(t),i=n.config.theme;if(r=c===Cc?i.rootTopic:c===wc?i.primaryTopic:i.normalTopic,r=Object(O.a)(Object(O.a)({},i.contentStyle),r.contentStyle),i.randomColor){var a=o.run("getRandomColor",e);r=Object(O.a)(Object(O.a)({},r),{},{background:a,borderColor:a,subLinkStyle:Object(O.a)(Object(O.a)({},r.subLinkStyle),{},{lineColor:a})})}var l=n.getTopic(t);if(!l.style)return r;var u=JSON.parse(l.style);return Object(O.a)(Object(O.a)({},r),u.contentStyle)},getLinkStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;Hd("getLinkStyle",t);var r,c=n.getTopicVisualLevel(t),i=n.config.theme,a=i.linkStyle;r=c===Cc?i.rootTopic.linkStyle:c===wc?i.primaryTopic.linkStyle:i.normalTopic.linkStyle,a=Object(O.a)(Object(O.a)({},a),r);var l=n.getTopic(t);if(null!=l.parentKey){var u=o.run("getSubLinkStyle",Object(O.a)(Object(O.a)({},e),{},{topicKey:l.parentKey}));a=Object(O.a)(Object(O.a)({},a),u)}if(!l.style)return a;var s=JSON.parse(l.style);return Object(O.a)(Object(O.a)({},a),s.linkStyle)},getSubLinkStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;Hd("getLinkStyle",t);var r,c=n.getTopicVisualLevel(t),i=n.config.theme,a=i.linkStyle;r=c===Cc?i.rootTopic.subLinkStyle:c===wc?i.primaryTopic.subLinkStyle:i.normalTopic.subLinkStyle,a=Object(O.a)(Object(O.a)({},a),r);var l=n.getTopic(t);if(i.randomColor){var u=o.run("getRandomColor",e);Hd(u),a=Object(O.a)(Object(O.a)({},a),{},{lineColor:u})}if(!l.style)return a;var s=JSON.parse(l.style);return Object(O.a)(Object(O.a)({},a),s.subLinkStyle)},setTopicContentStyle:function(e){var t=e.topicKey,n=e.controller,o=e.style,r=e.model.getTopic(t).style,c=r?JSON.parse(r):{},i=Object(O.a)(Object(O.a)({},c),{},{contentStyle:Object(O.a)(Object(O.a)({},c.contentStyle),o)});if(!Object(ct.isEqual)(c,i)){var a=JSON.stringify(i);n.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Jc,style:a}))}},setLinkStyle:function(e){var t=e.topicKey,n=e.controller,o=e.linkStyle,r=e.model.getTopic(t).style,c=r?JSON.parse(r):{},i=Object(O.a)(Object(O.a)({},c),{},{linkStyle:Object(O.a)(Object(O.a)({},c.linkStyle),o)});if(!Object(ct.isEqual)(c,i)){var a=JSON.stringify(i);n.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Jc,style:a}))}},setSubLinkStyle:function(e){var t=e.topicKey,n=e.controller,o=e.subLinkStyle,r=e.model.getTopic(t).style,c=r?JSON.parse(r):{},i=Object(O.a)(Object(O.a)({},c),{},{subLinkStyle:Object(O.a)(Object(O.a)({},c.subLinkStyle),o)});if(!Object(ct.isEqual)(c,i)){var a=JSON.stringify(i);n.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Jc,style:a}))}},getTopicThemeStyle:function(e){var t=e.topicKey,n=e.model,o=n.getTopicVisualLevel(t),r=n.config.theme;return o===Cc?r.rootTopic:o===wc?r.primaryTopic:r.normalTopic},getRandomColor:function(n){var o=n.topicKey;if(e.has(o))return e.get(o);var r=["#00CC99","#FFEE88","#A167A5","#E5F993","#F5C396","#DB995A","#83BCFF","#ED7B84","#739E82","#D3BCC0","#FFA0FD","#EFD3D7","#C6878F"],c=r[++t%r.length];return e.set(o,c),Hd("getRandomColor",o,c),c}}}function Ud(){return[Id(),{getPartTopics:function(e){var t=e.layout,n=e.model,o=e.topicKey,r=n.getTopic(o),c=r.subKeys.size,i=r.subKeys.toArray();switch(t){case Tc.LEFT_TO_RIGHT:return{R:i};case Tc.RIGHT_TO_LEFT:return{L:i};case Tc.LEFT_AND_RIGHT:return{L:i.slice(Math.ceil(c/2),c),R:i.slice(0,Math.ceil(c/2))};case Tc.TOP_TO_BOTTOM:return{B:i}}},createSubTopics:function(e){var t=e.model,n=e.topicKey,o=e.controller,r=e.topics,c=e.saveRef,i=t.getTopic(n);if(0===r.size||i.collapse)return null;var a=[];return r.forEach((function(t){var n=Object(O.a)(Object(O.a)({},e),{},{topicKey:t,key:t,ref:c(El(t))});a.push(o.run("renderTopicWidget",n))})),{subTopics:a}},layout:function(e){var t=e.getRef,n=e.model,o=t(xl(n.editorRootTopicKey)),r=t(Ll),c=t(Il);o&&o.layout(),r&&r.layout(),c&&c.layout(),function e(o){if(o.key!==n.editorRootTopicKey){var r=t(El(o.key));r&&r.layoutLinks()}if(!o.collapse){var c,i=Object(m.a)(o.subKeys);try{for(i.s();!(c=i.n()).done;){var a=c.value;e(n.getTopic(a))}}catch(l){i.e(l)}finally{i.f()}}}(n.getTopic(n.editorRootTopicKey))},getRelativeRect:function(e){var t=e.element,n=e.controller,o=e.getRef,r=n.run("getZoomFactor",e);return xs(t,o(Kl).bigView,r)},getRelativeRectFromViewPort:function(e){var t=e.element,n=e.controller,o=e.getRef,r=n.run("getZoomFactor",e);return xs(t,o(Kl).viewBox,r)},getRelativeVectorFromViewPort:function(e){return Ss(e.element,(0,e.getRef)(Kl).viewBox)},addZoomFactorChangeEventListener:function(e){e.controller.run("addTempValueChangeListener",Object(O.a)({key:"ZoomFactor"},e))},removeZoomFactorChangeEventListener:function(e){e.controller.run("removeTempValueChangeListener",Object(O.a)({key:"ZoomFactor"},e))},setZoomFactor:function(e){var t=e.controller,n=e.zoomFactor;return t.run("setTempValue",{key:"ZoomFactor",value:n})},getZoomFactor:function(e){return e.controller.run("getTempValue",{key:"ZoomFactor"})||1},moveTopicToCenter:function(e){var t=e.getRef,n=e.topicKey,o=e.model,r=e.moveDir,c=void 0===r?Zs:r;if(o.editorRootTopicKey!==n&&pi(o,n,o.editorRootTopicKey)!==Fc)throw new Error("moveTopicToCenter error: topicKey ".concat(n," is not the DESCENDANT of editor root topic"));var i=t(kl(n)),a=t(Kl),l=a.viewBox;if(!i||!l)throw new Error("moveTopicToCenter error: topic or viewBox is null");var u=Ss(i,l);if(c===Ws)a.setViewBoxScrollDelta(u[0],u[1]);else if(c===Zs){var s=l.getBoundingClientRect(),p=i.getBoundingClientRect(),d=(s.width-p.width)/2;a.setViewBoxScrollDelta(u[0]+d-200,u[1])}},focusTopicAndMoveToCenter:function(e){var t=e.controller,n=e.topicKey;t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opArray:[{opType:Zc,topicKey:n,focusMode:Dc},{opType:Hc,topicKey:n}],allowUndo:!1,callback:function(o){return function(){t.run("moveTopicToCenter",Object(O.a)(Object(O.a)({},e),{},{model:o,topicKey:n}))}}}))}},qs(),Gd(),Ns(),Ys(),{getValue:function(e,t){var n=e.propKey,o=e.controller,r=e.diagramState;switch(n){case Ml:return 3;case Al:case Bl:return o.run("isOperationEnabled",e);case Fl:return o.run("getTopicTitle",e);case Pl:return r.dragDrop;case Nl:return r.rightTopPanel}return t()}},{getTopicTitle:function(e){var t=e.model,n=e.controller,o=e.topicKey,r=e.maxLength,c=t.getTopic(o).getBlock(Rc).block,i=n.run("serializeBlockData",Object(O.a)(Object(O.a)({},e),{},{block:c}));return null!=r&&(i=i.length>r?i.substr(0,r)+"...":i),i},renderTopicContentEditor:function(e){return Object(o.createElement)(Nd,Object.assign({},e))},renderTopicDescEditor:function(e){return Object(o.createElement)(Vd,Object.assign({},e))},isBlockEmpty:function(e,t){var n=e.block,o=e.controller;return n.type===Rc||n.type===Kc?null==n.data||""===o.run("serializeBlockData",e):t()},serializeBlockData:function(e,t){var n=e.block;return n.type===Rc||n.type===Kc?"string"===typeof n.data?n.data:Fe.a.serialize(n.data):t()}},{createNewModel:function(e){return gi.createEmpty()}},{getThemeOfTopic:function(e){var t=e.model.config.theme,n=t.contentStyle,o=t.rootTopic,r=t.primaryTopic,c=t.normalTopic;return{rootTopic:Object(O.a)(Object(O.a)({},o),{},{contentStyle:Object(O.a)(Object(O.a)({},n),o.contentStyle)}),primaryTopic:Object(O.a)(Object(O.a)({},r),{},{contentStyle:Object(O.a)(Object(O.a)({},n),r.contentStyle)}),normalTopic:Object(O.a)(Object(O.a)({},c),{},{contentStyle:Object(O.a)(Object(O.a)({},n),c.contentStyle)})}}},Js()]}y()("node:Diagram"),o.Component;var Wd=n(294),Zd=n.n(Wd),Yd=n(167),Jd=n.n(Yd),Xd=function(e,t){return(Xd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function qd(e,t){function n(){this.constructor=e}Xd(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Qd=function(){return(Qd=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};var $d,ef=y()("node:topic-content-editor"),tf=d.default.div($d||($d=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}(["\n  ",";\n"],["\n  ",";\n"])),(function(e){return!e.readOnly&&"\n    // padding: 75px\n    // min-width: 150px\n    // min-height: 150px\n  "})),nf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qd(t,e),t.prototype.initState=function(){e.prototype.initState.call(this);var t=this.props,n=t.controller,o="topic-desc-data-"+t.topicKey,r=this.state.content;n.run("setTempValue",{key:o,value:r})},t.prototype.getCustomizeProps=function(){var e=this.props,t=e.model,n=e.topicKey;return{block:t.getTopic(n).getBlock(Kc).block,readOnly:t.editingDescKey!==n,getRefKeyFunc:Tl,placeholder:"write topic notes here"}},t.prototype.onChange=function(e){var t=this.props,n=t.controller,o="topic-desc-data-"+t.topicKey;n.run("setTempValue",{key:o,value:e}),this.setState({content:e})},t}(function(e){function t(t){var n=e.call(this,t)||this;return n.onMouseDown=function(e){e.stopPropagation()},n.onMouseMove=function(e){e.stopPropagation()},n.rootRef=function(e){return function(t){e(t),n.root=t}},n._handleClick=function(e){!n.root.contains(e.target)&&n.onClickOutSide(e)},n.initState(),n}return qd(t,e),t.prototype.initState=function(){this.state={content:this.getContent()}},t.prototype.getContent=function(){return this.getCustomizeProps().block.data},t.prototype.onChange=function(e){this.setState({content:e})},t.prototype.getCustomizeProps=function(){return null},t.prototype.componentDidMount=function(){document.addEventListener("click",this._handleClick)},t.prototype.componentWillUnmount=function(){document.removeEventListener("click",this._handleClick)},t.prototype.onClickOutSide=function(e){},t.prototype.render=function(){var e=this.props,t=e.topicKey,n=e.saveRef,r=this.getCustomizeProps(),c=r.readOnly,i=r.getRefKeyFunc,a=r.placeholder;ef("readOnly:",c);var l=c?this.getContent():this.state.content;if(null==l)return null;var u=i(t),s=this.onMouseDown,p=this.onMouseMove,d={editorValue:l,readOnly:c,onChange:this.onChange.bind(this),placeholder:a},f={key:u,ref:this.rootRef(n(u)),readOnly:c,onMouseDown:s,onMouseMove:p};return Object(o.createElement)(tf,Qd({},f),Object(o.createElement)(Zd.a,Qd({},d)))},t}(Aa)),of=new Jd.a;var rf=function(){return{renderTopicDescEditor:function(e){return Object(o.createElement)(nf,Qd({},e))},isBlockEmpty:function(e,t){var n=e.block,o=e.controller;return n.type===Rc||n.type===Kc?null==n.data||""===o.run("serializeBlockData",e):t()},serializeBlockData:function(e,t){var n=e.block;return n.type===Kc?"string"===typeof n.data?n.data:of.serialize(n.data):t()}}};function cf(e){return!0===(null!=(t=e)&&"object"===typeof t&&!1===Array.isArray(t))&&"[object Object]"===Object.prototype.toString.call(e);var t}var af,lf=function(e){var t,n;return!1!==cf(e)&&("function"===typeof(t=e.constructor)&&(!1!==cf(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))};!function(e){e[e.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT",e[e.LEFT_AND_RIGHT=2]="LEFT_AND_RIGHT",e[e.TOP_TO_BOTTOM=3]="TOP_TO_BOTTOM"}(af||(af={}));var uf="CONTENT",sf="NORMAL",pf="EDITING_CONTENT",df="EDITING_DESC",ff=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"data",get:function(){return this.get("data")}},{key:"type",get:function(){return this.get("type")}}],[{key:"create",value:function(e){return new n(e)}},{key:"createList",value:function(e){if(j.List.isList(e)||Array.isArray(e))return Object(j.List)(e.map(n.create));throw new Error("Block.createList only accepts Array or List, but you passed it: ".concat(e))}}]),n}(Object(j.Record)({type:null,key:null,data:null}));var yf={readOnly:!1,allowUndo:!0,layoutDir:af.LEFT_AND_RIGHT,theme:{name:"default",randomColor:!0,background:"rgb(57,60,65)",highlightColor:"#50C9CE",marginH:60,marginV:20,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5,lineType:"curve",lineWidth:"3px"},rootTopic:{contentStyle:{fontSize:"34px",borderRadius:"35px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},primaryTopic:{contentStyle:{borderWidth:"1px",borderStyle:"solid",borderRadius:"20px",fontSize:"17px",padding:"10px 15px 10px 15px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},normalTopic:{contentStyle:{border:"1px solid #e8eaec",borderRadius:"20px",fontSize:"17px",padding:"4px 10px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"white"}}}},bf=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"layoutDir",get:function(){return this.get("layoutDir")}},{key:"readOnly",get:function(){return this.get("readOnly")}},{key:"allowUndo",get:function(){return this.get("allowUndo")}},{key:"theme",get:function(){return this.get("theme")}}],[{key:"fromJSON",value:function(e){return new n(e)}}]),n}(Object(j.Record)(yf));function gf(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var hf=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"key",get:function(){return this.get("key")}},{key:"parentKey",get:function(){return this.get("parentKey")}},{key:"collapse",get:function(){return this.get("collapse")}},{key:"subKeys",get:function(){return this.get("subKeys")}},{key:"blocks",get:function(){return this.get("blocks")}},{key:"relations",get:function(){return this.get("relations")}},{key:"style",get:function(){return this.get("style")}},{key:"getBlock",value:function(e){var t=this.blocks.findIndex((function(t){return t.type===e}));return-1===t?{index:t,block:null}:{index:t,block:this.blocks.get(t)}}}],[{key:"fromJSON",value:function(e){var t=e.key,o=e.parentKey,r=void 0===o?null:o,c=e.blocks,i=e.subKeys,a=void 0===i?[]:i,l=e.collapse;return new n({key:t,parentKey:r,collapse:void 0!==l&&l,subKeys:Object(j.List)(a),blocks:ff.createList(c)})}},{key:"create",value:function(e){var t=e.key,o=e.parentKey,r=void 0===o?null:o,c=e.content,i=void 0===c?"":c,a=e.subKeys,l=void 0===a?[]:a,u=e.collapse,s=void 0!==u&&u,p=ff.create({type:uf,data:i,key:null});return new n({key:t,parentKey:r,blocks:Object(j.List)([p]),subKeys:Object(j.List)(l),collapse:s})}}]),n}(Object(j.Record)({key:null,parentKey:null,collapse:!1,subKeys:null,blocks:null,relations:null,style:null}));y()("modifier");var Of={topics:Object(j.Map)(),extData:Object(j.Map)(),config:new bf,rootTopicKey:null,editorRootTopicKey:null,focusKey:null,focusMode:null,formatVersion:null,zoomFactor:1},mf=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"toJS",value:function(){return{rootTopicKey:this.rootTopicKey,topics:Object.values(this.topics.toJS()),config:this.config,extData:this.extData,zoomFactor:this.zoomFactor}}},{key:"extData",get:function(){return this.get("extData")}},{key:"topics",get:function(){return this.get("topics")}},{key:"config",get:function(){return this.get("config")}},{key:"formatVersion",get:function(){return this.get("formatVersion")}},{key:"rootTopicKey",get:function(){return this.get("rootTopicKey")}},{key:"editorRootTopicKey",get:function(){return this.get("editorRootTopicKey")}},{key:"focusKey",get:function(){return this.get("focusKey")}},{key:"focusMode",get:function(){return this.get("focusMode")}},{key:"editingContentKey",get:function(){return this.focusMode===pf?this.focusKey:null}},{key:"editingDescKey",get:function(){return this.focusMode===df?this.focusKey:null}},{key:"getTopic",value:function(e){return this.topics.get(e)}},{key:"getExtDataItem",value:function(e,t){return this.extData.get(e)||new t}},{key:"getParentTopic",value:function(e){var t=this.getTopic(e);return t.parentKey?this.getTopic(t.parentKey):null}},{key:"getTopicVisualLevel",value:function(e){for(var t=this.getTopic(e),n=0;t&&t.key!==this.editorRootTopicKey;)n++,t=this.getParentTopic(t.key);return n}},{key:"rootTopic",get:function(){return this.getTopic(this.rootTopicKey)}},{key:"zoomFactor",get:function(){return this.get("zoomFactor")}}],[{key:"isModel",value:function(e){return e instanceof n}},{key:"create",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null==t)return n.createEmpty();if(n.isModel(t)&&(e=t),lf(t)&&(e=n.fromJSON(t)),e)return null==e.focusKey&&(e=e.set("focusKey",e.rootTopicKey)),null==e.focusMode&&(e=e.set("focusMode",sf)),e;throw new Error("`Value.create` only accepts objects or values, but you passed it: ".concat(t))}},{key:"createEmpty",value:function(){var e=new n,t=hf.create({key:gf(),content:"RootTopic"});return e.update("topics",(function(e){return e.set(t.key,t)})).set("rootTopicKey",t.key).set("editorRootTopicKey",t.key).set("focusKey",t.key).set("focusMode",sf)}},{key:"fromJSON",value:function(e){var t=new n,o=e.topics,r=void 0===o?[]:o,c=e.config,i=void 0===c?{}:c,a=e.rootTopicKey,l=e.editorRootTopicKey;return void 0===l&&(l=a),t=(t=t.merge({rootTopicKey:a,editorRootTopicKey:l})).withMutations((function(e){r.forEach((function(t){e.update("topics",(function(e){return e.set(t.key,hf.fromJSON(t))}))})),e.set("config",bf.fromJSON(i))}))}}]),n}(Object(j.Record)(Of));y()("core:controller");var vf=function(){return(vf=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},jf=y()("plugin:json-serializer");function Tf(e){return!0===(null!=(t=e)&&"object"===typeof t&&!1===Array.isArray(t))&&"[object Object]"===Object.prototype.toString.call(e);var t}var Ef=function(e){var t,n;return!1!==Tf(e)&&("function"===typeof(t=e.constructor)&&(!1!==Tf(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))};var kf;!function(e){e[e.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT",e[e.LEFT_AND_RIGHT=2]="LEFT_AND_RIGHT",e[e.TOP_TO_BOTTOM=3]="TOP_TO_BOTTOM"}(kf||(kf={}));var xf="CONTENT",Sf="NORMAL",Cf="EDITING_CONTENT",wf="EDITING_DESC",Rf="ANCESTOR",Kf="DESCENDANT",Df="SIBLING",Lf="NONE",If=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"data",get:function(){return this.get("data")}},{key:"type",get:function(){return this.get("type")}}],[{key:"create",value:function(e){return new n(e)}},{key:"createList",value:function(e){if(j.List.isList(e)||Array.isArray(e))return Object(j.List)(e.map(n.create));throw new Error("Block.createList only accepts Array or List, but you passed it: ".concat(e))}}]),n}(Object(j.Record)({type:null,key:null,data:null}));var _f={name:"default",randomColor:!0,background:"rgb(57,60,65)",highlightColor:"#50C9CE",marginH:60,marginV:20,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5,lineType:"curve",lineWidth:"3px"},rootTopic:{contentStyle:{fontSize:"34px",borderRadius:"35px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},primaryTopic:{contentStyle:{borderWidth:"1px",borderStyle:"solid",borderRadius:"20px",fontSize:"17px",padding:"10px 15px 10px 15px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},normalTopic:{contentStyle:{border:"1px solid #e8eaec",borderRadius:"20px",fontSize:"17px",padding:"4px 10px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"white"}}},Mf={readOnly:!1,allowUndo:!0,layoutDir:kf.LEFT_AND_RIGHT,theme:_f},Af=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"layoutDir",get:function(){return this.get("layoutDir")}},{key:"readOnly",get:function(){return this.get("readOnly")}},{key:"allowUndo",get:function(){return this.get("allowUndo")}},{key:"theme",get:function(){return this.get("theme")}}],[{key:"fromJSON",value:function(e){return new n(e)}}]),n}(Object(j.Record)(Mf));function Ff(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var Pf=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"key",get:function(){return this.get("key")}},{key:"parentKey",get:function(){return this.get("parentKey")}},{key:"collapse",get:function(){return this.get("collapse")}},{key:"subKeys",get:function(){return this.get("subKeys")}},{key:"blocks",get:function(){return this.get("blocks")}},{key:"relations",get:function(){return this.get("relations")}},{key:"style",get:function(){return this.get("style")}},{key:"getBlock",value:function(e){var t=this.blocks.findIndex((function(t){return t.type===e}));return-1===t?{index:t,block:null}:{index:t,block:this.blocks.get(t)}}}],[{key:"fromJSON",value:function(e){var t=e.key,o=e.parentKey,r=void 0===o?null:o,c=e.blocks,i=e.subKeys,a=void 0===i?[]:i,l=e.collapse;return new n({key:t,parentKey:r,collapse:void 0!==l&&l,subKeys:Object(j.List)(a),blocks:If.createList(c)})}},{key:"create",value:function(e){var t=e.key,o=e.parentKey,r=void 0===o?null:o,c=e.content,i=void 0===c?"":c,a=e.subKeys,l=void 0===a?[]:a,u=e.collapse,s=void 0!==u&&u,p=If.create({type:xf,data:i,key:null});return new n({key:t,parentKey:r,blocks:Object(j.List)([p]),subKeys:Object(j.List)(l),collapse:s})}}]),n}(Object(j.Record)({key:null,parentKey:null,collapse:!1,subKeys:null,blocks:null,relations:null,style:null}));function Nf(e,t){var n=e.getTopic(t),o=[];if(n.subKeys.size>0){var r,c=n.subKeys.toArray();(r=o).push.apply(r,Object(v.a)(c)),o=c.reduce((function(t,n){return t.push.apply(t,Object(v.a)(Nf(e,n))),t}),o)}return o}var Bf=y()("modifier");function zf(e){var t=e.model,n=e.topicKey,o=e.focusMode;return Bf("focus topic"),n!==t.focusKey&&(t=t.set("focusKey",n)),o!==t.focusMode&&(t=t.set("focusMode",o)),t}var Vf={addChild:function(e){var t=e.model,n=e.topicKey;Bf("addChild:",n);var o=t.getTopic(n);if(o){var r=Pf.create({key:Ff(),parentKey:o.key});return o=o.set("collapse",!1).update("subKeys",(function(e){return e.push(r.key)})),zf({model:t=t.update("topics",(function(e){return e.set(n,o).set(r.key,r)})),topicKey:r.key,focusMode:Cf})}return t},addSibling:function(e){var t=e.model,n=e.topicKey;if(n===t.rootTopicKey)return t;var o=t.getTopic(n);if(o){var r=t.getTopic(o.parentKey),c=r.subKeys.indexOf(n),i=Pf.create({key:Ff(),parentKey:r.key});return zf({model:t=t.update("topics",(function(e){return e.set(i.key,i)})).updateIn(["topics",r.key,"subKeys"],(function(e){return e.insert(c+1,i.key)})),topicKey:i.key,focusMode:Cf})}return t},toggleCollapse:function(e){var t=e.model,n=e.topicKey,o=t.getTopic(n);return o&&0!==o.subKeys.size&&(o=o.merge({collapse:!o.collapse}),t=t.updateIn(["topics",o.key,"collapse"],(function(e){return!e}))),t=zf({model:t,topicKey:n,focusMode:Sf})},collapseAll:function(e){var t=e.model,n=Nf(t,t.editorRootTopicKey);return Bf(t),t=zf({model:t=t.withMutations((function(e){n.forEach((function(t){e.setIn(["topics",t,"collapse"],!0)}))})),topicKey:t.editorRootTopicKey,focusMode:Sf})},expandAll:function(e){var t=e.model,n=Nf(t,t.editorRootTopicKey);return Bf(t),t=t.withMutations((function(e){n.forEach((function(t){e.setIn(["topics",t,"collapse"],!1)}))})),Bf(t),t},expandTo:function(e){var t=e.model,n=e.topicKey,o=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[t],r=e.getTopic(t);r.parentKey;)n?o.push(r.parentKey):o.unshift(r.parentKey),r=e.getParentTopic(r.key);return o}(t,n).filter((function(e){return e!==n}));return function(e,t,n){var o=e.getTopic(t),r=e.getTopic(n);if(o&&r){if(o.parentKey==r.parentKey)return Df;for(var c=o;c.parentKey;){if(c.parentKey===r.key)return Kf;c=e.getParentTopic(c.key)}for(c=r;c.parentKey;){if(c.parentKey===o.key)return Rf;c=e.getParentTopic(c.key)}}return Lf}(t=t.withMutations((function(e){o.forEach((function(t){e.setIn(["topics",t,"collapse"],!1)}))})),n,t.editorRootTopicKey)!==Kf&&(t=t.set("editorRootTopicKey",t.rootTopicKey)),t},focusTopic:zf,setFocusMode:function(e){var t=e.model,n=e.focusMode;return Bf("setFocusMode"),n!==t.focusMode&&(t=t.set("focusMode",n)),t},deleteTopic:function(e){var t=e.model,n=e.topicKey;if(n===t.editorRootTopicKey)return t;var o=t.getTopic(n);return o&&(t=t.withMutations((function(e){e.update("topics",(function(e){e=e.delete(n);var o=Nf(t,n);return e=e.withMutations((function(e){o.forEach((function(t){e.delete(t)}))}))})),e.updateIn(["topics",o.parentKey,"subKeys"],(function(e){return e.delete(e.indexOf(n))})),e.focusKey===n&&e.set("focusKey",null).set("focusMode",null)}))),t},setBlockData:function(e){var t=e.model,n=e.topicKey,o=e.blockType,r=e.focusMode,c=e.data,i=t.getTopic(n);if(i){var a=i.getBlock(o),l=a.index,u=a.block;-1===l?t=t.updateIn(["topics",n,"blocks"],(function(e){return e.push(If.create({type:o,data:c}))})):u.data!==c&&(t=t.updateIn(["topics",n,"blocks",l,"data"],(function(e){return c}))),r&&(t=zf({model:t,topicKey:n,focusMode:r}))}return t},deleteBlock:function(e){var t=e.model,n=e.topicKey,o=e.blockType,r=t.getTopic(n);if(r){var c=r.getBlock(o).index;-1!==c&&(t=t.updateIn(["topics",n,"blocks"],(function(e){return e.delete(c)}))),t=zf({model:t,topicKey:null,focusMode:null})}return t},setStyle:function(e){var t=e.model,n=e.topicKey,o=e.style,r=t.getTopic(n);return r&&o!==r.style&&(t=t.updateIn(["topics",n,"style"],(function(e){return o}))),t},clearAllCustomStyle:function(e){var t=e.model;return t=t.withMutations((function(e){e.topics.keySeq().forEach((function(t){e.setIn(["topics",t,"style"],null)}))}))},setTheme:function(e){var t=e.model,n=e.theme;return t=t.setIn(["config","theme"],n)},setLayoutDir:function(e){var t=e.model,n=e.layoutDir;return t.config.layoutDir===n?t:t=t.setIn(["config","layoutDir"],n)},setEditorRootTopicKey:function(e){var t=e.model,n=e.topicKey;return t.editorRootTopicKey!==n&&(t=t.set("editorRootTopicKey",n)),t.getTopic(n).collapse&&(t=t.setIn(["topics",n,"collapse"],!1)),t},setZoomFactor:function(e){var t=e.model,n=e.zoomFactor;return t.zoomFactor!==n&&(t=t.set("zoomFactor",n)),t}},Hf={topics:Object(j.Map)(),extData:Object(j.Map)(),config:new Af,rootTopicKey:null,editorRootTopicKey:null,focusKey:null,focusMode:null,formatVersion:null,zoomFactor:1};Object(j.Record)(Hf);y()("core:controller");var Gf={name:"default",randomColor:!0,background:"rgb(57,60,65)",highlightColor:"#50C9CE",marginH:60,marginV:20,contentStyle:{lineHeight:"1.5",fontSize:"16px"},linkStyle:{lineRadius:5,lineType:"curve",lineWidth:"3px"},rootTopic:{contentStyle:{fontSize:"36px"},subLinkStyle:{lineType:"curve",lineWidth:"3px"}},primaryTopic:{contentStyle:{fontSize:"24px"},subLinkStyle:{lineType:"curve",lineWidth:"3px"}},normalTopic:{subLinkStyle:{lineType:"curve",lineWidth:"3px"}}},Uf={name:"theme1",randomColor:!1,background:"rgb(250,245,205)",highlightColor:"#50C9CE",marginH:50,marginV:30,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5},rootTopic:{contentStyle:{background:"rgb(221, 170, 68)",color:"#fff",fontSize:"34px",borderRadius:"5px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"2px",lineColor:"rgb(221, 170, 68)"}},primaryTopic:{contentStyle:{background:"#e8eaec",borderWidth:"2px",borderStyle:"solid",borderColor:"rgb(221, 170, 68)",borderRadius:"5px",fontSize:"17px",padding:"10px 15px 10px 15px"},subLinkStyle:{lineType:"curve",lineWidth:"2px",lineColor:"rgb(221, 170, 68)"}},normalTopic:{contentStyle:{background:"#fff",border:"1px solid #e8eaec",borderRadius:"20px",color:"rgb(187, 136, 34)",fontSize:"13px",padding:"4px 10px"},subLinkStyle:{lineType:"round",lineRadius:5,lineWidth:"1px",lineColor:"rgb(187, 136, 34)"}}},Wf={name:"theme2",randomColor:!1,background:"#f8f8f8",highlightColor:"#50C9CE",marginH:45,marginV:10,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5},rootTopic:{contentStyle:{background:"#50C18A",color:"#fff",fontSize:"34px",borderRadius:"5px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"2px",lineColor:"#43a9ff"}},primaryTopic:{contentStyle:{background:"#ffffff",borderWidth:"1px",borderStyle:"solid",borderColor:"rgb(221, 170, 68)",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"14px",padding:"6px 10px 5px 10px"},subLinkStyle:{lineType:"round",lineRadius:5,lineWidth:"2px",lineColor:"#43a9ff"}},normalTopic:{contentStyle:{background:"#fff",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"13px",padding:"3px 9px 4px",boxShadow:"1px 1px 1px #ccc"},subLinkStyle:{lineType:"round",lineRadius:5,lineWidth:"1px",lineColor:"#43a9ff"}}},Zf={name:"theme3",randomColor:!1,background:"#A9DEF9",highlightColor:"#50C9CE",marginH:50,marginV:20,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5},rootTopic:{contentStyle:{background:"#FF99C8",color:"#fff",fontSize:"34px",borderRadius:"5px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"2px",lineColor:"#43a9ff"}},primaryTopic:{contentStyle:{background:"#FCF6BD",borderWidth:"1px",borderStyle:"solid",borderColor:"#E4C1F9",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"14px",padding:"6px 10px 5px 10px"},subLinkStyle:{lineType:"curve",lineWidth:"2px",lineColor:"#43a9ff"}},normalTopic:{contentStyle:{background:"#E4FDE1",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"13px",padding:"3px 9px 4px",boxShadow:"1px 1px 1px #ccc"},subLinkStyle:{lineType:"round",lineRadius:5,lineWidth:"1px",lineColor:"#43a9ff"}}},Yf={name:"theme3",randomColor:!1,background:"#CCFBFE",highlightColor:"#50C9CE",marginH:50,marginV:20,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5},rootTopic:{contentStyle:{background:"#CD8987",color:"#fff",fontSize:"34px",borderRadius:"5px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"2px",lineColor:"#43a9ff"}},primaryTopic:{contentStyle:{background:"#CDACA1",borderWidth:"1px",borderStyle:"solid",borderColor:"#E4C1F9",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"14px",padding:"6px 10px 5px 10px"},subLinkStyle:{lineType:"line",lineWidth:"2px",lineColor:"#43a9ff"}},normalTopic:{contentStyle:{background:"#CDCACC",borderRadius:"5px",color:"rgb(103,103,103)",fontSize:"13px",padding:"3px 9px 4px",boxShadow:"1px 1px 1px #ccc"},subLinkStyle:{lineType:"line",lineRadius:5,lineWidth:"1px",lineColor:"#43a9ff"}}};function Jf(e){return!0===(null!=(t=e)&&"object"===typeof t&&!1===Array.isArray(t))&&"[object Object]"===Object.prototype.toString.call(e);var t}var Xf=function(e){var t,n;return!1!==Jf(e)&&("function"===typeof(t=e.constructor)&&(!1!==Jf(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))};var qf,Qf=function(e,t){},$f="L",ey="R",ty="M";!function(e){e[e.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT",e[e.LEFT_AND_RIGHT=2]="LEFT_AND_RIGHT",e[e.TOP_TO_BOTTOM=3]="TOP_TO_BOTTOM"}(qf||(qf={}));var ny=0,oy=1,ry="CONTENT",cy="DESC",iy="NORMAL",ay="EDITING_CONTENT",ly="EDITING_DESC",uy="SHOW_POPUP",sy="DRAGGING",py="ANCESTOR",dy="DESCENDANT",fy="SIBLING",yy="NONE",by="TOGGLE_COLLAPSE",gy="COLLAPSE_ALL",hy="EXPAND_ALL",Oy="EXPAND_TO",my="ADD_CHILD",vy="ADD_SIBLING",jy="DELETE_TOPIC",Ty="FOCUS_TOPIC",Ey="SET_FOCUS_MODE",ky="SET_STYLE",xy="CLEAR_ALL_CUSTOM_STYLE",Sy="SET_THEME",Cy="SET_TOPIC_BLOCK",wy="DELETE_TOPIC_BLOCK",Ry="START_EDITING_CONTENT",Ky="START_EDITING_DESC",Dy="DRAG_AND_DROP",Ly="SET_EDITOR_ROOT",Iy="SET_LAYOUT_DIR",_y=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"data",get:function(){return this.get("data")}},{key:"type",get:function(){return this.get("type")}}],[{key:"create",value:function(e){return new n(e)}},{key:"createList",value:function(e){if(j.List.isList(e)||Array.isArray(e))return Object(j.List)(e.map(n.create));throw new Error("Block.createList only accepts Array or List, but you passed it: ".concat(e))}}]),n}(Object(j.Record)({type:null,key:null,data:null}));var My={readOnly:!1,allowUndo:!0,layoutDir:qf.LEFT_AND_RIGHT,theme:{name:"default",randomColor:!0,background:"rgb(57,60,65)",highlightColor:"#50C9CE",marginH:60,marginV:20,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5,lineType:"curve",lineWidth:"3px"},rootTopic:{contentStyle:{fontSize:"34px",borderRadius:"35px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},primaryTopic:{contentStyle:{borderWidth:"1px",borderStyle:"solid",borderRadius:"20px",fontSize:"17px",padding:"10px 15px 10px 15px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},normalTopic:{contentStyle:{border:"1px solid #e8eaec",borderRadius:"20px",fontSize:"17px",padding:"4px 10px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"white"}}}},Ay=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"layoutDir",get:function(){return this.get("layoutDir")}},{key:"readOnly",get:function(){return this.get("readOnly")}},{key:"allowUndo",get:function(){return this.get("allowUndo")}},{key:"theme",get:function(){return this.get("theme")}}],[{key:"fromJSON",value:function(e){return new n(e)}}]),n}(Object(j.Record)(My));function Fy(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var Py=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"key",get:function(){return this.get("key")}},{key:"parentKey",get:function(){return this.get("parentKey")}},{key:"collapse",get:function(){return this.get("collapse")}},{key:"subKeys",get:function(){return this.get("subKeys")}},{key:"blocks",get:function(){return this.get("blocks")}},{key:"relations",get:function(){return this.get("relations")}},{key:"style",get:function(){return this.get("style")}},{key:"getBlock",value:function(e){var t=this.blocks.findIndex((function(t){return t.type===e}));return-1===t?{index:t,block:null}:{index:t,block:this.blocks.get(t)}}}],[{key:"fromJSON",value:function(e){var t=e.key,o=e.parentKey,r=void 0===o?null:o,c=e.blocks,i=e.subKeys,a=void 0===i?[]:i,l=e.collapse;return new n({key:t,parentKey:r,collapse:void 0!==l&&l,subKeys:Object(j.List)(a),blocks:_y.createList(c)})}},{key:"create",value:function(e){var t=e.key,o=e.parentKey,r=void 0===o?null:o,c=e.content,i=void 0===c?"":c,a=e.subKeys,l=void 0===a?[]:a,u=e.collapse,s=void 0!==u&&u,p=_y.create({type:ry,data:i,key:null});return new n({key:t,parentKey:r,blocks:Object(j.List)([p]),subKeys:Object(j.List)(l),collapse:s})}}]),n}(Object(j.Record)({key:null,parentKey:null,collapse:!1,subKeys:null,blocks:null,relations:null,style:null}));function Ny(e,t){var n=e.getTopic(t),o=[];if(n.subKeys.size>0){var r,c=n.subKeys.toArray();(r=o).push.apply(r,Object(v.a)(c)),o=c.reduce((function(t,n){return t.push.apply(t,Object(v.a)(Ny(e,n))),t}),o)}return o}function By(e,t,n){var o=e.getTopic(t),r=e.getTopic(n);if(o&&r){if(o.parentKey==r.parentKey)return fy;for(var c=o;c.parentKey;){if(c.parentKey===r.key)return dy;c=e.getParentTopic(c.key)}for(c=r;c.parentKey;){if(c.parentKey===o.key)return py;c=e.getParentTopic(c.key)}}return yy}var zy=y()("modifier");function Vy(e){var t=e.model,n=e.topicKey,o=e.focusMode;return zy("focus topic"),n!==t.focusKey&&(t=t.set("focusKey",n)),o!==t.focusMode&&(t=t.set("focusMode",o)),t}var Hy={addChild:function(e){var t=e.model,n=e.topicKey;zy("addChild:",n);var o=t.getTopic(n);if(o){var r=Py.create({key:Fy(),parentKey:o.key});return o=o.set("collapse",!1).update("subKeys",(function(e){return e.push(r.key)})),Vy({model:t=t.update("topics",(function(e){return e.set(n,o).set(r.key,r)})),topicKey:r.key,focusMode:ay})}return t},addSibling:function(e){var t=e.model,n=e.topicKey;if(n===t.rootTopicKey)return t;var o=t.getTopic(n);if(o){var r=t.getTopic(o.parentKey),c=r.subKeys.indexOf(n),i=Py.create({key:Fy(),parentKey:r.key});return Vy({model:t=t.update("topics",(function(e){return e.set(i.key,i)})).updateIn(["topics",r.key,"subKeys"],(function(e){return e.insert(c+1,i.key)})),topicKey:i.key,focusMode:ay})}return t},toggleCollapse:function(e){var t=e.model,n=e.topicKey,o=t.getTopic(n);return o&&0!==o.subKeys.size&&(o=o.merge({collapse:!o.collapse}),t=t.updateIn(["topics",o.key,"collapse"],(function(e){return!e}))),t=Vy({model:t,topicKey:n,focusMode:iy})},collapseAll:function(e){var t=e.model,n=Ny(t,t.editorRootTopicKey);return zy(t),t=Vy({model:t=t.withMutations((function(e){n.forEach((function(t){e.setIn(["topics",t,"collapse"],!0)}))})),topicKey:t.editorRootTopicKey,focusMode:iy})},expandAll:function(e){var t=e.model,n=Ny(t,t.editorRootTopicKey);return zy(t),t=t.withMutations((function(e){n.forEach((function(t){e.setIn(["topics",t,"collapse"],!1)}))})),zy(t),t},expandTo:function(e){var t=e.model,n=e.topicKey,o=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[t],r=e.getTopic(t);r.parentKey;)n?o.push(r.parentKey):o.unshift(r.parentKey),r=e.getParentTopic(r.key);return o}(t,n).filter((function(e){return e!==n}));return By(t=t.withMutations((function(e){o.forEach((function(t){e.setIn(["topics",t,"collapse"],!1)}))})),n,t.editorRootTopicKey)!==dy&&(t=t.set("editorRootTopicKey",t.rootTopicKey)),t},focusTopic:Vy,setFocusMode:function(e){var t=e.model,n=e.focusMode;return zy("setFocusMode"),n!==t.focusMode&&(t=t.set("focusMode",n)),t},deleteTopic:function(e){var t=e.model,n=e.topicKey;if(n===t.editorRootTopicKey)return t;var o=t.getTopic(n);return o&&(t=t.withMutations((function(e){e.update("topics",(function(e){e=e.delete(n);var o=Ny(t,n);return e=e.withMutations((function(e){o.forEach((function(t){e.delete(t)}))}))})),e.updateIn(["topics",o.parentKey,"subKeys"],(function(e){return e.delete(e.indexOf(n))})),e.focusKey===n&&e.set("focusKey",null).set("focusMode",null)}))),t},setBlockData:function(e){var t=e.model,n=e.topicKey,o=e.blockType,r=e.focusMode,c=e.data,i=t.getTopic(n);if(i){var a=i.getBlock(o),l=a.index,u=a.block;-1===l?t=t.updateIn(["topics",n,"blocks"],(function(e){return e.push(_y.create({type:o,data:c}))})):u.data!==c&&(t=t.updateIn(["topics",n,"blocks",l,"data"],(function(e){return c}))),r&&(t=Vy({model:t,topicKey:n,focusMode:r}))}return t},deleteBlock:function(e){var t=e.model,n=e.topicKey,o=e.blockType,r=t.getTopic(n);if(r){var c=r.getBlock(o).index;-1!==c&&(t=t.updateIn(["topics",n,"blocks"],(function(e){return e.delete(c)}))),t=Vy({model:t,topicKey:null,focusMode:null})}return t},setStyle:function(e){var t=e.model,n=e.topicKey,o=e.style,r=t.getTopic(n);return r&&o!==r.style&&(t=t.updateIn(["topics",n,"style"],(function(e){return o}))),t},clearAllCustomStyle:function(e){var t=e.model;return t=t.withMutations((function(e){e.topics.keySeq().forEach((function(t){e.setIn(["topics",t,"style"],null)}))}))},setTheme:function(e){var t=e.model,n=e.theme;return t=t.setIn(["config","theme"],n)},setLayoutDir:function(e){var t=e.model,n=e.layoutDir;return t.config.layoutDir===n?t:t=t.setIn(["config","layoutDir"],n)},setEditorRootTopicKey:function(e){var t=e.model,n=e.topicKey;return t.editorRootTopicKey!==n&&(t=t.set("editorRootTopicKey",n)),t.getTopic(n).collapse&&(t=t.setIn(["topics",n,"collapse"],!1)),t},setZoomFactor:function(e){var t=e.model,n=e.zoomFactor;return t.zoomFactor!==n&&(t=t.set("zoomFactor",n)),t}},Gy={topics:Object(j.Map)(),extData:Object(j.Map)(),config:new Ay,rootTopicKey:null,editorRootTopicKey:null,focusKey:null,focusMode:null,formatVersion:null,zoomFactor:1},Uy=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"toJS",value:function(){return{rootTopicKey:this.rootTopicKey,topics:Object.values(this.topics.toJS()),config:this.config,extData:this.extData,zoomFactor:this.zoomFactor}}},{key:"extData",get:function(){return this.get("extData")}},{key:"topics",get:function(){return this.get("topics")}},{key:"config",get:function(){return this.get("config")}},{key:"formatVersion",get:function(){return this.get("formatVersion")}},{key:"rootTopicKey",get:function(){return this.get("rootTopicKey")}},{key:"editorRootTopicKey",get:function(){return this.get("editorRootTopicKey")}},{key:"focusKey",get:function(){return this.get("focusKey")}},{key:"focusMode",get:function(){return this.get("focusMode")}},{key:"editingContentKey",get:function(){return this.focusMode===ay?this.focusKey:null}},{key:"editingDescKey",get:function(){return this.focusMode===ly?this.focusKey:null}},{key:"getTopic",value:function(e){return this.topics.get(e)}},{key:"getExtDataItem",value:function(e,t){return this.extData.get(e)||new t}},{key:"getParentTopic",value:function(e){var t=this.getTopic(e);return t.parentKey?this.getTopic(t.parentKey):null}},{key:"getTopicVisualLevel",value:function(e){for(var t=this.getTopic(e),n=0;t&&t.key!==this.editorRootTopicKey;)n++,t=this.getParentTopic(t.key);return n}},{key:"rootTopic",get:function(){return this.getTopic(this.rootTopicKey)}},{key:"zoomFactor",get:function(){return this.get("zoomFactor")}}],[{key:"isModel",value:function(e){return e instanceof n}},{key:"create",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null==t)return n.createEmpty();if(n.isModel(t)&&(e=t),Xf(t)&&(e=n.fromJSON(t)),e)return null==e.focusKey&&(e=e.set("focusKey",e.rootTopicKey)),null==e.focusMode&&(e=e.set("focusMode",iy)),e;throw new Error("`Value.create` only accepts objects or values, but you passed it: ".concat(t))}},{key:"createEmpty",value:function(){var e=new n,t=Py.create({key:Fy(),content:"RootTopic"});return e.update("topics",(function(e){return e.set(t.key,t)})).set("rootTopicKey",t.key).set("editorRootTopicKey",t.key).set("focusKey",t.key).set("focusMode",iy)}},{key:"fromJSON",value:function(e){var t=new n,o=e.topics,r=void 0===o?[]:o,c=e.config,i=void 0===c?{}:c,a=e.rootTopicKey,l=e.editorRootTopicKey;return void 0===l&&(l=a),t=(t=t.merge({rootTopicKey:a,editorRootTopicKey:l})).withMutations((function(e){r.forEach((function(t){e.update("topics",(function(e){return e.set(t.key,Py.fromJSON(t))}))})),e.set("config",Ay.fromJSON(i))}))}}]),n}(Object(j.Record)(Gy));function Wy(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.plugins,n=void 0===t?[]:t;return Object(v.a)(n)}y()("core:controller");function Zy(e,t){if(Array.isArray(t))t.forEach((function(t){return Zy(e,t)}));else if(null!=t)for(var n in t){var o=t[n];e.middleware[n]=e.middleware[n]||[],e.middleware[n].push(o)}}function Yy(e){if(!Array.isArray(e))throw new TypeError("Middleware stack must be an array!");var t,n=Object(m.a)(e);try{for(n.s();!(t=n.n()).done;){if("function"!==typeof t.value)throw new TypeError("Middleware must be composed of functions!")}}catch(o){n.e(o)}finally{n.f()}return function(t,n){var r=-1;return function c(i){if(i<=r)throw new Error("next() called multiple times");r=i;var a=e[i];i===e.length&&(a=n);if(!a)return null;try{return a(t,c.bind(null,i+1))}catch(o){throw o}}(0)}}var Jy,Xy,qy,Qy,$y,eb,tb,nb,ob,rb,cb,ib,ab,lb,ub,sb,pb,db,fb,yb,bb,gb,hb,Ob,mb,vb,jb,Tb,Eb,kb,xb,Sb,Cb,wb,Rb,Kb,Db,Lb,Ib,_b,Mb,Ab,Fb,Pb,Nb,Bb,zb,Vb,Hb,Gb,Ub,Wb,Zb,Yb,Jb,Xb,qb,Qb=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(a.a)(this,e);var n=t.plugins,o=void 0===n?[]:n,r=t.onChange,c=t.readOnly;this.readOnly=c,this.onChange=r,this.middleware=new Map;var i=Wy({plugins:o});Zy(this,i)}return Object(l.a)(e,[{key:"run",value:function(e){var t=this.middleware,n=t[e]||[];Qf(0!==n.length,"the middleware function ".concat(e," is not found!"));for(var o=Object(k.a)(Yy)(n),r=arguments.length,c=new Array(r>1?r-1:0),i=1;i<r;i++)c[i-1]=arguments[i];return o.apply(void 0,c)}},{key:"getValue",value:function(e,t){return this.run("getValue",Object(O.a)(Object(O.a)({},t),{},{propKey:e}))}},{key:"change",value:function(e,t){this.onChange(e,t),this.currentModel=e}}]),e}(),$b=(n(768),["title"]),eg=["layout","title"],tg=["layout","title"],ng=["controller","children","onClick"],og=["text"],rg=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){return Object(a.a)(this,n),t.call(this,e)}return Object(l.a)(n,[{key:"operation",value:function(e,t){this.props.controller.run("operation",Object(O.a)({opType:e},t))}},{key:"run",value:function(e,t){this.props.controller.run(e,t)}},{key:"topic",get:function(){return this.props.model.getTopic(this.props.topicKey)}}]),n}(o.Component),cg=y()("node:drag-scroll-widget"),ig=d.default.div(Jy||(Jy=Object(Ka.a)(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: scroll;\n"]))),ag=d.default.div(Xy||(Xy=Object(Ka.a)(["\n  position: relative;\n  width: max-content;\n"]))),lg=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).contentResizeCallback=function(e,t){if(o.oldContentRect){var n={width:o.content.clientWidth+2*o.viewBox.clientWidth,height:o.content.clientHeight+2*o.viewBox.clientHeight};o.bigView.style.width=n.width+"px",o.bigView.style.height=n.height+"px"}o.oldContentRect=e[0].contentRect},o.contentResizeObserver=new p.a(o.contentResizeCallback),o.contentRef=function(e){e&&(o.content=e,o.contentResizeObserver.observe(o.content))},o.viewBoxRef=function(e){e&&(o.viewBox=e,o.props.enableMouseWheel||(cg("addEventListener onwheel"),o.viewBox.addEventListener("wheel",(function(e){cg("onwheel"),(e.ctrlKey||e.altKey)&&e.preventDefault()}),{passive:!1})),o.setViewBoxScroll(o.viewBox.clientWidth,o.viewBox.clientHeight))},o.bigViewRef=function(e){e&&(o.bigView=e)},o.setWidgetStyle=function(){o.content&&o.viewBox&&o.bigView&&(o.bigView.style.width=2*(o.content.clientWidth+o.viewBox.clientWidth)+"px",o.bigView.style.height=2*(o.content.clientHeight+o.viewBox.clientHeight)+"px",o.content.style.left=o.viewBox.clientWidth+"px",o.content.style.top=o.viewBox.clientHeight+"px")},o.setViewBoxScroll=function(e,t){cg("setViewBoxScroll ".concat(e," ").concat(t)),o.viewBox&&(o.viewBox.scrollLeft=e,o.viewBox.scrollTop=t)},o.setViewBoxScrollDelta=function(e,t){cg("setViewBoxScrollDelta ".concat(e," ").concat(t)),o.viewBox&&(o.viewBox.scrollLeft+=e,o.viewBox.scrollTop+=t)},o.onMouseDown=function(e){var t=o.props,n=t.mouseKey,r=t.needKeyPressed,c=t.canDragFunc;if((!c||c())&&(0===e.button&&"left"===n||2===e.button&&"right"===n)){if(r&&!e.ctrlKey)return;o._lastCoordX=o.viewBox.scrollLeft+e.nativeEvent.clientX,o._lastCoordY=o.viewBox.scrollTop+e.nativeEvent.clientY;var i=o.viewBox;i.addEventListener("mousemove",o.onMouseMove),i.addEventListener("mouseup",o.onMouseUp)}},o.onMouseUp=function(e){var t=o.viewBox;t.removeEventListener("mousemove",o.onMouseMove),t.removeEventListener("mouseup",o.onMouseUp)},o.onMouseMove=function(e){o.viewBox.scrollLeft=o._lastCoordX-e.clientX,o.viewBox.scrollTop=o._lastCoordY-e.clientY},o.handleContextMenu=function(e){e.preventDefault()},o.state={widgetStyle:{width:"10000px",height:"10000px"}},o}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.setWidgetStyle(),document.addEventListener("contextmenu",this.handleContextMenu)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("contextmenu",this.handleContextMenu)}},{key:"setZoomFactor",value:function(e){this.bigView.style.transform="scale(".concat(e,")"),this.bigView.style.transformOrigin="50% 50%"}},{key:"render",value:function(){var e=Object(O.a)({},this.state.widgetStyle);return Object(o.createElement)(ig,{ref:this.viewBoxRef,onMouseDown:this.onMouseDown},Object(o.createElement)("div",{style:e,ref:this.bigViewRef},Object(o.createElement)(ag,{ref:this.contentRef,style:this.state.contentStyle},this.props.children(this.setViewBoxScroll,this.setViewBoxScrollDelta))))}}]),n}(o.Component);lg.defaultProps={mouseKey:"left",needKeyPressed:!1};var ug=y()("node:save-ref"),sg=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).getRef=function(t){return ug(Object(Ra.a)(e)),e[t]},e.saveRef=function(t){return function(n){n&&(e[t]=n,e.fireListener(t,n))}},e.deleteRef=function(t){ug("deleteRef:",t),delete e[t]},e.observers=new Map,e.fireListener=function(t,n){if(e.observers.has(t)){var o,r=e.observers.get(t),c=Object(m.a)(r);try{for(c.s();!(o=c.n()).done;){(0,o.value)(t,n)}}catch(i){c.e(i)}finally{c.f()}}},e.registerRefListener=function(t,n){e.observers.has(t)?e.observers.get(t).push(n):e.observers.set(t,[n])},e}return Object(l.a)(n,[{key:"render",value:function(){return this.props.children(this.saveRef,this.getRef,this.deleteRef,this.registerRefListener.bind(this))}}]),n}(o.Component),pg=d.default.div(qy||(qy=Object(Ka.a)(["\n  display: flex;\n  flex-direction: ",";\n  align-items: ",";\n  justify-content: ",";\n"])),(function(e){return e.flexDirection?e.flexDirection:"row"}),(function(e){return e.alignItems}),(function(e){return e.justifyContent})),dg=d.default.div(Qy||(Qy=Object(Ka.a)(["\n  margin: ",";\n"])),(function(e){return e.margin})),fg=d.default.a($y||($y=Object(Ka.a)(["\n  font-size: 20px !important;\n"]))),yg=d.default.div(eb||(eb=Object(Ka.a)(["\n  padding: 5px;\n  cursor: pointer;\n"]))),bg=d.default.div(tb||(tb=Object(Ka.a)(["\n  cursor: pointer;\n  &:hover {\n    color: #1ea7fd;\n  }\n"]))),gg=Object(d.default)(b.e)(nb||(nb=Object(Ka.a)(["\n  margin-bottom: 0px !important;\n"]))),hg=Object(d.default)(bg)(ob||(ob=Object(Ka.a)(["\n  position: absolute;\n  right: 5px;\n  top: 5px;\n  //padding: 5px;\n"]))),Og=d.default.div(rb||(rb=Object(Ka.a)(["\n  height: 16px;\n"]))),mg=d.default.span(cb||(cb=Object(Ka.a)(["\n  margin: 0px 10px;\n  &:hover {\n    color: palevioletred;\n  }\n"]))),vg=d.default.div(ib||(ib=Object(Ka.a)(["\n  z-index: ",";\n"])),(function(e){return e.zIndex})),jg=d.default.div(ab||(ab=Object(Ka.a)(["\n  min-width: 380px;\n  max-width: 482px;\n  max-height: 470px;\n  overflow: auto;\n"]))),Tg=d.default.div(lb||(lb=Object(Ka.a)(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n"]))),Eg=(d.default.div(ub||(ub=Object(Ka.a)(["\n  max-height: ",";\n  overflow-y: auto;\n  overflow-x: hidden;\n"])),(function(e){return e.maxHeight||"300px"})),d.default.div(sb||(sb=Object(Ka.a)(["\n  margin-top: 10px;\n  margin-bottom: 5px;\n  font-weight: bold;\n"])))),kg=d.default.span(pb||(pb=Object(Ka.a)(["\n  margin: 0 10px 0 2px;\n"]))),xg=d.default.div(db||(db=Object(Ka.a)(["\n  padding: 10px;\n  margin: 0 0 10px 0;\n  border: rgba(16, 22, 26, 0.15) solid 1px;\n  border-radius: 5px;\n"]))),Sg=Object(d.default)(kg)(fb||(fb=Object(Ka.a)([""]))),Cg=d.default.div(yb||(yb=Object(Ka.a)(["\n  display: flex;\n  align-items: center;\n  //justify-content: center;\n  margin: 5px 0;\n"]))),wg=d.default.div(bb||(bb=Object(Ka.a)(["\n  height: 3px;\n  width: 80%;\n  margin-left: 10%;\n  margin-right: 10%;\n  margin-bottom: 2px;\n  background: ",";\n"])),(function(e){return e.color})),Rg=d.default.div(gb||(gb=Object(Ka.a)(["\n  border: 1px solid grey;\n  cursor: pointer;\n  font-weight: bold;\n"]))),Kg="show-menu",Dg="close",Lg="color-picker",Ig="notes",_g="plus",Mg="minus",Ag="collapse",Fg="expand",Pg="center",Ng="trash",Bg="layout-left-and-right";function zg(e){return"icon iconfont bm-".concat(e)}function Vg(e){return Object(o.createElement)("span",{className:zg(e)})}function Hg(e){return"content-".concat(e)}function Gg(e){return"content-editor-".concat(e)}function Ug(e){return"desc-editor-".concat(e)}function Wg(e){return"topic-widget-".concat(e)}function Zg(e){return"topic-".concat(e)}function Yg(e){return"links-".concat(e)}function Jg(e){return"links-svg-".concat(e)}function Xg(e){return"collapse-".concat(e)}function qg(e,t){return"dropArea-".concat(t,"-").concat(e)}var Qg="DIAGRAM-ROOT",$g="DragScrollWidget",eh="svg-highlight",th="focus-highlight",nh="drop-effect",oh="CENTER_ROOT_TOPIC",rh="DIAGRAM_CUSTOMIZE_BASE_Z_INDEX",ch="TOPIC_CONTEXT_MENU_ENABLED",ih="TOPIC_TITLE",ah="DRAG_DROP_STATE",lh="RIGHT_TOP_PANEL_STATE",uh="OPERATION_ENABLED",sh="CONFIRM",ph="CANCEL",dh="DEFAULT",fh="SEARCH",yh="LEFT_AND_RIGHT",bh="ONLY_LEFT",gh="ONLY_RIGHT",hh="EDIT",Oh="ADD_SIBLING",mh="ADD_CHILD",vh="EDIT_NOTES",jh="DELETE",Th="SET_AS_EDITOR_ROOT",Eh="EDIT_TOPOLOGY_DIAGRAM",kh="SET_TOPIC_REFERENCES",xh="TOPIC_STYLE",Sh="STYLE",Ch="TEXT_EDITOR",wh="LINK",Rh="LINK_TO_PARENT",Kh="SUB_LINKS",Dh="COPY_STYLE",Lh="PASTE_STYLE",Ih="CLEAR_TOPIC_STYLE",_h="CLEAR_ALL_CUSTOM_STYLE",Mh="LINE_TYPE",Ah="THEME",Fh="GLOBAL",Ph="HIGHLIGHT",Nh="RANDOM_COLOR",Bh="NORMAL_TOPIC",zh="PRIMARY_TOPIC",Vh="ROOT_TOPIC",Hh="EXPORT_THEME",Gh="IMPORT_THEME",Uh="TAGS",Wh="TAGS_MANAGER",Zh="TAG_NAME",Yh="ADD_TAG",Jh="UPDATE_TAG",Xh="ALREADY_ADDED",qh="CAN_BE_ADDED",Qh="TOPICS_THAT_USE_THIS_TAG",$h="BACKGROUND",eO="COLOR",tO="BORDER",nO="WIDTH",oO="RADIUS",rO="FONT_SIZE",cO="LINE_HEIGHT",iO="PADDING",aO="TOP",lO="BOTTOM",uO="LEFT",sO="RIGHT",pO="NONE",dO="SOLID",fO="DOTTED",yO="DASHED",bO="DOUBLE",gO="ROUND",hO="CURVE",OO="LINE",mO="COLLAPSE_ALL",vO="EXPAND_ALL",jO="CENTER_ROOT_TOPIC",TO="ZOOM",EO="ZOOM_IN",kO="ZOOM_OUT",xO="RESET",SO="RESET_ZOOM",CO="NOTE_PLACEHOLDER",wO="TOPOLOGY_DIAGRAM_EDITOR",RO="BASIC",KO="FLOW_GRAPH",DO="ACTIVITY_DIAGRAM",LO="SEQUENCE_DIAGRAM",IO="CLASS_DIAGRAM",_O="REFERENCE_TOPICS",MO="REFERENCED_TOPICS",AO="SELECT_REF_TOPICS_TIP",FO="TAG_NAME_OVER_MAX_TIP",PO="DELETE_TAG_TIP",NO="DELETE_TOPOLOGY_TIP",BO=function(e){e.stopPropagation()};function zO(e,t){!function(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.click()}("data:text/plain,".concat(encodeURIComponent(e)),t)}function VO(e){var t=e.top,n=void 0===t?0:t,o=e.right,r=void 0===o?0:o,c=e.bottom,i=void 0===c?0:c,a=e.left,l=void 0===a?0:a;return"".concat(n,"px ").concat(r,"px ").concat(i,"px ").concat(l,"px")}function HO(e,t){return Array.isArray(t)?t.map((function(t){return e.controller.run("getI18nText",Object(O.a)(Object(O.a)({},e),{},{key:t}))})):e.controller.run("getI18nText",Object(O.a)(Object(O.a)({},e),{},{key:t.toUpperCase()}))}function GO(e){return(e.top+e.bottom)/2}function UO(e,t){return(e.x+t.x)/2}function WO(e,t){return(e.y+t.y)/2}function ZO(e){return[(e.left+e.right)/2,(e.top+e.bottom)/2]}function YO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=e.getBoundingClientRect(),r=t.getBoundingClientRect(),c=ZO(r),i=ZO(o);i[0]=(i[0]-c[0])/n,i[1]=(i[1]-c[1])/n;var a=o.width/n,l=o.height/n;return{left:i[0]-a/2,right:i[0]+a/2,top:i[1]-l/2,bottom:i[1]+l/2,width:a,height:l}}function JO(e,t){var n=e.getBoundingClientRect(),o=ZO(t.getBoundingClientRect()),r=ZO(n);return[r[0]-o[0],r[1]-o[1]]}function XO(e){return Object(o.createElement)("div",null,e.children,Object(o.createElement)(b.h,{style:{margin:"10px 0"}}))}function qO(e){var t=e.title,n=e.layout,r=void 0===n?"h":n,c=e.color,i=e.handleColorChange,a={flexDirection:"h"===r?"row":"column",alignItems:"center"};return Object(o.createElement)(kg,null,Object(o.createElement)(pg,Object.assign({},a),null!=t&&Object(o.createElement)(dg,{margin:"0 5px 0 0"},t),Object(o.createElement)(b.s,null,Object(o.createElement)(Rg,null,Object(o.createElement)("div",{className:zg(Lg)}),Object(o.createElement)(wg,{color:c})),Object(o.createElement)("div",null,Object(o.createElement)(rt.a,{color:c,onChangeComplete:function(e){return i(e.hex)}})))))}function QO(e){var t=e.title,n=Object(wa.a)(e,$b);return Object(o.createElement)(kg,null,Object(o.createElement)(b.d,Object.assign({},n),t))}function $O(e){var t=e.layout,n=void 0===t?"h":t,r=e.title,c=Object(wa.a)(e,eg),i={flexDirection:"h"===n?"row":"column",alignItems:"center"};return Object(o.createElement)(kg,null,Object(o.createElement)(pg,Object.assign({},i),Object(o.createElement)(dg,{margin:"0 5px 0 0"},r),Object(o.createElement)(b.q,Object.assign({},c))))}function em(e){var t=e.layout,n=void 0===t?"h":t,r=e.title,c=Object(wa.a)(e,tg),i={flexDirection:"h"===n?"row":"column",alignItems:"center"};return Object(o.createElement)(kg,null,Object(o.createElement)(pg,Object.assign({},i),Object(o.createElement)(dg,{margin:"0 5px 0 0"},r," "),Object(o.createElement)(b.m,Object.assign({},c))))}function tm(e){var t=e.text,n=e.items,r=e.itemRenderer,c=e.onItemSelect,i=ot.a.ofType(),a={items:n,itemRenderer:r,onItemSelect:c,filterable:!1};return Object(o.createElement)(kg,null,Object(o.createElement)(i,Object.assign({},a),Object(o.createElement)(b.d,{text:t})))}var nm=function(e){return function(t,n){var r=n.handleClick;return Object(o.createElement)(b.p,{text:"".concat(t).concat(e),key:t,onClick:r})}},om=function(e){return function(t,n){var r=n.handleClick;return Object(o.createElement)(b.p,{text:HO(e,t),key:t,onClick:r})}},rm=(ot.a.ofType(),Object(v.a)(Array(7).keys())),cm=d.default.div(hb||(hb=Object(Ka.a)(["\n  position: relative;\n  padding: 6px;\n  width: 40px;\n  height: 40px;\n  cursor: pointer;\n  color: ",";\n  font-size: 24px;\n  display: inline-block;\n  &:hover {\n    color: ",";\n  }\n"])),(function(e){return e.disabled?"grey":"black"}),(function(e){return e.disabled?"grey":"rgb(44, 184, 146)"}));function im(e){var t=e.controller,n=e.children,r=e.onClick,c=Object(wa.a)(e,ng),i=e.disabled;i=i||!t.getValue(uh,e);var a=Object(O.a)({controller:t,disabled:i,onClick:function(e){i||r(e)}},c);return Object(o.createElement)(cm,Object.assign({},a),n)}var am=y()("plugin:event");function lm(){var e={};return{handleTopicClick:function(e){am("handleTopicClick");var t=e.controller,n=e.model,o=e.topicKey;am(n.zoomFactor),null===n.editingDescKey&&n.editingContentKey!==o&&(n.focusKey===o&&n.focusMode===ay||t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Ty,focusMode:iy})))},handleTopicDoubleClick:function(e){var t=e.controller;null===e.model.editingDescKey&&t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Ty,focusMode:ay}))},handleTopicContextMenu:function(e){e.controller.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Ty,focusMode:uy}))},handleActiveModalClose:function(e){var t=e.controller,n=t.run("getActiveModalProps",e);return null==n?null:"edit-desc"===n.name?function(){t.run("operation",Object(O.a)(Object(O.a)({},e),{},{focusMode:iy,opType:Ty}))}:void 0},addEventListener:function(t){var n=t.key,o=t.listener,r=t.once,c=t.controller;function i(){o(),c.run("removeEventListener",{key:n,listener:o})}e[n]||(e[n]=[]),r?(i.origin=o,e[n].push(i)):e[n].push(o)},removeEventListener:function(t){var n=t.key,o=t.listener;e[n]&&(e[n]=e[n].filter((function(e){return e!==o&&e.origin!==o})))},fireEvent:function(t){var n=t.key;e[n]&&e[n].forEach((function(e){return e()}))}}}var um="ADD_CHILD",sm="ADD_SIBLING",pm="DELETE_TOPIC",dm="EDIT_CONTENT",fm="EDIT_NOTES",ym="SET_EDITOR_ROOT",bm=0,gm=1;function hm(){return{customizeHotKeys:function(e){var t=function(t){return function(n){!function(e,t){var n=t,o=n.topicKey,r=n.model,c=n.controller;void 0===o&&(t=Object(O.a)(Object(O.a)({},t),{},{topicKey:r.focusKey})),c.run("operation",Object(O.a)(Object(O.a)({},t),{},{opType:e}))}(t,e)}};return{topicHotKeys:new Map([[um,{label:"add child",combo:"tab",onKeyDown:t(my)}],[sm,{label:"add sibling",combo:"enter",onKeyDown:t(vy)}],[pm,{label:"delete topic",combo:"del",onKeyDown:t(jy)}],[dm,{label:"edit content",combo:"space",onKeyDown:t(Ry)}],[fm,{label:"edit notes",combo:"alt + d",onKeyDown:t(Ky)}],[ym,{label:"set editor root",combo:"alt + shift + f",onKeyDown:t(Ly)}]]),globalHotKeys:new Map}}}}function Om(){var e=new Map([[sh,"Confirm"],[ph,"Cancel"],[dh,"Default"],[fh,"Search"],[yh,"Left And Right"],[bh,"Only Left"],[gh,"Only Right"],[hh,"Edit"],[mh,"Add Child"],[Oh,"Add Sibling"],[vh,"Edit Notes"],[jh,"Delete"],[Th,"Set as Editor Root"],[Eh,"Edit Topology Diagram"],[kh,"Set Topic References"],[xh,"TopicStyle"],[Sh,"Style"],[Ch,"Text Editor"],[wh,"Link"],[Rh,"LinkToParent"],[Kh,"SubLinks"],[Dh,"Copy Style"],[Lh,"Paste Style"],[Ih,"Clear Topic Style"],[_h,"Clear All Custom Style"],[Mh,"LineType"],[Ah,"Theme"],[Fh,"Global"],[Ph,"Highlight"],[Nh,"Random Color"],[Bh,"NormalTopic"],[zh,"PrimaryTopic"],[Vh,"RootTopic"],[Hh,"Export Theme"],[Gh,"Import Theme"],[Uh,"Tags"],[Wh,"Tags Manager"],[Zh,"Tag Name"],[Yh,"Add Tag"],[Jh,"Update Tag"],[Xh,"Already Added"],[qh,"Can be Added"],[Qh,"Topics that Use this Tag"],[$h,"Background"],[eO,"Color"],[tO,"Border"],[nO,"Width"],[oO,"Radius"],[rO,"FontSize"],[cO,"LineHeight"],[iO,"Padding"],[aO,"Top"],[lO,"Bottom"],[uO,"Left"],[sO,"Right"],[pO,"None"],[dO,"Solid"],[fO,"Dotted"],[yO,"Dashed"],[bO,"Double"],[gO,"Round"],[hO,"Curve"],[OO,"Line"],[mO,"Collapse All"],[vO,"Expand All"],[jO,"Center Root Topic"],[TO,"zoom"],[EO,"Zoom In"],[kO,"Zoom Out"],[xO,"Reset"],[SO,"Reset Zoom"],[CO,"Write topic notes here"],[wO,"Topology Diagram Editor"],[RO,"Basic"],[KO,"Flow Graph"],[DO,"Activity Diagram"],[LO,"Sequence Diagram"],[IO,"Class Diagram"],[_O,"Reference Topics"],[MO,"Referenced Topics"],[AO,"Please select the topics you want to reference. After selection, click the confirm button."],[FO,"The length of tag name over the maximum length: 50!"],[PO,"All the relationship about this tag will be lost if you delete this tag! Are you confirm?"],[NO,"Are you confirm to delete this topology diagram?"]]);return{getI18nTextMap:function(){return e},getI18nText:function(e){var t=e.controller,n=e.key,o=t.run("getI18nTextMap",e);if(!o.has(n))throw new Error("i18n key ".concat(n," is not exist"));return o.get(n)}}}var mm=y()("plugin:operation");function vm(){var e=new Map([[by,Hy.toggleCollapse],[gy,Hy.collapseAll],[hy,Hy.expandAll],[Oy,Hy.expandTo],[my,Hy.addChild],[vy,Hy.addSibling],[jy,Hy.deleteTopic],[Ty,Hy.focusTopic],[Ey,Hy.setFocusMode],[ky,Hy.setStyle],[xy,Hy.clearAllCustomStyle],[Sy,Hy.setTheme],[Cy,Hy.setBlockData],[wy,Hy.deleteBlock],[Ry,function(e){var t=e.model,n=e.topicKey;return Hy.focusTopic({model:t,topicKey:n,focusMode:ay})}],[Ky,function(e){var t=e.model,n=e.topicKey,o=t.getTopic(n).getBlock(cy);return null!=o.block&&null!=o.block.data||(t=Hy.setBlockData({model:t,topicKey:n,blockType:cy,data:""})),t=Hy.focusTopic({model:t,topicKey:n,focusMode:ly})}],[Dy,function(e){var t=e.srcKey,n=e.dstKey,o=e.dropDir,r=e.model,c=r.getTopic(t),i=r.getTopic(n),a=c.parentKey,l=r.getTopic(a).subKeys,u=l.indexOf(t);if(l=l.delete(u),"in"===o){var s=i.subKeys;s=s.push(t),r=r.withMutations((function(e){e.setIn(["topics",a,"subKeys"],l).setIn(["topics",t,"parentKey"],n).setIn(["topics",n,"subKeys"],s).setIn(["topics",n,"collapse"],!1)}))}else{var p=i.parentKey,d=r.getTopic(p).subKeys,f=d.indexOf(n);if(a===p){var y=Object(j.List)();d.forEach((function(e){e!==t&&(y=e===n?"prev"===o?y.push(t).push(e):y.push(e).push(t):y.push(e))})),r=r.withMutations((function(e){e.setIn(["topics",p,"subKeys"],y)}))}else"prev"===o?d=d.insert(f,t):"next"===o&&(d=d.insert(f+1,t)),r=r.withMutations((function(e){e.setIn(["topics",a,"subKeys"],l).setIn(["topics",t,"parentKey"],p).setIn(["topics",p,"subKeys"],d).setIn(["topics",p,"collapse"],!1)}))}return r}],[Ly,Hy.setEditorRootTopicKey],[Iy,Hy.setLayoutDir]]),t=Object(j.Stack)(),n=Object(j.Stack)(),o=!0,r=new Set;return{isOperationEnabled:function(e){return o},enableOperation:function(){o=!0},disableOperation:function(e){var t=e.whiteList;o=!1,t?r=new Set(t):r.clear()},getOpMap:function(t){return e},getAllowUndo:function(e){var t=e.model,n=e.opType,o=e.allowUndo;if(!1===(void 0===o||o))return!1;if(n)switch(n){case Ty:case Ey:case Ry:case Ky:return!1}switch(t.focusMode){case"EDITING_DESC":case"EDITING_CONTENT":return!1}return t.config.allowUndo},getUndoRedoStack:function(){return{undoStack:t,redoStack:n}},setUndoStack:function(e){mm("setUndoStack",e.undoStack),t=e.undoStack},setRedoStack:function(e){mm("setRedoStack",e.redoStack),n=e.redoStack},canUndo:function(e){var t=e.controller;if(!t.run("isOperationEnabled",e))return!1;var n=t.run("getUndoRedoStack",e).undoStack,o=t.run("getAllowUndo",e);return n.size>0&&o},canRedo:function(e){var t=e.controller;if(!t.run("isOperationEnabled",e))return!1;var n=t.run("getUndoRedoStack",e).redoStack,o=t.run("getAllowUndo",e);return n.size>0&&o},undo:function(e){var t=e.controller,n=e.model;if(t.run("getAllowUndo",e)){var o=t.run("getUndoRedoStack",e),r=o.undoStack,c=o.redoStack,i=r.peek();i&&(t.run("setUndoStack",Object(O.a)(Object(O.a)({},e),{},{undoStack:r.shift()})),t.run("setRedoStack",Object(O.a)(Object(O.a)({},e),{},{redoStack:c.push(n)})),mm(i),t.change(i))}},redo:function(e){var t=e.controller,n=e.model;if(t.run("getAllowUndo",e)){var o=t.run("getUndoRedoStack",e),r=o.undoStack,c=o.redoStack,i=c.peek();i&&(t.run("setUndoStack",Object(O.a)(Object(O.a)({},e),{},{undoStack:r.push(n)})),t.run("setRedoStack",Object(O.a)(Object(O.a)({},e),{},{redoStack:c.shift()})),t.change(i))}},operation:function(e){var t=e.controller,n=e.opType,o=e.model,c=e.opArray,i=e.callback;if(null!=c&&!Array.isArray(c))throw new Error("operation: the type of opArray must be array!");if(null!=n&&null!=c)throw new Error("operation: opType and opArray conflict!");if(!t.run("isOperationEnabled",e)){if(0===r.size)return;if(null!=c){var a=c.filter((function(e){return!r.has(e.opType)}));if(a&&a.length>0)return}else if(!r.has(n))return}mm("operation:",n||c.map((function(e){return e.opType}))),mm("operation:",o),mm("operation:",e);var l,u=t.run("getOpMap",e);if(t.run("beforeOperation",e),t.run("getAllowUndo",e)){var s=t.run("getUndoRedoStack",e).undoStack;t.run("setUndoStack",Object(O.a)(Object(O.a)({},e),{},{undoStack:s.push(o)}))}if(null!=c)l=c.reduce((function(e,n){var o=n.opType;if(!u.has(o))throw new Error("opType:".concat(o," not exist!"));var r=u.get(o),c=Object(O.a)(Object(O.a)({controller:t},n),{},{model:e}),i=t.run("beforeOpFunction",c);return i=r(Object(O.a)(Object(O.a)({},c),{},{model:i})),i=t.run("afterOpFunction",Object(O.a)(Object(O.a)({},c),{},{model:i}))}),o);else{if(!u.has(n))throw new Error("opType:".concat(n," not exist!"));var p=u.get(n);l=t.run("beforeOpFunction",e),l=p(Object(O.a)(Object(O.a)({},e),{},{model:l})),l=t.run("afterOpFunction",Object(O.a)(Object(O.a)({},e),{},{model:l}))}mm("newModel:",l),t.change(l,i?i(l):null),t.run("afterOperation",e)},deleteRefKey:function(e){var t=e.model,n=e.topicKey,o=e.deleteRef,r=Ny(t,n);r.push(n);var c,i=Object(m.a)(r);try{for(i.s();!(c=i.n()).done;){var a=c.value;o(Yg(a)),o(Jg(a)),o(Hg(a)),o(Gg(a)),o(Ug(a)),o(Wg(a)),o(Zg(a)),o(Xg(a)),o(qg(a,"next")),o(qg(a,"prev"))}}catch(l){i.e(l)}finally{i.f()}},beforeOperation:function(e){},afterOperation:function(e){},beforeOpFunction:function(e){var t=e.controller,n=e.opType,o=e.model,r=e.topicKey;return n===jy&&r!==o.editorRootTopicKey&&t.run("deleteRefKey",e),o},afterOpFunction:function(e){return e.model},openNewModel:function(e){var t=e.model,n=e.controller,o=e.newModel;n.run("deleteRefKey",Object(O.a)(Object(O.a)({},e),{},{topicKey:t.rootTopicKey})),n.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Oy,topicKey:o.focusKey,model:o,callback:function(t){return function(){n.run("moveTopicToCenter",Object(O.a)(Object(O.a)({},e),{},{model:t,topicKey:t.focusKey}))}}}))}}}var jm=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.controller;return Object(o.createElement)(b.n,null,e.run("customizeTopicContextMenu",this.props))}}]),n}(rg),Tm=[{icon:"edit",label:hh,shortcut:"Space",rootCanUse:!0,opType:Ry},{icon:"add-sibling",label:Oh,shortcut:"Enter",opType:vy},{icon:"add-child",label:mh,shortcut:"Tab",rootCanUse:!0,opType:my},{icon:"notes",label:vh,shortcut:"Alt + D",rootCanUse:!0,opType:Ky},{icon:"delete-node",label:jh,shortcut:"Del",opType:jy},{icon:"root",label:Th,shortcut:"Alt + Shift + F",opType:Ly}];function Em(){return{renderTopicContextMenu:function(e){return Object(o.createElement)(jm,Object.assign({},e))},customizeTopicContextMenu:function(e){var t=e.topicKey,n=e.model,r=e.controller,c=t===n.editorRootTopicKey;function i(t){return function(n){t.opType&&r.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:t.opType}))}}return Tm.map((function(t){return c&&!t.rootCanUse?null:Object(o.createElement)(b.p,{key:t.label,icon:Vg(t.icon),text:HO(e,t.label),labelElement:Object(o.createElement)("kbd",null,t.shortcut),onClick:i(t)})}))}}}var km=y()("node:topic-drop-effect"),xm=d.default.svg(Ob||(Ob=Object(Ka.a)(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"]))),Sm=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).state={content:null},e}return Object(l.a)(n,[{key:"layout",value:function(){var e=this.props,t=e.getRef,n=e.model,r=e.zoomFactor,c=e.diagramState.dragDrop;if(null!=c){var i=c.targetKey,a=c.targetDir;if(km("layout",a),null!=i){var l=t("in"===a?Hg(i):qg(i,a)),u=t("svg-drop-effect"),s=t($g).bigView,p=YO(l,s,r),d=YO(u,s,r),f=p.left-d.left-3,y=p.top-d.top-3,b=p.width+6,g=p.height+6;this.setState({content:Object(o.createElement)("g",null,Object(o.createElement)("rect",{x:f,y:y,width:b,height:g,fill:"none",stroke:n.config.theme.highlightColor,strokeDasharray:"5,5",strokeWidth:2}))})}else this.setState({content:null})}else this.setState({content:null})}},{key:"render",value:function(){var e=this.props.saveRef;return Object(o.createElement)(xm,{ref:e("svg-drop-effect")},this.state.content)}}]),n}(rg),Cm=y()("plugin:drag-and-drop"),wm=d.default.div(mb||(mb=Object(Ka.a)(["\n  height: ",";\n  width: 100%;\n  margin: 5px 0px;\n"])),(function(e){return"".concat(e.height,"px")}));function Rm(){return{renderTopicDropArea:function(e){var t=e.topicKey,n=e.dropDir,r=e.saveRef,c=e.controller,i=e.model,a={onDragEnter:function(o){Cm("onDragEnter",t,n),c.run("handleTopicDragEnter",Object(O.a)(Object(O.a)({},e),{},{ev:o,dropDir:n}))},onDragLeave:function(o){Cm("onDragLeave",t,n),c.run("handleTopicDragLeave",Object(O.a)(Object(O.a)({},e),{},{ev:o,dropDir:n}))},onDragOver:function(e){e.preventDefault()},onDrop:function(o){Cm("onDrop",t,n),c.run("handleTopicDrop",Object(O.a)(Object(O.a)({},e),{},{ev:o,dropDir:n}))}};return Object(o.createElement)(wm,Object.assign({height:i.config.theme.marginV/2,ref:r(qg(t,n))},a))},renderDragAndDropEffect:function(e){Cm("renderDragAndDropEffect");var t=e.saveRef;return Object(o.createElement)(Sm,Object.assign({ref:t(nh)},e))},handleTopicDragStart:function(e){var t=e.controller;e.ev.stopPropagation(),t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Ty,focusMode:sy}))},canDrop:function(e){var t=e.srcKey,n=e.dstKey,o=e.model,r=e.dropDir;return t!==o.editorRootTopicKey&&t!==n&&By(o,t,n)!==py&&((n!==o.editorRootTopicKey||"in"===r)&&(o.getTopic(t).parentKey!==n||"in"!==r))},handleTopicDragEnter:function(e){var t=e.dropDir,n=e.topicKey,o=e.controller,r=e.model,c=e.diagramState,i=e.setDiagramState;Cm("handleTopicDragEnter:",n,t),o.run("canDrop",Object(O.a)(Object(O.a)({},e),{},{srcKey:r.focusKey,dstKey:n}))&&i(Object(O.a)(Object(O.a)({},c),{},{dragDrop:{targetKey:n,targetDir:t}}))},handleTopicDragLeave:function(e){var t=e.topicKey,n=e.dropDir,o=e.getRef,r=e.ev,c=e.diagramState,i=e.setDiagramState,a=r.nativeEvent.relatedTarget;Cm("handleTopicDragLeave:",t,n);var l=o(Hg(t));l==a||l.contains(a)||i(Object(O.a)(Object(O.a)({},c),{},{dragDrop:null}))},handleTopicDrop:function(e){Cm("handleTopicDrop");var t=e,n=t.controller,o=t.topicKey,r=t.model,c=t.diagramState,i=t.setDiagramState;e=Object(O.a)(Object(O.a)({},e),{},{srcKey:r.focusKey,dstKey:o}),i(Object(O.a)(Object(O.a)({},c),{},{dragDrop:null})),n.run("canDrop",e)&&n.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Dy}))}}}function Km(e,t,n,o){var r,c=arguments.length,i=c<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(c<3?r(i):c>3?r(t,n,i):r(t,n))||i);return c>3&&i&&Object.defineProperty(t,n,i),i}var Dm=d.default.div(vb||(vb=Object(Ka.a)(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 5px;\n"]))),Lm=d.default.div(jb||(jb=Object(Ka.a)(["\n  width: 100%;\n  height: 100%;\n  background: ",";\n"])),(function(e){return e.theme.background})),Im=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).setZoomFactor=function(e){o.dragScrollWidget.setZoomFactor(e)},o.onWheel=function(e){if(e.altKey||e.ctrlKey){var t=o.props.controller,n=t.run("getZoomFactor",o.props);(n-=e.nativeEvent.deltaY>0?.1:-.1)<.5&&(n=.5),n>4&&(n=4),t.run("setZoomFactor",Object(O.a)(Object(O.a)({},o.props),{},{zoomFactor:n}))}},o}return Object(l.a)(n,[{key:"renderHotkeys",value:function(){var e=this.props,t=e.controller,n=e.model,r=t.run("customizeHotKeys",e);if(null===r)return null;if(!(r.topicHotKeys instanceof Map&&r.globalHotKeys instanceof Map))throw new TypeError("topicHotKeys and globalHotKeys must be a Map");var c=[];return n.focusMode!==iy&&n.focusMode!==uy||r.topicHotKeys.forEach((function(e,t){c.push(Object(o.createElement)(b.j,Object.assign({key:t},e,{global:!0})))})),r.globalHotKeys.forEach((function(e,t){c.push(Object(o.createElement)(b.j,Object.assign({key:t},e,{global:!0})))})),Object(o.createElement)(b.k,null,c)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.getRef,n=e.model;e.controller.run("addZoomFactorChangeEventListener",Object(O.a)(Object(O.a)({},this.props),{},{listener:this.setZoomFactor}));var o=t(Zg(n.editorRootTopicKey)),r=t("node-layer"),c=o.getBoundingClientRect(),i=r.getBoundingClientRect();this.dragScrollWidget.setViewBoxScrollDelta(0,c.top-i.top-this.dragScrollWidget.viewBox.getBoundingClientRect().height/2+c.height),this.layout()}},{key:"componentWillUnmount",value:function(){this.props.controller.run("removeZoomFactorChangeEventListener",Object(O.a)(Object(O.a)({},this.props),{},{listener:this.setZoomFactor}))}},{key:"dragScrollWidget",get:function(){return this.props.getRef($g)}},{key:"componentDidUpdate",value:function(){this.props.controller.run("fireEvent",Object(O.a)(Object(O.a)({},this.props),{},{key:oh})),this.layout()}},{key:"layout",value:function(){this.props.controller.run("layout",this.props)}},{key:"render",value:function(){var e=this,t=this.props,n=t.saveRef,r=t.model,c=t.controller,i=r.editorRootTopicKey;return Object(o.createElement)(Lm,{onWheel:this.onWheel},Object(o.createElement)(lg,Object.assign({},this.state,{enableMouseWheel:!1,zoomFactor:r.zoomFactor,ref:n($g)}),(function(t,r){var a=Object(O.a)(Object(O.a)({},e.props),{},{topicKey:i,setViewBoxScroll:t,setViewBoxScrollDelta:r});return Object(o.createElement)(Dm,{ref:n("node-layer")},c.run("renderRootWidget",a))})))}}]),n}(o.PureComponent);Im=Km([b.l],Im);var _m=d.default.div(Tb||(Tb=Object(Ka.a)(["\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: 100%;\n"]))),Mm=d.default.div(Eb||(Eb=Object(Ka.a)(["\n  width: 100%;\n  //height: 100%;\n  overflow: auto;\n  flex-grow: 1;\n  background: ",";\n  position: relative;\n"])),(function(e){return e.theme.background}));function Am(e){var t=e.controller,n=e.saveRef,r=Object(o.useState)(t.run("getInitialDiagramState",e)),c=Object(Ca.a)(r,2),i=c[0],a=c[1],l=Object(O.a)(Object(O.a)({},e),{},{diagramState:i,setDiagramState:a});return Object(o.createElement)(_m,null,t.run("renderToolbar",e),Object(o.createElement)(Mm,{ref:n(Qg)},Object(o.createElement)(Im,Object.assign({},l)),t.run("renderDiagramCustomize",l)))}var Fm=Object(d.default)(vg)(kb||(kb=Object(Ka.a)(["\n  position: absolute;\n  width: 20%;\n  padding: 0 5px;\n  background: white;\n  left: 30px;\n  top: 20px;\n  border-radius: 2px;\n"]))),Pm=d.default.div(xb||(xb=Object(Ka.a)(["\n  max-width: 600px;\n"]))),Nm=d.default.span(Sb||(Sb=Object(Ka.a)([""]))),Bm=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).setEditorRootTopicKey=function(e){return function(){var t=r.props,n=t.model,o=t.controller;n.editorRootTopicKey!==e&&o.run("operation",Object(O.a)(Object(O.a)({},r.props),{},{opType:Ly,topicKey:e}))}},r.breadcrumbRenderer=function(e){var t=e.text,n=Object(wa.a)(e,og),r=t.length>8,c=r?t.substr(0,8)+"...":t,i={content:Object(o.createElement)(Pm,null,t),position:b.u.BOTTOM_RIGHT},a=Object(o.createElement)(b.b,Object.assign({},n),Object(o.createElement)(Nm,null,c));return r?Object(o.createElement)(b.x,Object.assign({},i),a):a},r}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.model,n=e.controller,r=e.zIndex,c=t.editorRootTopicKey;if(c===t.rootTopicKey)return null;for(var i=[],a=t.getTopic(c);null!=a;){var l=n.getValue(ih,Object(O.a)(Object(O.a)({},e),{},{topicKey:a.key}));i.unshift({text:l,onClick:this.setEditorRootTopicKey(a.key)}),a=t.getTopic(a.parentKey)}var u={items:i,breadcrumbRenderer:this.breadcrumbRenderer};return Object(o.createElement)(Fm,{zIndex:r},Object(o.createElement)(b.c,Object.assign({},u)))}}]),n}(rg),zm=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).handleClose=function(){var t=e.props.controller.run("handleActiveModalClose",e.props);t&&t()},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.controller,t=e.run("renderModal",this.props),n=e.run("getActiveModalProps",this.props);return Object(o.createElement)(b.g,{onClose:this.handleClose,isOpen:null!==t,autoFocus:!0,enforceFocus:!0,usePortal:!0,title:n&&n.title,style:n&&n.style},Object(o.createElement)("div",{className:g.a.DIALOG_BODY,style:{minHeight:0}},t))}}]),n}(rg),Vm=d.default.svg(Cb||(Cb=Object(Ka.a)(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"]))),Hm=y()("node:root-sub-links"),Gm=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).state={curves:[]},e}return Object(l.a)(n,[{key:"layout",value:function(){var e,t,n,r=this.props,c=r.model,i=r.getRef,a=r.topicKey,l=r.zoomFactor,u=r.controller,s=c.getTopic(a),p=i(Hg(a)),d=i(Jg(a)),f=i($g).bigView,y=YO(p,f,l),b=YO(d,f,l);e={x:(n=y,(n.left+n.right)/2-b.left),y:GO(y)-b.top};var g=[];s.subKeys.forEach((function(n){var c,a=u.run("getLinkStyle",Object(O.a)(Object(O.a)({},r),{},{topicKey:n})),s=a.lineType,p=YO(i(Hg(n)),f,l);if(t={x:(t=p.left>y.right?{x:p.left,y:GO(p)}:{x:p.right,y:GO(p)}).x-b.left,y:t.y-b.top},"curve"===s)c="M ".concat(e.x," ").concat(e.y," C ").concat(e.x," ").concat(WO(e,t)," ").concat(UO(e,t)," ").concat(t.y," ").concat(t.x," ").concat(t.y);else if("line"===s)c="M ".concat(e.x," ").concat(e.y," L ").concat(t.x," ").concat(t.y);else if("round"===s){var d=t.y>e.y?1:-1,h=t.x>e.x?1:-1,m=a.lineRadius;if(null==m)throw new Error("link line type is round, but lineRadius is not provided!");c=t.y===e.y?"M ".concat(e.x," ").concat(e.y," H ").concat(t.x):"M ".concat(e.x," ").concat(e.y,"  V ").concat(t.y-d*m," A ").concat(m," ").concat(m," 0 0 ").concat(d*h===1?0:1," ").concat(e.x+m*h," ").concat(t.y," H ").concat(t.x)}g.push(Object(o.createElement)("path",{key:"link-".concat(n),d:c,strokeWidth:a.lineWidth,stroke:a.lineColor,fill:"none"}))})),this.setState({curves:g})}},{key:"render",value:function(){Hm("render");var e=this.props,t=e.topicKey,n=e.saveRef;return Object(o.createElement)(Vm,{ref:n(Jg(t))},Object(o.createElement)("g",null,this.state.curves))}}]),n}(rg),Um=y()("RootNode"),Wm=d.default.div(wb||(wb=Object(Ka.a)(["\n  display: flex;\n  position: relative;\n\n  align-items: ",";\n  flex-direction: column;\n\n  padding: ",";\n"])),(function(e){return e.topicDirection===$f?"flex-end":"flex-start"}),(function(e){return e.topicDirection===$f?"15px 60px 15px 0px":"15px 0px 15px 60px"})),Zm=d.default.div(Rb||(Rb=Object(Ka.a)(["\n  display: flex;\n  position: relative;\n  align-items: center;\n  z-index: 3;\n"]))),Ym=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"renderPartTopics",value:function(e,t){var n=this.props,r=n.controller,c=n.saveRef,i=r.run("createSubTopics",Object(O.a)(Object(O.a)({},this.props),{},{dir:t,isRoot:!0,topics:e}));if(!i)return null;var a=i.subTopics,l="bm-layer-".concat(t===$f?"left":"right");return Object(o.createElement)(Wm,{topicDirection:t,ref:c(l)},a)}},{key:"render",value:function(){Um("render");var e=this.props,t=e.model,n=e.topicKey,r=e.saveRef,c=e.controller,i=c.run("getTopicContentStyle",e),a=t.config,l=c.run("renderTopicContent",Object(O.a)(Object(O.a)({},e),{},{topicStyle:i,dir:ty})),u=c.run("getPartTopics",{layout:a.layoutDir,model:t,topicKey:n}),s=Object(o.createElement)(Zm,{ref:r(Zg(n))},l),p=c.run("renderRootWidgetOtherChildren",e);switch(a.layoutDir){case qf.LEFT_AND_RIGHT:return Object(o.createElement)(o.Fragment,null,this.renderPartTopics(u.L,"L"),s,this.renderPartTopics(u.R,"R"),p);case qf.LEFT_TO_RIGHT:return Object(o.createElement)(o.Fragment,null,s,this.renderPartTopics(u.R,"R"),p);case qf.RIGHT_TO_LEFT:return Object(o.createElement)(o.Fragment,null,this.renderPartTopics(u.L,"L"),s,p);case qf.TOP_TO_BOTTOM:return Object(o.createElement)(o.Fragment,null,s,this.renderPartTopics(u.B,"B"),p)}return null}}]),n}(o.Component),Jm=d.default.div(Kb||(Kb=Object(Ka.a)(["\n  position: absolute;\n  top: calc(50% - 10px);\n  ",";\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  //@ts-ignore\n  background: ",";\n  cursor: pointer;\n  padding: 0;\n  font-size: 14px;\n  line-height: 20px;\n  border: 0;\n  z-index: 2;\n"])),(function(e){var t=e.dir;return t===ey?Object(d.css)(Db||(Db=Object(Ka.a)(["\n        right: -25px;\n      "]))):t===$f?Object(d.css)(Lb||(Lb=Object(Ka.a)(["\n        left: -25px;\n      "]))):void 0}),(function(e){return e.background}));function Xm(e){var t=e.model,n=e.topicKey,r=e.topicStyle,c=e.dir,i=e.saveRef,a=e.onClickCollapse,l=t.getTopic(n);return l.subKeys.size>0?Object(o.createElement)(Jm,{ref:i(Xg(n)),onClick:a,background:r.background,dir:c,className:nt()(Object(Sa.a)({icon:!0,iconfont:!0},"bm-".concat(l.collapse?"plus":"minus"),!0))}):null}var qm=y()("node:topic-content2"),Qm=d.default.div(Ib||(Ib=Object(Ka.a)(["\n  position: relative;\n"]))),$m=d.default.div(_b||(_b=Object(Ka.a)(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: auto;\n  z-index: 10;\n  color: black;\n"]))),ev=function(e){qm("cancelEvent"),e.preventDefault(),e.stopPropagation()};function tv(e){var t,n=e.controller,r=e.model,c=e.topicKey,i=e.getRef,a=r.editingContentKey!==c,l=n.run("renderTopicContentEditor",Object(O.a)(Object(O.a)({},e),{},{readOnly:a}));if(a)t=l;else{var u,s={width:50,height:40},d=i("content-editor-".concat(c));d&&(s=d.getBoundingClientRect());var f=new p.a((function(e,t){var n=e[0].contentRect;u.style.left=(s.width-n.width)/2+"px",u.style.top=(s.height-n.height)/2+"px"}));qm(s),t=Object(o.createElement)(o.Fragment,null,Object(o.createElement)("div",{style:{width:s.width,height:s.height}}),Object(o.createElement)($m,{ref:function(e){e&&(u=e,f.observe(u))}},l))}return Object(o.createElement)(Qm,{onDragEnter:ev,onDragOver:ev},t)}var nv=y()("node:topic-content-widget"),ov=d.default.div(Mb||(Mb=Object(Ka.a)(["\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  //overflow: hidden;\n  position: relative;\n"]))),rv=d.default.div(Ab||(Ab=Object(Ka.a)(["\n  position: relative;\n"]))),cv=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).onDragStart=function(e){o.run("handleTopicDragStart",Object(O.a)(Object(O.a)({},o.props),{},{ev:e}))},o.onDragOver=function(e){e.preventDefault()},o.onDragEnter=function(e){nv("onDragEnter",o.props.topicKey),o.run("handleTopicDragEnter",Object(O.a)(Object(O.a)({},o.props),{},{ev:e,dropDir:"in"}))},o.onDragLeave=function(e){o.run("handleTopicDragLeave",Object(O.a)(Object(O.a)({},o.props),{},{ev:e,dropDir:"in"}))},o.onDrop=function(e){nv("onDrop"),o.run("handleTopicDrop",Object(O.a)(Object(O.a)({},o.props),{},{ev:e,dropDir:"in"}))},o.onClick=function(e){var t=o.props.controller;o.handleTopicClickTimeout=setTimeout((function(){t.run("handleTopicClick",Object(O.a)(Object(O.a)({},o.props),{},{ev:e}))}),200)},o.onDoubleClick=function(e){clearTimeout(o.handleTopicClickTimeout),o.props.controller.run("handleTopicDoubleClick",Object(O.a)(Object(O.a)({},o.props),{},{ev:e}))},o.needRelocation=!1,o.onClickCollapse=function(e){e.stopPropagation();var t=o.props,n=t.topicKey,r=t.getRef;o.needRelocation=!0;var c=r(Xg(n)).getBoundingClientRect();nv("oldRect",c),o.oldCollapseIconVector=[c.left+c.width/2,c.top+c.height/2],nv("oldCollapseIconVector",o.oldCollapseIconVector),o.operation(by,o.props)},o.state={dragEnter:!1},o}return Object(l.a)(n,[{key:"renderContextMenu",value:function(){var e=this.props.controller;if(e.getValue(ch,Object(O.a)({},this.props)))return this.operation(Ty,Object(O.a)(Object(O.a)({},this.props),{},{focusMode:uy})),e.run("renderTopicContextMenu",this.props)}},{key:"onContextMenuClose",value:function(){}},{key:"componentDidUpdate",value:function(){if(this.needRelocation){var e=this.props,t=e.getRef,n=e.topicKey,o=e.setViewBoxScrollDelta,r=t(Xg(n)).getBoundingClientRect(),c=[r.left+r.width/2,r.top+r.height/2];nv("newVector:",c),nv("oldVector:",this.oldCollapseIconVector);var i=[c[0]-this.oldCollapseIconVector[0],c[1]-this.oldCollapseIconVector[1]];nv("vector",i),o(i[0],i[1]),this.needRelocation=!1}}},{key:"render",value:function(){var e=this.props,t=e.saveRef,n=e.topicKey,r=e.model,c=e.controller,i=e.topicStyle,a=e.dir;nv("render",n,r.focusMode);var l=c.run("isOperationEnabled",e)&&r.editingContentKey!==n,u=c.run("renderTopicCollapseIcon",Object(O.a)(Object(O.a)({},e),{},{onClickCollapse:this.onClickCollapse.bind(this)})),s=c.run("renderTopicDropArea",Object(O.a)(Object(O.a)({},e),{},{dropDir:"prev"})),p=c.run("renderTopicDropArea",Object(O.a)(Object(O.a)({},e),{},{dropDir:"next"})),d={onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDragOver:this.onDragOver,onDrop:this.onDrop};return Object(o.createElement)(rv,null,s,Object(o.createElement)(ov,Object.assign({style:i,draggable:l,ref:t(Hg(n)),onDragStart:this.onDragStart,onClick:this.onClick,onDoubleClick:this.onDoubleClick},d),c.run("renderTopicBlocks",e),c.run("renderTopicContentOthers",e)),p,a!==ty&&u)}}]),n}(rg);cv=Km([b.f],cv);var iv=y()("node:topic-desc"),av=d.default.div(Fb||(Fb=Object(Ka.a)(["\n  overflow: auto;\n"])));function lv(e){var t=e.controller,n=e.model,r=e.topicKey,c=e.getRef,i=n.editingDescKey===r;iv("isEditing",i);var a=n.getTopic(r).getBlock(cy);if(!i&&t.run("isBlockEmpty",Object(O.a)(Object(O.a)({},e),{},{block:a.block})))return null;var l=t.run("renderTopicDescEditor",e),u=c(Qg),s={maxWidth:"800px",maxHeight:"600px"};if(u){var p=u.getBoundingClientRect();s.maxWidth="".concat(.6*p.width,"px"),s.maxHeight="".concat(.8*p.height,"px")}var d={autoFocus:!1,content:Object(o.createElement)(av,{onClick:BO,classname:g.a.POPOVER_DISMISS,style:s},l),target:Object(o.createElement)(mg,{onClick:function(n){n.stopPropagation(),t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Ky}))},className:zg(Ig),tabIndex:-1}),interactionKind:b.t.HOVER,hoverOpenDelay:500};return a.block&&Object(o.createElement)(b.s,Object.assign({},d))}var uv=d.default.svg(Pb||(Pb=Object(Ka.a)(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"]))),sv=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).state={content:null},e}return Object(l.a)(n,[{key:"layout",value:function(){var e=this.props,t=e.getRef,n=e.model,r=e.zoomFactor,c=n.focusKey,i=n.focusMode;if(c&&i!==ay){var a=t(Hg(c)),l=t($g).bigView,u=t(eh),s=YO(a,l,r),p=YO(u,l,r),d=s.left-p.left-3,f=s.top-p.top-3,y=s.width+6,b=s.height+6;this.setState({content:Object(o.createElement)("rect",{x:d,y:f,width:y,height:b,fill:"none",stroke:n.config.theme.highlightColor,strokeWidth:2})})}else this.setState({content:null})}},{key:"render",value:function(){var e=this.props.saveRef;return Object(o.createElement)(uv,{ref:e(eh)},this.state.content)}}]),n}(rg),pv=d.default.svg(Nb||(Nb=Object(Ka.a)(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"]))),dv=y()("node:topic-sub-links"),fv=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).state={curves:[]},e}return Object(l.a)(n,[{key:"layout",value:function(){var e,t,n,r=this.props,c=r.model,i=r.getRef,a=r.topicKey,l=r.dir,u=r.controller,s=u.run("getZoomFactor",r),p=c.getTopic(a),d=i(Hg(a)),f=i(Jg(a)),y=i(Xg(a)),b=i($g).bigView,g=YO(f,b,s),h=YO(y,b,s),m=YO(d,b,s);dv(a),dv("svgRect",g),dv("collapseRect",h),dv("contentRect",m),l===ey?(e={x:0,y:GO(m)-g.top},t={x:h.right-g.left+10,y:e.y}):l===$f&&(e={x:g.right-g.left,y:GO(m)-g.top},t={x:h.left-g.left-10,y:e.y});var v=[];p.subKeys.forEach((function(c){var a,d=u.run("getLinkStyle",Object(O.a)(Object(O.a)({},r),{},{topicKey:c})),f=i(Hg(c));if(f){var y=YO(f,b,s);l===ey&&(n={x:y.left-g.left,y:GO(y)-g.top}),l===$f&&(n={x:y.right-g.left,y:GO(y)-g.top});var h=d.lineType;if("curve"===h)a="M ".concat(e.x," ").concat(e.y," L ").concat(t.x," ").concat(t.y," C ").concat(t.x," ").concat(WO(t,n)," ").concat(UO(t,n)," ").concat(n.y," ").concat(n.x," ").concat(n.y);else if("round"===h){var m=n.y>e.y?1:-1,j=n.x>e.x?1:-1,T=d.lineRadius;a=1===p.subKeys.size||Math.abs(n.y-e.y)<=1?"M ".concat(e.x," ").concat(e.y," L ").concat(n.x," ").concat(n.y):"M ".concat(e.x," ").concat(e.y," H ").concat(t.x," V ").concat(n.y-m*T," A ").concat(T," ").concat(T," 0 0 ").concat(m*j===1?0:1," ").concat(t.x+T*j," ").concat(n.y," H ").concat(n.x)}else"line"===h&&(a="M ".concat(e.x," ").concat(e.y," H ").concat(t.x," L ").concat(n.x," ").concat(n.y));v.push(Object(o.createElement)("path",{key:"link-".concat(c),d:a,strokeWidth:d.lineWidth,stroke:d.lineColor,fill:"none"}))}})),this.setState({curves:v})}},{key:"render",value:function(){var e=this.props,t=e.topicKey,n=e.saveRef;return Object(o.createElement)(pv,{ref:n(Jg(t))},Object(o.createElement)("g",null,this.state.curves))}}]),n}(rg),yv=y()("node:topic-widget"),bv=d.default.div(Bb||(Bb=Object(Ka.a)(["\n  display: flex;\n  align-items: center;\n  flex-direction: ",";\n"])),(function(e){return e.topicDirection===ey?"row":"row-reverse"})),gv=d.default.div(zb||(zb=Object(Ka.a)(["\n  position: relative;\n  padding: ",";\n"])),(function(e){return e.dir===ey?"0 0 0 ".concat(e.marginH,"px"):"0 ".concat(e.marginH,"px 0 0")})),hv=d.default.div(Vb||(Vb=Object(Ka.a)(["\n  display: flex;\n  position: relative;\n  align-items: center;\n\n  flex-direction: ",";\n"])),(function(e){return e.topicDirection===ey?"row":"row-reverse"})),Ov=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"renderSubTopics",value:function(){var e=this.props,t=e.controller,n=e.model,r=e.topicKey,c=e.dir,i=n.getTopic(r).subKeys.toArray(),a=t.run("createSubTopics",Object(O.a)(Object(O.a)({},e),{},{topics:i}));if(!a)return null;var l=a.subTopics,u=t.run("renderSubLinks",e);return Object(o.createElement)(gv,{dir:c,marginH:n.config.theme.marginH},l," ",u)}},{key:"layoutLinks",value:function(){var e=this.props,t=e.getRef,n=e.topicKey,o=e.model.getTopic(n);if(0!==o.subKeys.size&&!o.collapse){yv("layoutLinks",n);var r=t(Yg(n));r&&r.layout()}}},{key:"render",value:function(){var e=this.props,t=e.controller,n=e.topicKey,r=e.dir,c=e.saveRef;yv("render",n);var i=t.run("getTopicContentStyle",e),a=Object(O.a)(Object(O.a)({},e),{},{topicStyle:i}),l=t.run("renderTopicContent",a);return Object(o.createElement)(bv,{topicDirection:r},Object(o.createElement)(hv,{topicDirection:r,ref:c(Zg(n))},l),this.renderSubTopics())}}]),n}(o.Component),mv=y()("node:view-port-viewer"),vv=Object(d.default)(vg)(Hb||(Hb=Object(Ka.a)(["\n  position: absolute;\n  background: white;\n  right: 30px;\n  bottom: 20px;\n  border-radius: 2px;\n  display: flex;\n  flex-direction: row;\n  user-select: none;\n"]))),jv=Object(d.default)(bg)(Gb||(Gb=Object(Ka.a)(["\n  margin: 10px;\n"]))),Tv=d.default.span(Ub||(Ub=Object(Ka.a)(["\n  display: inline-block;\n  width: 80px;\n  height: 18px;\n"]))),Ev=function(e){return Object(o.createElement)(b.x,{content:e.tooltip,position:h.a.TOP,className:g.a.ICON},Object(o.createElement)(jv,{onClick:e.onClick,tabIndex:-1},e.children))},kv=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).zoomFactorChange=function(e){mv("zoomFactorChange",e),o.setState({zoomFactor:e})},o.onClickResetZoom=function(e){var t=o.props;t.controller.run("setZoomFactor",Object(O.a)(Object(O.a)({},t),{},{zoomFactor:1}))},o.onClickAddZoom=function(e){var t=o.props,n=t.controller,r=n.run("getZoomFactor",t);n.run("setZoomFactor",Object(O.a)(Object(O.a)({},t),{},{zoomFactor:r+.1}))},o.onClickMinusZoom=function(e){var t=o.props,n=t.controller,r=n.run("getZoomFactor",t);n.run("setZoomFactor",Object(O.a)(Object(O.a)({},t),{},{zoomFactor:r-.1}))},o.onClickCollapseAll=function(e){var t=o.props,n=t.controller;n.run("addEventListener",Object(O.a)(Object(O.a)({},t),{},{key:oh,listener:o.centerRootTopic,once:!0})),n.run("operation",Object(O.a)(Object(O.a)({},t),{},{opType:gy}))},o.onClickExpandAll=function(e){var t=o.props,n=t.controller;n.run("addEventListener",Object(O.a)(Object(O.a)({},t),{},{key:oh,listener:o.centerRootTopic,once:!0})),n.run("operation",Object(O.a)(Object(O.a)({},t),{},{opType:hy}))},o.centerRootTopic=function(){var e=o.props,t=e.model;e.controller.run("moveTopicToCenter",Object(O.a)(Object(O.a)({},o.props),{},{topicKey:t.editorRootTopicKey}))},o}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this.props;e.controller.run("addZoomFactorChangeEventListener",Object(O.a)(Object(O.a)({},e),{},{listener:this.zoomFactorChange}))}},{key:"componentWillUnmount",value:function(){var e=this.props;e.controller.run("removeZoomFactorChangeEventListener",Object(O.a)(Object(O.a)({},e),{},{listener:this.zoomFactorChange}))}},{key:"render",value:function(){mv("render");var e=this.props,t=e.controller,n=e.zIndex,r=t.run("getZoomFactor",e);return Object(o.createElement)(vv,{zIndex:n},Object(o.createElement)(Ev,{onClick:this.onClickCollapseAll,tooltip:HO(e,mO)},Vg(Ag)),Object(o.createElement)(Ev,{onClick:this.onClickExpandAll,tooltip:HO(e,vO)},Vg(Fg)),Object(o.createElement)(Ev,{onClick:this.centerRootTopic,tooltip:HO(e,jO)},Vg(Pg)),Object(o.createElement)(Ev,{onClick:this.onClickMinusZoom,tooltip:HO(e,EO)},Vg(Mg)),Object(o.createElement)(Ev,{onClick:this.onClickResetZoom,tooltip:HO(e,xO)},Object(o.createElement)(Tv,null,"".concat(HO(e,TO),":").concat(Math.floor(100*r),"%"))),Object(o.createElement)(Ev,{onClick:this.onClickAddZoom,tooltip:HO(e,kO)},Vg(_g)))}}]),n}(rg),xv=d.default.div(Wb||(Wb=Object(Ka.a)(["\n  overflow: auto;\n  padding: 0px 0px 0px 20px;\n  background: #88888850;\n"])));function Sv(e){var t=e.controller,n=e.model,r=e.topicKey;if(n.focusMode===ly){var c=t.run("renderTopicDescEditor",e);return Object(o.createElement)(b.i,{key:"drawer",title:HO(e,vh),icon:Vg("note"),isOpen:!0,hasBackdrop:!0,backdropProps:{onMouseDown:BO},isCloseButtonShown:!1,onClose:function(n){n.stopPropagation();var o="topic-desc-data-".concat(r),c=t.run("deleteTempValue",{key:o});t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Cy,topicKey:r,blockType:cy,data:c,focusMode:iy}))},size:"70%"},Object(o.createElement)(xv,null,c))}}function Cv(e){var t=e.theme,n=e.children;return Object(o.createElement)(d.ThemeProvider,{theme:t},Object(o.createElement)(o.Fragment,null,n))}var wv=y()("plugin:rendering");function Rv(){var e;return{getDiagramProps:function(){return e},renderDiagram:function(t){var n=t.model;return Object(o.createElement)(sg,null,(function(r,c,i){return e=Object(O.a)(Object(O.a)({},t),{},{saveRef:r,getRef:c,deleteRef:i}),wv("renderDiagram",n),Object(o.createElement)(Cv,{theme:n.config.theme},Object(o.createElement)(Am,e))}))},renderDrawer:Sv,getInitialDiagramState:function(e){return{rightTopPanel:{isOpen:!1,selectedTabId:"topic-style"}}},renderDiagramCustomize:function(e){var t=e.controller,n=e.model,o=t.getValue(rh),r=Object(O.a)(Object(O.a)({},e),{},{zIndex:o,topicKey:n.focusKey});return[t.run("renderEditorRootBreadcrumbs",r),t.run("renderRightTopPanel",r),t.run("renderModals",Object(O.a)(Object(O.a)({},r),{},{zIndex:o+1})),t.run("renderDrawer",Object(O.a)(Object(O.a)({},r),{},{zIndex:o+1})),t.run("renderViewPortViewer",r)]},renderEditorRootBreadcrumbs:function(e){return Object(o.createElement)(Bm,Object.assign({key:"EditorRootBreadcrumbs"},e))},renderModals:function(e){return Object(o.createElement)(zm,Object.assign({key:"modals"},e))},renderModal:function(e){return null},getActiveModalProps:function(e){return null},renderDoc:function(e){return e.children},renderRootWidget:function(e){return Object(o.createElement)(Ym,Object.assign({},e))},renderTopicWidget:function(e){return Object(o.createElement)(Ov,Object.assign({},e))},renderTopicContent:function(e){return Object(o.createElement)(cv,Object.assign({},e))},renderTopicCollapseIcon:function(e){return Object(o.createElement)(Xm,Object.assign({},e))},renderTopicContentOthers:function(e){return[]},renderTopicBlocks:function(e){var t=e.model,n=e.topicKey,r=e.controller,c=t.getTopic(n).blocks,i=[],a=0;return c.forEach((function(t){var n=r.run("renderTopicBlock",Object(O.a)(Object(O.a)({},e),{},{block:t,blockKey:"block-".concat(a)}));n&&(i.push(Object(o.createElement)(o.Fragment,{key:"block-".concat(a)},n)),a++)})),i},renderTopicBlock:function(e){var t=e.controller;switch(e.block.type){case ry:return t.run("renderTopicBlockContent",e);case cy:return t.run("renderTopicBlockDesc",e)}return null},renderTopicBlockContent:function(e){return Object(o.createElement)(tv,Object.assign({},e))},renderTopicBlockDesc:function(e){return Object(o.createElement)(lv,Object.assign({},e))},renderSubLinks:function(e){var t=e.saveRef,n=e.topicKey,r=e.model.getTopic(n);return 0===r.subKeys.size||r.collapse?null:Object(o.createElement)(fv,Object.assign({ref:t(Yg(n))},e))},renderRootSubLinks:function(e){var t=e.saveRef,n=e.topicKey;return Object(o.createElement)(Gm,Object.assign({ref:t(Yg(n))},e))},renderFocusItemHighlight:function(e){var t=e.saveRef;return Object(o.createElement)(sv,Object.assign({ref:t(th)},e))},renderRootWidgetOtherChildren:function(e){var t=e.controller,n=t.run("getZoomFactor",e);return e=Object(O.a)(Object(O.a)({},e),{},{zoomFactor:n}),Object(o.createElement)(o.Fragment,null,t.run("renderRootSubLinks",e),t.run("renderFocusItemHighlight",e),t.run("renderDragAndDropEffect",e))},renderViewPortViewer:function(e){return Object(o.createElement)(kv,Object.assign({key:"view-port-viewer"},e))}}}var Kv=Object(d.default)(vg)(Zb||(Zb=Object(Ka.a)(["\n  position: absolute;\n  background: white;\n  right: 30px;\n  top: 20px;\n  border-radius: 2px;\n  user-select: none;\n"]))),Dv=Object(d.default)(b.w)(Yb||(Yb=Object(Ka.a)(["\n  padding: 0px 10px;\n"])));function Lv(e){var t=e.controller,n=e.zIndex,r=e.diagramState,c=e.setDiagramState,i=r.rightTopPanel,a=i.isOpen,l=i.selectedTabId,u=function(e){c(Object(O.a)(Object(O.a)({},r),{},{rightTopPanel:Object(O.a)(Object(O.a)({},i),e)}))};if(!a)return Object(o.createElement)(Kv,{zIndex:n},Object(o.createElement)(yg,{onClick:function(){u({isOpen:!0})}},Object(o.createElement)(fg,{className:zg(Kg)})));return Object(o.createElement)(Kv,{zIndex:n},Object(o.createElement)(Og,null,Object(o.createElement)(hg,{className:zg(Dg),onClick:function(){u({isOpen:!1})}})),Object(o.createElement)(Dv,{id:"tabs",selectedTabId:l,onChange:function(e){u({selectedTabId:e})}},t.run("renderRightTopPanelTabs",e)))}var Iv=Object(v.a)(Array(7).keys()),_v=[0,5,10,15,20,25,30,35],Mv=["none","solid","dotted","dashed","double"];function Av(e){var t=e.contentStyle,n=e.setContentStyle;return Object(o.createElement)(XO,null,Object(o.createElement)(Eg,null,HO(e,tO)),Object(o.createElement)(Cg,null,Object(o.createElement)(tm,{text:"".concat(HO(e,nO),": ").concat(t.borderWidth?t.borderWidth:HO(e,dh)),items:Iv,itemRenderer:nm("px"),onItemSelect:function(e){n({borderWidth:"".concat(e,"px")})}}),Object(o.createElement)(tm,{text:"".concat(HO(e,Sh),": ").concat(t.borderStyle?HO(e,t.borderStyle):HO(e,pO)),items:Mv,itemRenderer:om(e),onItemSelect:function(e){n({borderStyle:e})}}),Object(o.createElement)(tm,{text:"".concat(HO(e,oO),": ").concat(t.borderRadius),items:_v,itemRenderer:nm("px"),onItemSelect:function(e){n({borderRadius:"".concat(e,"px")})}}),Object(o.createElement)(qO,{color:t.borderColor,handleColorChange:function(e){n({borderColor:e})}})))}var Fv=["curve","round","line"];function Pv(e){var t=e.showLinkStyle,n=void 0===t||t,r=e.showSubLinkStyle,c=void 0===r||r,i=e.linkStyle,a=void 0===i?{}:i,l=e.subLinkStyle,u=void 0===l?{}:l,s=e.setLinkStyle,p=e.setSubLinkStyle;return Object(o.createElement)(XO,null,Object(o.createElement)(Eg,null,HO(e,wh)),n&&Object(o.createElement)(Cg,{alignItems:"center"},Object(o.createElement)(dg,{margin:"0 5px 0 0"},HO(e,Rh)+":"," "),Object(o.createElement)(tm,{text:"".concat(HO(e,nO),": ").concat(a?a.lineWidth:"0px"),items:rm,itemRenderer:nm("px"),onItemSelect:function(e){s({lineWidth:"".concat(e,"px")})}}),Object(o.createElement)(tm,{text:"".concat(HO(e,Mh),": ").concat(HO(e,a.lineType)),items:Fv,itemRenderer:om(e),onItemSelect:function(e){s({lineType:e})}}),Object(o.createElement)(qO,{color:a.lineColor,handleColorChange:function(e){s({lineColor:e})}})),c&&Object(o.createElement)(Cg,{alignItems:"center"},Object(o.createElement)(dg,{margin:"0 5px 0 0"},HO(e,Kh)+": "),Object(o.createElement)(tm,{text:"".concat(HO(e,nO),": ").concat(u?u.lineWidth:"0px"),items:rm,itemRenderer:nm("px"),onItemSelect:function(e){p({lineWidth:"".concat(e,"px")})}}),Object(o.createElement)(tm,{text:"".concat(HO(e,Mh),": ").concat(HO(e,u.lineType)),items:Fv,itemRenderer:om(e),onItemSelect:function(e){p({lineType:e})}}),Object(o.createElement)(qO,{color:u.lineColor,handleColorChange:function(e){p({lineColor:e})}})))}function Nv(e){var t=e.contentStyle,n=e.setContentStyle,r={title:"".concat(HO(e,rO),":"),min:12,max:100,value:parseInt(t.fontSize),style:{width:50},onValueChange:function(e){n({fontSize:e})}},c={title:"".concat(HO(e,cO),":"),style:{width:50},value:t.lineHeight||"",onChange:function(e){n({lineHeight:e.target.value})}};return Object(o.createElement)(XO,null,Object(o.createElement)(Eg,null,HO(e,Ch)),Object(o.createElement)(pg,null,Object(o.createElement)($O,Object.assign({},r)),Object(o.createElement)(em,Object.assign({},c)),Object(o.createElement)(qO,{color:t.color,handleColorChange:function(e){n({color:e})}})))}var Bv,zv=y()("node:style-editor");function Vv(e){var t=e.controller,n=e.model,r=e.topicKey,c=n.getTopic(r),i=function(n){t.run("setTopicContentStyle",Object(O.a)(Object(O.a)({},e),{},{style:n}))};if(!n.focusKey)return null;var a=t.run("getTopicContentStyle",e),l=t.run("getLinkStyle",e),u=t.run("getSubLinkStyle",e),s=Object(O.a)(Object(O.a)({},e),{},{linkStyle:l,subLinkStyle:u,setLinkStyle:function(n){t.run("setLinkStyle",Object(O.a)(Object(O.a)({},e),{},{linkStyle:n}))},setSubLinkStyle:function(n){t.run("setSubLinkStyle",Object(O.a)(Object(O.a)({},e),{},{subLinkStyle:n}))}}),p=Object(O.a)(Object(O.a)({},e),{},{contentStyle:a,setContentStyle:i});return Object(o.createElement)(jg,null,Object(o.createElement)(Av,Object.assign({},p)),Object(o.createElement)(Nv,Object.assign({},p)),Object(o.createElement)(XO,null,Object(o.createElement)(Eg,null,HO(e,$h)),Object(o.createElement)(qO,{color:a.background,handleColorChange:function(e){i({background:e})}})),Object(o.createElement)(Pv,Object.assign({},s)),Object(o.createElement)(XO,null,Object(o.createElement)(QO,{title:HO(e,Ih),onClick:function(){c.style&&t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:ky,style:null}))}}),Object(o.createElement)(QO,{title:HO(e,Dh),onClick:function(){Bv=t.run("getTopicStyle",e),zv(Bv)}}),Object(o.createElement)(QO,{title:HO(e,Lh),onClick:function(){Bv&&t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:ky,style:JSON.stringify(Bv)}))}})),function(e){var t=e.controller;return Object(o.createElement)(XO,null,Object(o.createElement)(kg,null,Object(o.createElement)(b.d,{onClick:function(n){t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:xy}))}},HO(e,_h))))}(e))}var Hv=n(110);function Gv(e){var t=e.contentStyle,n=e.setContentStyle,r=Hv("padding",t.padding||"0"),c={layout:"v",min:0,max:99,style:{width:38}},i=parseInt(r["padding-top"]),a=parseInt(r["padding-right"]),l=parseInt(r["padding-bottom"]),u=parseInt(r["padding-left"]),s={top:i,right:a,bottom:l,left:u},p=function(e){return function(t){n({padding:VO(Object(O.a)(Object(O.a)({},s),{},Object(Sa.a)({},e,t)))})}},d=Object(O.a)(Object(O.a)({},c),{},{title:HO(e,aO),value:i,onValueChange:p("top")}),f=Object(O.a)(Object(O.a)({},c),{},{title:HO(e,sO),value:a,onValueChange:p("right")}),y=Object(O.a)(Object(O.a)({},c),{},{title:HO(e,lO),value:l,onValueChange:p("bottom")}),b=Object(O.a)(Object(O.a)({},c),{},{title:HO(e,uO),value:u,onValueChange:p("left")});return Object(o.createElement)(XO,null,Object(o.createElement)(Eg,null,HO(e,iO)),Object(o.createElement)(Cg,null,Object(o.createElement)($O,Object.assign({},d)),Object(o.createElement)($O,Object.assign({},f)),Object(o.createElement)($O,Object.assign({},y)),Object(o.createElement)($O,Object.assign({},b))))}var Uv=d.default.div(Jb||(Jb=Object(Ka.a)(["\n  height: 250px;\n  overflow: auto;\n"])));function Wv(e){var t=e.topicStyle,n=e.setTopicStyle,r=t.contentStyle,c=void 0===r?{}:r,i=t.linkStyle,a=void 0===i?{}:i,l=t.subLinkStyle,u=void 0===l?{}:l,s=function(e){n({contentStyle:e})},p=Object(O.a)(Object(O.a)({},e),{},{contentStyle:c,setContentStyle:s}),d=Object(O.a)(Object(O.a)({},e),{},{showLinkStyle:!1,linkStyle:a,subLinkStyle:u,setLinkStyle:function(e){n({linkStyle:e})},setSubLinkStyle:function(e){n({subLinkStyle:e})}});return Object(o.createElement)(Uv,null,Object(o.createElement)(Av,Object.assign({},p)),Object(o.createElement)(Gv,Object.assign({},p)),Object(o.createElement)(Nv,Object.assign({},p)),Object(o.createElement)(XO,null,Object(o.createElement)(Eg,null,HO(e,$h)),Object(o.createElement)(qO,{color:c.background,handleColorChange:function(e){s({background:e})}})),Object(o.createElement)(Pv,Object.assign({},d)))}y()("node:theme-editor");var Zv="normal";function Yv(e){var t,n=Object(o.useState)(!1),r=Object(Ca.a)(n,2),c=r[0],i=r[1],a=e.model,l=e.controller,u=Object(ct.cloneDeep)(a.config.theme),s=l.run("getThemeOfTopic",Object(O.a)(Object(O.a)({},e),{},{isClone:!0})),p=s.rootTopic,d=s.primaryTopic,f=s.normalTopic,y=function(t){l.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Sy,theme:t}))},g=(t=function(e){y(Object(ct.merge)(u,{randomColor:e}))},function(e){return t(e.target.checked)}),h=Object(O.a)(Object(O.a)({},e),{},{topicStyle:p,setTopicStyle:function(e){y(Object(ct.merge)(u,{rootTopic:e}))}}),m=Object(o.createElement)(Wv,Object.assign({},h)),v=Object(O.a)(Object(O.a)({},e),{},{topicStyle:d,setTopicStyle:function(e){y(Object(ct.merge)(u,{primaryTopic:e}))}}),j=Object(o.createElement)(Wv,Object.assign({},v)),T=Object(O.a)(Object(O.a)({},e),{},{topicStyle:f,setTopicStyle:function(e){y(Object(ct.merge)(u,{normalTopic:e}))}}),E=Object(o.createElement)(Wv,Object.assign({},T)),k={id:Zv,handleTabIdChange:function(e){Zv=e}},x=Object(o.createElement)(xg,null,Object(o.createElement)(b.w,Object.assign({},k),Object(o.createElement)(b.v,{id:"normal",title:HO(e,Bh),panel:E}),Object(o.createElement)(b.v,{id:"primary",title:HO(e,zh),panel:j}),Object(o.createElement)(b.v,{id:"root",title:HO(e,Vh),panel:m}))),S={isOpen:c,onClose:function(e){i(!1)}},C=Object(o.createElement)(b.a,Object.assign({},S),Object(o.createElement)("p",null,"File format error"));return Object(o.createElement)(jg,null,Object(o.createElement)(XO,null,Object(o.createElement)(Eg,null,HO(e,Fh)),Object(o.createElement)(Cg,null,Object(o.createElement)(Sg,null,HO(e,$h)+":"),Object(o.createElement)(qO,{color:u.background,handleColorChange:function(e){y(Object(ct.merge)(u,{background:e}))}}),Object(o.createElement)(Sg,null,HO(e,Ph)+":"),Object(o.createElement)(qO,{color:u.highlightColor,handleColorChange:function(e){y(Object(ct.merge)(u,{highlightColor:e}))}}),Object(o.createElement)(Sg,null,HO(e,Nh)+":"),Object(o.createElement)(gg,{checked:u.randomColor,onChange:g}))),x,Object(o.createElement)(XO,null,Object(o.createElement)(QO,{title:HO(e,Hh),onClick:function(e){zO(JSON.stringify(u),"blink-mind-theme.json")}}),Object(o.createElement)(QO,{title:HO(e,Gh),onClick:function(e){(function(e){var t=document.createElement("input");return t.type="file",t.accept=e,new Promise((function(e,n){t.addEventListener("change",(function(t){var o=t.target.files[0],r=new FileReader;r.onload=function(t){var n=t.target.result;e(n)},r.onerror=function(e){n(e.target.error)},r.readAsText(o)})),t.click()}))})(".json,.txt").then((function(e){var t,n=JSON.parse(e);null!=(t=n).name&&null!=t.background&&null!=t.highlightColor?y(n):i(!0)}))}})),C)}function Jv(){return{renderRightTopPanel:function(e){var t=Object(O.a)(Object(O.a)({},e),{},{key:"right-top-panel"});return Object(o.createElement)(Lv,Object.assign({},t))},renderRightTopPanelTabs:function(e){var t=e.controller;return[t.run("renderTopicStyleEditor",e),t.run("renderThemeEditor",e)]},renderTopicStyleEditor:function(e){var t={id:"topic-style",key:"topic-style",title:HO(e,xh),panel:Object(o.createElement)(Vv,Object.assign({},e))};return Object(o.createElement)(b.v,Object.assign({},t))},renderThemeEditor:function(e){var t={id:"theme-editor",key:"theme-editor",title:HO(e,Ah),panel:Object(o.createElement)(Yv,Object.assign({},e))};return Object(o.createElement)(b.v,Object.assign({},t))}}}var Xv=d.default.div(Xb||(Xb=Object(Ka.a)(["\n  box-shadow: rgb(170, 170, 170) 0 0 2px;\n  background: white;\n  .iconfont {\n    font-size: 28px !important;\n  }\n"])));function qv(e){var t=e.controller;return Object(o.createElement)(Xv,null,t.run("renderToolbarItems",e))}function Qv(e){var t=[[qf.LEFT_AND_RIGHT,HO(e,yh),"layout-left-and-right"],[qf.LEFT_TO_RIGHT,HO(e,gh),"layout-right"],[qf.RIGHT_TO_LEFT,HO(e,bh),"layout-left"]];return Object(o.createElement)(im,Object.assign({className:zg(Bg)},e),Object(o.createElement)(b.s,{enforceFocus:!1},Object(o.createElement)(Tg,null),Object(o.createElement)(b.n,null,t.map((function(t){return Object(o.createElement)(b.p,{key:t[1],icon:Vg(t[2]),text:t[1],onClick:(n=t[0],function(t){e.controller.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:Iy,layoutDir:n}))})});var n})))))}function $v(){return{renderToolbar:function(e){return Object(o.createElement)(qv,Object.assign({},e))},renderToolbarItems:function(e){var t=e.controller.run("customizeToolbar",e);return t.sort((function(e,t){return e.order-t.order})),t.map((function(t){return Object(o.createElement)(t.element,Object(O.a)(Object(O.a)({},e),{},{key:t.order.toString()}))}))},customizeToolbar:function(e){return[{order:100,element:Qv}]}}}var ej=y()("plugin:utils");function tj(){var e=new Map,t=new Map;return{addTempValueChangeListener:function(e){var n=e.key,o=e.listener;t.has(n)||t.set(n,[]),t.get(n).push(o)},removeTempValueChangeListener:function(e){var n=e.key,o=e.listener;t.has(n)&&(t[n]=t.get(n).filter((function(e){return e!==o})))},getTempValue:function(t){var n=t.key;return ej("getTempValue",n),e.get(n)},setTempValue:function(n){var o=n.key,r=n.value;if(ej("setTempValue",o),e.set(o,r),t.has(o)){var c,i=t.get(o),a=Object(m.a)(i);try{for(a.s();!(c=a.n()).done;){(0,c.value)(r)}}catch(l){a.e(l)}finally{a.f()}}},deleteTempValue:function(t){var n=t.key;ej("deleteTempValue",n);var o=e.get(n);return e.delete(n),o}}}function nj(){return[Rv(),tj(),Em(),Jv(),$v(),Rm()]}var oj=y()("node:text-editor"),rj=d.default.div(qb||(qb=Object(Ka.a)(["\n  padding: 6px;\n  background-color: ",";\n  cursor: ",";\n  min-width: 50px;\n"])),(function(e){return e.readOnly?null:"white"}),(function(e){return e.readOnly?"pointer":"text"})),cj=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).state={content:null},o.onMouseDown=function(e){e.stopPropagation()},o.onMouseMove=function(e){},o.onKeyDown=function(e){},o._handleClick=function(e){!o.root.contains(e.target)&&o.onClickOutSide(e)},o.rootRef=function(e){return function(t){e(t),o.root=t}},o.initState(),o}return Object(l.a)(n,[{key:"onChange",value:function(e){var t=e.value;oj("onChange",t),this.setState({content:t})}},{key:"componentDidMount",value:function(){this.props.readOnly||document.addEventListener("click",this._handleClick)}},{key:"componentWillUnmount",value:function(){this.props.readOnly||document.removeEventListener("click",this._handleClick)}},{key:"onClickOutSide",value:function(e){}},{key:"getCustomizeProps",value:function(){return null}},{key:"getContent",value:function(){var e=this.getCustomizeProps().block.data;return null==e?null:("string"===typeof e&&(e=Fe.a.deserialize(e)),e)}},{key:"initState",value:function(){var e=this.getContent();this.state={content:e}}},{key:"render",value:function(){var e=this.props,t=e.topicKey,n=e.saveRef,r=this.getCustomizeProps(),c=r.readOnly,i=r.getRefKeyFunc,a=r.placeholder,l=r.style;oj(c);var u=i(t),s=c?this.getContent():this.state.content,p=this.onMouseDown,d=this.onMouseMove,f=this.onKeyDown,y={value:s,readOnly:c,onChange:this.onChange.bind(this),placeholder:a,style:l},b={key:u,readOnly:c,ref:this.rootRef(n(u)),onMouseDown:p,onMouseMove:d,onKeyDown:f};return Object(o.createElement)(rj,Object.assign({},b),Object(o.createElement)(Pe.Editor,Object.assign({},y,{autoFocus:!0})))}}]),n}(o.PureComponent),ij=y()("node:topic-content-editor");function aj(e){return"content-editor-".concat(e)}var lj=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).onKeyDown=function(e){e.nativeEvent.ctrlKey&&"Enter"===e.nativeEvent.code&&o.save()},o}return Object(l.a)(n,[{key:"getCustomizeProps",value:function(){var e=this.props,t=e.model,n=e.topicKey,o=e.readOnly;return{block:t.getTopic(n).getBlock(ry).block,readOnly:o,getRefKeyFunc:aj,placeholder:"new",style:{whiteSpace:"pre"}}}},{key:"onClickOutSide",value:function(e){ij("onClickOutSide"),this.save()}},{key:"save",value:function(){var e=this.props,t=e.model,n=e.topicKey;t.editingContentKey!==n||this.props.controller.run("operation",Object(O.a)(Object(O.a)({},this.props),{},{opType:Cy,blockType:ry,data:this.state.content,focusMode:iy}))}}]),n}(cj),uj=y()("node:topic-desc-editor");function sj(e){return"desc-editor-".concat(e)}var pj=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),o=t.call(this,e),uj("constructor"),o}return Object(l.a)(n,[{key:"initState",value:function(){Object(ka.a)(Object(xa.a)(n.prototype),"initState",this).call(this);var e=this.props,t=e.controller,o=e.topicKey,r="topic-desc-data-".concat(o),c=this.state.content;t.run("setTempValue",{key:r,value:c})}},{key:"getCustomizeProps",value:function(){var e=this.props,t=e.model,n=e.topicKey;return{block:t.getTopic(n).getBlock(cy).block,readOnly:t.editingDescKey!==n,getRefKeyFunc:sj,placeholder:"write topic notes here"}}},{key:"onChange",value:function(e){var t=e.value;uj("onChange");var n=this.props,o=n.controller,r=n.topicKey;if(!(n.model.editingDescKey!==r)){var c="topic-desc-data-".concat(r);o.run("setTempValue",{key:c,value:t}),this.setState({content:t})}}}]),n}(cj);var dj=y()("plugin:StylePlugin");function fj(){var e=new Map,t=0;return{getTopicStyle:function(e){var t=e.controller;return{contentStyle:t.run("getTopicContentStyle",e),linkStyle:t.run("getLinkStyle",e),subLinkStyle:t.run("getSubLinkStyle",e)}},getTopicContentStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;dj("getTopicContentStyle:",t,n);var r,c=n.getTopicVisualLevel(t),i=n.config.theme;if(r=c===ny?i.rootTopic:c===oy?i.primaryTopic:i.normalTopic,r=Object(O.a)(Object(O.a)({},i.contentStyle),r.contentStyle),i.randomColor){var a=o.run("getRandomColor",e);r=Object(O.a)(Object(O.a)({},r),{},{background:a,borderColor:a,subLinkStyle:Object(O.a)(Object(O.a)({},r.subLinkStyle),{},{lineColor:a})})}var l=n.getTopic(t);if(!l.style)return r;var u=JSON.parse(l.style);return Object(O.a)(Object(O.a)({},r),u.contentStyle)},getLinkStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;dj("getLinkStyle",t);var r,c=n.getTopicVisualLevel(t),i=n.config.theme,a=i.linkStyle;r=c===ny?i.rootTopic.linkStyle:c===oy?i.primaryTopic.linkStyle:i.normalTopic.linkStyle,a=Object(O.a)(Object(O.a)({},a),r);var l=n.getTopic(t);if(null!=l.parentKey){var u=o.run("getSubLinkStyle",Object(O.a)(Object(O.a)({},e),{},{topicKey:l.parentKey}));a=Object(O.a)(Object(O.a)({},a),u)}if(!l.style)return a;var s=JSON.parse(l.style);return Object(O.a)(Object(O.a)({},a),s.linkStyle)},getSubLinkStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;dj("getLinkStyle",t);var r,c=n.getTopicVisualLevel(t),i=n.config.theme,a=i.linkStyle;r=c===ny?i.rootTopic.subLinkStyle:c===oy?i.primaryTopic.subLinkStyle:i.normalTopic.subLinkStyle,a=Object(O.a)(Object(O.a)({},a),r);var l=n.getTopic(t);if(i.randomColor){var u=o.run("getRandomColor",e);dj(u),a=Object(O.a)(Object(O.a)({},a),{},{lineColor:u})}if(!l.style)return a;var s=JSON.parse(l.style);return Object(O.a)(Object(O.a)({},a),s.subLinkStyle)},setTopicContentStyle:function(e){var t=e.topicKey,n=e.controller,o=e.style,r=e.model.getTopic(t).style,c=r?JSON.parse(r):{},i=Object(O.a)(Object(O.a)({},c),{},{contentStyle:Object(O.a)(Object(O.a)({},c.contentStyle),o)});if(!Object(ct.isEqual)(c,i)){var a=JSON.stringify(i);n.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:ky,style:a}))}},setLinkStyle:function(e){var t=e.topicKey,n=e.controller,o=e.linkStyle,r=e.model.getTopic(t).style,c=r?JSON.parse(r):{},i=Object(O.a)(Object(O.a)({},c),{},{linkStyle:Object(O.a)(Object(O.a)({},c.linkStyle),o)});if(!Object(ct.isEqual)(c,i)){var a=JSON.stringify(i);n.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:ky,style:a}))}},setSubLinkStyle:function(e){var t=e.topicKey,n=e.controller,o=e.subLinkStyle,r=e.model.getTopic(t).style,c=r?JSON.parse(r):{},i=Object(O.a)(Object(O.a)({},c),{},{subLinkStyle:Object(O.a)(Object(O.a)({},c.subLinkStyle),o)});if(!Object(ct.isEqual)(c,i)){var a=JSON.stringify(i);n.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:ky,style:a}))}},getTopicThemeStyle:function(e){var t=e.topicKey,n=e.model,o=n.getTopicVisualLevel(t),r=n.config.theme;return o===ny?r.rootTopic:o===oy?r.primaryTopic:r.normalTopic},getRandomColor:function(n){var o=n.topicKey;if(e.has(o))return e.get(o);var r=["#00CC99","#FFEE88","#A167A5","#E5F993","#F5C396","#DB995A","#83BCFF","#ED7B84","#739E82","#D3BCC0","#FFA0FD","#EFD3D7","#C6878F"],c=r[++t%r.length];return e.set(o,c),dj("getRandomColor",o,c),c}}}function yj(){return[nj(),{getPartTopics:function(e){var t=e.layout,n=e.model,o=e.topicKey,r=n.getTopic(o),c=r.subKeys.size,i=r.subKeys.toArray();switch(t){case qf.LEFT_TO_RIGHT:return{R:i};case qf.RIGHT_TO_LEFT:return{L:i};case qf.LEFT_AND_RIGHT:return{L:i.slice(Math.ceil(c/2),c),R:i.slice(0,Math.ceil(c/2))};case qf.TOP_TO_BOTTOM:return{B:i}}},createSubTopics:function(e){var t=e.model,n=e.topicKey,o=e.controller,r=e.topics,c=e.saveRef,i=t.getTopic(n);if(0===r.size||i.collapse)return null;var a=[];return r.forEach((function(t){var n=Object(O.a)(Object(O.a)({},e),{},{topicKey:t,key:t,ref:c(Wg(t))});a.push(o.run("renderTopicWidget",n))})),{subTopics:a}},layout:function(e){var t=e.getRef,n=e.model,o=t(Yg(n.editorRootTopicKey)),r=t(th),c=t(nh);o&&o.layout(),r&&r.layout(),c&&c.layout(),function e(o){if(o.key!==n.editorRootTopicKey){var r=t(Wg(o.key));r&&r.layoutLinks()}if(!o.collapse){var c,i=Object(m.a)(o.subKeys);try{for(i.s();!(c=i.n()).done;){var a=c.value;e(n.getTopic(a))}}catch(l){i.e(l)}finally{i.f()}}}(n.getTopic(n.editorRootTopicKey))},getRelativeRect:function(e){var t=e.element,n=e.controller,o=e.getRef,r=n.run("getZoomFactor",e);return YO(t,o($g).bigView,r)},getRelativeRectFromViewPort:function(e){var t=e.element,n=e.controller,o=e.getRef,r=n.run("getZoomFactor",e);return YO(t,o($g).viewBox,r)},getRelativeVectorFromViewPort:function(e){return JO(e.element,(0,e.getRef)($g).viewBox)},addZoomFactorChangeEventListener:function(e){e.controller.run("addTempValueChangeListener",Object(O.a)({key:"ZoomFactor"},e))},removeZoomFactorChangeEventListener:function(e){e.controller.run("removeTempValueChangeListener",Object(O.a)({key:"ZoomFactor"},e))},setZoomFactor:function(e){var t=e.controller,n=e.zoomFactor;return t.run("setTempValue",{key:"ZoomFactor",value:n})},getZoomFactor:function(e){return e.controller.run("getTempValue",{key:"ZoomFactor"})||1},moveTopicToCenter:function(e){var t=e.getRef,n=e.topicKey,o=e.model,r=e.moveDir,c=void 0===r?gm:r;if(o.editorRootTopicKey!==n&&By(o,n,o.editorRootTopicKey)!==dy)throw new Error("moveTopicToCenter error: topicKey ".concat(n," is not the DESCENDANT of editor root topic"));var i=t(Zg(n)),a=t($g),l=a.viewBox;if(!i||!l)throw new Error("moveTopicToCenter error: topic or viewBox is null");var u=JO(i,l);if(c===bm)a.setViewBoxScrollDelta(u[0],u[1]);else if(c===gm){var s=l.getBoundingClientRect(),p=i.getBoundingClientRect(),d=(s.width-p.width)/2;a.setViewBoxScrollDelta(u[0]+d-200,u[1])}},focusTopicAndMoveToCenter:function(e){var t=e.controller,n=e.topicKey;t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opArray:[{opType:Ty,topicKey:n,focusMode:iy},{opType:Oy,topicKey:n}],allowUndo:!1,callback:function(o){return function(){t.run("moveTopicToCenter",Object(O.a)(Object(O.a)({},e),{},{model:o,topicKey:n}))}}}))}},vm(),fj(),lm(),hm(),{getValue:function(e,t){var n=e.propKey,o=e.controller,r=e.diagramState;switch(n){case rh:return 3;case ch:case uh:return o.run("isOperationEnabled",e);case ih:return o.run("getTopicTitle",e);case ah:return r.dragDrop;case lh:return r.rightTopPanel}return t()}},{getTopicTitle:function(e){var t=e.model,n=e.controller,o=e.topicKey,r=e.maxLength,c=t.getTopic(o).getBlock(ry).block,i=n.run("serializeBlockData",Object(O.a)(Object(O.a)({},e),{},{block:c}));return null!=r&&(i=i.length>r?i.substr(0,r)+"...":i),i},renderTopicContentEditor:function(e){return Object(o.createElement)(lj,Object.assign({},e))},renderTopicDescEditor:function(e){return Object(o.createElement)(pj,Object.assign({},e))},isBlockEmpty:function(e,t){var n=e.block,o=e.controller;return n.type===ry||n.type===cy?null==n.data||""===o.run("serializeBlockData",e):t()},serializeBlockData:function(e,t){var n=e.block;return n.type===ry||n.type===cy?"string"===typeof n.data?n.data:Fe.a.serialize(n.data):t()}},{createNewModel:function(e){return Uy.createEmpty()}},{getThemeOfTopic:function(e){var t=e.model.config.theme,n=t.contentStyle,o=t.rootTopic,r=t.primaryTopic,c=t.normalTopic;return{rootTopic:Object(O.a)(Object(O.a)({},o),{},{contentStyle:Object(O.a)(Object(O.a)({},n),o.contentStyle)}),primaryTopic:Object(O.a)(Object(O.a)({},r),{},{contentStyle:Object(O.a)(Object(O.a)({},n),r.contentStyle)}),normalTopic:Object(O.a)(Object(O.a)({},c),{},{contentStyle:Object(O.a)(Object(O.a)({},n),c.contentStyle)})}}},Om()]}y()("node:Diagram"),o.Component;var bj=n(300),gj=n(30),hj=n(24),Oj=(n(854),n(42)),mj=n(77),vj=n(63),jj=function(e,t){return(jj=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function Tj(e,t){function n(){this.constructor=e}jj(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Ej=function(){return(Ej=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function kj(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function xj(e){var t=e.controller,n=e.model,r=e.topicKey,c=n.focusKey===r&&"FOCUS_MODE_EDITING_TOPOLOGY"===n.focusMode,i=n.getTopic(r).getBlock("TOPOLOGY").block;if(!c&&!i)return null;var a={className:zg("topology"),onClick:function(n){n.stopPropagation(),t.run("operation",Ej(Ej({},e),{opType:"OP_TYPE_START_EDITING_TOPOLOGY"}))},tabIndex:-1};return Object(o.createElement)(mg,Ej({},a))}var Sj,Cj,wj,Rj,Kj,Dj,Lj,Ij,_j,Mj,Aj=[{group:"Basic",children:[{name:"rectangle",icon:"icon-rect",data:{text:"Topology",rect:{width:100,height:100},paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,name:"rectangle",icon:"\ue64d",iconFamily:"topology",iconColor:"#2f54eb"}},{name:"rectangle",icon:"icon-rectangle",data:{text:"rectangle",rect:{width:200,height:50},paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,borderRadius:.1,name:"rectangle"}},{name:"circle",icon:"icon-circle",data:{text:"circle",rect:{width:100,height:100},name:"circle",textMaxLine:1}},{name:"triangle",icon:"icon-triangle",data:{text:"triangle",rect:{width:100,height:100},name:"triangle"}},{name:"diamond",icon:"icon-diamond",data:{text:"diamond",rect:{width:100,height:100},name:"diamond"}},{name:"pentagon",icon:"icon-pentagon",data:{text:"pentagon",rect:{width:100,height:100},name:"pentagon"}},{name:"hexagon",icon:"icon-hexagon",data:{text:"hexagon",rect:{width:100,height:100},paddingTop:10,paddingBottom:10,name:"hexagon"}},{name:"pentagram",icon:"icon-pentagram",data:{text:"pentagram",rect:{width:100,height:100},name:"pentagram"}},{name:"left arrow",icon:"icon-arrow-left",data:{text:"",rect:{width:200,height:100},name:"leftArrow"}},{name:"right arrow",icon:"icon-arrow-right",data:{text:"",rect:{width:200,height:100},name:"rightArrow"}},{name:"bidirectional arrow",icon:"icon-twoway-arrow",data:{text:"",rect:{width:200,height:100},name:"twowayArrow"}},{name:"line",icon:"icon-line",data:{text:"line",rect:{width:100,height:100},name:"line"}},{name:"cloud",icon:"icon-cloud",data:{text:"cloud",rect:{width:100,height:100},name:"cloud"}},{name:"message",icon:"icon-msg",data:{text:"message",rect:{width:100,height:100},paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,name:"message"}},{name:"file",icon:"icon-file",data:{text:"file",rect:{width:80,height:100},paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,name:"file"}},{name:"text",icon:"icon-text",data:{text:"text",rect:{width:160,height:30},name:"text"}},{name:"image",icon:"icon-image",data:{text:"",rect:{width:100,height:100},name:"image",image:"/assets/img/logo.png"}},{name:"cube",icon:"icon-cube",data:{rect:{width:50,height:70},is3D:!0,z:10,zRotate:15,fillStyle:"#ddd",name:"cube",icon:"\ue63c",iconFamily:"topology",iconColor:"#777",iconSize:30}},{name:"people",icon:"icon-people",data:{rect:{width:70,height:100},name:"people"}},{name:"multi media",icon:"icon-pc",data:{text:"multi media",rect:{width:200,height:200},paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,name:"div"}}]},{group:"Flow Graph",children:[{name:"start/end",icon:"icon-flow-start",data:{text:"start",rect:{width:120,height:40},borderRadius:.5,name:"rectangle"}},{name:"flow",icon:"icon-rectangle",data:{text:"flow",rect:{width:120,height:40},name:"rectangle"}},{name:"judgement",icon:"icon-diamond",data:{text:"judgement",rect:{width:120,height:60},name:"diamond"}},{name:"data",icon:"icon-flow-data",data:{text:"data",rect:{width:120,height:50},name:"flowData"}},{name:"prepare",icon:"icon-flow-ready",data:{text:"prepare",rect:{width:120,height:50},name:"hexagon"}},{name:"sub flow",icon:"icon-flow-subprocess",data:{text:"sub flow",rect:{width:120,height:50},name:"flowSubprocess"}},{name:"database",icon:"icon-db",data:{text:"database",rect:{width:80,height:120},name:"flowDb"}},{name:"document",icon:"icon-flow-document",data:{text:"document",rect:{width:120,height:100},name:"flowDocument"}},{name:"internal storage",icon:"icon-internal-storage",data:{text:"internal storage",rect:{width:120,height:80},name:"flowInternalStorage"}},{name:"external storage",icon:"icon-extern-storage",data:{text:"external storage",rect:{width:120,height:80},name:"flowExternStorage"}},{name:"queue",icon:"icon-flow-queue",data:{text:"queue",rect:{width:100,height:100},name:"flowQueue"}},{name:"input manually",icon:"icon-flow-manually",data:{text:"input manually",rect:{width:120,height:80},name:"flowManually"}},{name:"display",icon:"icon-flow-display",data:{text:"display",rect:{width:120,height:80},name:"flowDisplay"}},{name:"parallel",icon:"icon-flow-parallel",data:{text:"parallel",rect:{width:120,height:50},name:"flowParallel"}},{name:"comment",icon:"icon-flow-comment",data:{text:"comment",rect:{width:100,height:100},name:"flowComment"}}]},{group:"Activity Diagram",children:[{name:"start",icon:"icon-inital",data:{text:"",rect:{width:30,height:30},name:"circle",fillStyle:"#555",strokeStyle:"transparent"}},{name:"end",icon:"icon-final",data:{text:"",rect:{width:30,height:30},name:"activityFinal"}},{name:"action",icon:"icon-action",data:{text:"action",rect:{width:120,height:50},borderRadius:.25,name:"rectangle"}},{name:"decision/merge",icon:"icon-diamond",data:{text:"\u51b3\u7b56",rect:{width:120,height:50},name:"diamond"}},{name:"vertical swimming lane",icon:"icon-swimlane-v",data:{text:"vertical swimming lane",rect:{width:200,height:500},name:"swimlaneV"}},{name:"horizontal swimming lane",icon:"icon-swimlane-h",data:{text:"horizontal swimming lane",rect:{width:500,height:200},name:"swimlaneH"}},{name:"vertical fork/merge",icon:"icon-fork-v",data:{text:"",rect:{width:10,height:150},name:"forkV",fillStyle:"#555",strokeStyle:"transparent"}},{name:"horizontal fork/merge",icon:"icon-fork",data:{text:"",rect:{width:150,height:10},name:"forkH",fillStyle:"#555",strokeStyle:"transparent"}}]},{group:"Sequence Diagram && Class Diagram",children:[{name:"lifeline",icon:"icon-lifeline",data:{text:"lifeline",rect:{width:150,height:400},name:"lifeline"}},{name:"activation",icon:"icon-focus",data:{text:"",rect:{width:12,height:200},name:"sequenceFocus"}},{name:"simple class",icon:"icon-simple-class",data:{text:"Topolgoy",rect:{width:270,height:200},paddingTop:40,font:{fontFamily:"Arial",color:"#222",fontWeight:"bold"},fillStyle:"#ffffba",strokeStyle:"#7e1212",name:"simpleClass",children:[{text:"- name: string\n+ setName(name: string): void",name:"text",paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rectInParent:{x:0,y:0,width:"100%",height:"100%",rotate:0},font:{fontFamily:"Arial",color:"#222",textAlign:"left",textBaseline:"top"}}]}},{name:"class",icon:"icon-class",data:{text:"Topolgoy",rect:{width:270,height:200},paddingTop:40,font:{fontFamily:"Arial",color:"#222",fontWeight:"bold"},fillStyle:"#ffffba",strokeStyle:"#7e1212",name:"interfaceClass",children:[{text:"- name: string",name:"text",paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rectInParent:{x:0,y:0,width:"100%",height:"50%",rotate:0},font:{fontFamily:"Arial",color:"#222",textAlign:"left",textBaseline:"top"}},{text:"+ setName(name: string): void",name:"text",paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rectInParent:{x:0,y:"50%",width:"100%",height:"50%",rotate:0},font:{fontFamily:"Arial",color:"#222",textAlign:"left",textBaseline:"top"}}]}}]}],Fj=d.default.div(Sj||(Sj=kj(["\n  position: relative;\n  display: flex;\n  width: 100%;\n  height: 100%;\n"],["\n  position: relative;\n  display: flex;\n  width: 100%;\n  height: 100%;\n"]))),Pj=d.default.div(Cj||(Cj=kj(["\n  flex: 1;\n  width: initial;\n  position: relative;\n  overflow: auto;\n  background: #fff;\n"],["\n  flex: 1;\n  width: initial;\n  position: relative;\n  overflow: auto;\n  background: #fff;\n"]))),Nj=d.default.div(wj||(wj=kj(["\n  flex-shrink: 0;\n  width: 1.75rem;\n  background-color: #f8f8f8;\n  border-right: 1px solid #d9d9d9;\n  overflow-y: auto;\n"],["\n  flex-shrink: 0;\n  width: 1.75rem;\n  background-color: #f8f8f8;\n  border-right: 1px solid #d9d9d9;\n  overflow-y: auto;\n"]))),Bj=d.default.div(Rj||(Rj=kj(["\n  color: #0d1a26;\n  font-weight: 600;\n  font-size: 0.12rem;\n  padding: 0.05rem 0.1rem;\n  margin-top: 0.08rem;\n  border-bottom: 1px solid #ddd;\n\n  &:first-child {\n    border-top: none;\n  }\n"],["\n  color: #0d1a26;\n  font-weight: 600;\n  font-size: 0.12rem;\n  padding: 0.05rem 0.1rem;\n  margin-top: 0.08rem;\n  border-bottom: 1px solid #ddd;\n\n  &:first-child {\n    border-top: none;\n  }\n"]))),zj=d.default.div(Kj||(Kj=kj(["\n  padding: 0.1rem 0;\n  a {\n    display: inline-block;\n    color: @text-color;\n    line-height: 1;\n    width: 0.4rem;\n    height: 0.4rem;\n    text-align: center;\n    text-decoration: none !important;\n\n    .iconfont {\n      font-size: 0.24rem;\n    }\n  }\n"],["\n  padding: 0.1rem 0;\n  a {\n    display: inline-block;\n    color: @text-color;\n    line-height: 1;\n    width: 0.4rem;\n    height: 0.4rem;\n    text-align: center;\n    text-decoration: none !important;\n\n    .iconfont {\n      font-size: 0.24rem;\n    }\n  }\n"]))),Vj=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={id:"",data:null,toolsConfig:Aj,iconfont:{fontSize:"0.24rem"}},t.canvasOptions={},t.handleContextMenu=function(e){e.preventDefault(),e.stopPropagation()},t.onMessage=function(e,n){var o=(0,t.props.getRef)("TOPOLOGY_DIAGRAM_UTIL");switch(e){case"resize":case"scale":case"locked":t.topology&&o&&o.setCanvasData(t.topology.data)}},t}return Tj(t,e),t.prototype.canvasRegister=function(){Object(gj.registerNode)("flowData",hj.flowData,hj.flowDataAnchors,hj.flowDataIconRect,hj.flowDataTextRect),Object(gj.registerNode)("flowSubprocess",hj.flowSubprocess,null,hj.flowSubprocessIconRect,hj.flowSubprocessTextRect),Object(gj.registerNode)("flowDb",hj.flowDb,null,hj.flowDbIconRect,hj.flowDbTextRect),Object(gj.registerNode)("flowDocument",hj.flowDocument,hj.flowDocumentAnchors,hj.flowDocumentIconRect,hj.flowDocumentTextRect),Object(gj.registerNode)("flowInternalStorage",hj.flowInternalStorage,null,hj.flowInternalStorageIconRect,hj.flowInternalStorageTextRect),Object(gj.registerNode)("flowExternStorage",hj.flowExternStorage,hj.flowExternStorageAnchors,hj.flowExternStorageIconRect,hj.flowExternStorageTextRect),Object(gj.registerNode)("flowQueue",hj.flowQueue,null,hj.flowQueueIconRect,hj.flowQueueTextRect),Object(gj.registerNode)("flowManually",hj.flowManually,hj.flowManuallyAnchors,hj.flowManuallyIconRect,hj.flowManuallyTextRect),Object(gj.registerNode)("flowDisplay",hj.flowDisplay,hj.flowDisplayAnchors,hj.flowDisplayIconRect,hj.flowDisplayTextRect),Object(gj.registerNode)("flowParallel",hj.flowParallel,hj.flowParallelAnchors,null,null),Object(gj.registerNode)("flowComment",hj.flowComment,hj.flowCommentAnchors,null,null),Object(gj.registerNode)("activityFinal",Oj.activityFinal,null,Oj.activityFinalIconRect,Oj.activityFinalTextRect),Object(gj.registerNode)("swimlaneV",Oj.swimlaneV,null,Oj.swimlaneVIconRect,Oj.swimlaneVTextRect),Object(gj.registerNode)("swimlaneH",Oj.swimlaneH,null,Oj.swimlaneHIconRect,Oj.swimlaneHTextRect),Object(gj.registerNode)("forkH",Oj.fork,Oj.forkHAnchors,Oj.forkIconRect,Oj.forkTextRect),Object(gj.registerNode)("forkV",Oj.fork,Oj.forkVAnchors,Oj.forkIconRect,Oj.forkTextRect),Object(gj.registerNode)("simpleClass",mj.simpleClass,null,mj.simpleClassIconRect,mj.simpleClassTextRect),Object(gj.registerNode)("interfaceClass",mj.interfaceClass,null,mj.interfaceClassIconRect,mj.interfaceClassTextRect),Object(gj.registerNode)("lifeline",vj.lifeline,vj.lifelineAnchors,vj.lifelineIconRect,vj.lifelineTextRect),Object(gj.registerNode)("sequenceFocus",vj.sequenceFocus,vj.sequenceFocusAnchors,vj.sequenceFocusIconRect,vj.sequenceFocusTextRect)},t.prototype.componentDidMount=function(){this.canvasRegister(),this.canvasOptions.on=this.onMessage,this.topology=new bj.Topology("topology-canvas",this.canvasOptions),this.openData()},t.prototype.componentDidUpdate=function(){this.openData()},t.prototype.openData=function(){var e=this.props,t=e.model,n=e.topicKey,o=t.getTopic(n).getBlock("TOPOLOGY").block;o&&o.data&&""!==o.data&&(this.setState({data:o.data}),this.topology.open(o.data))},t.prototype.onDrag=function(e,t){e.dataTransfer.setData("Text",JSON.stringify(t.data))},t.prototype.renderTools=function(){var e=this;return Object(o.createElement)(Nj,null,this.state.toolsConfig.map((function(t,n){return Object(o.createElement)("div",{key:n},Object(o.createElement)(Bj,null,t.group),Object(o.createElement)(zj,null,t.children.map((function(t,n){return Object(o.createElement)("a",{key:n,title:t.name,draggable:!0,onDragStart:function(n){e.onDrag(n,t)}},Object(o.createElement)("i",{className:"iconfont "+t.icon,style:e.state.iconfont}))}))))})))},t.prototype.render=function(){return Object(o.createElement)(Fj,null,this.renderTools(),Object(o.createElement)(Pj,{id:"topology-canvas",onContextMenu:this.handleContextMenu}))},t}(rg),Hj=d.default.div(Dj||(Dj=kj(["\n  position: absolute;\n  background: white;\n  right: 30px;\n  bottom: 20px;\n  border-radius: 2px;\n  z-index: 3;\n  display: flex;\n  flex-direction: row;\n  user-select: none;\n"],["\n  position: absolute;\n  background: white;\n  right: 30px;\n  bottom: 20px;\n  border-radius: 2px;\n  z-index: 3;\n  display: flex;\n  flex-direction: row;\n  user-select: none;\n"]))),Gj=Object(d.default)(bg)(Lj||(Lj=kj(["\n  margin: 10px;\n"],["\n  margin: 10px;\n"]))),Uj=function(e){return Object(o.createElement)(b.x,{content:e.tooltip,position:h.a.TOP,className:g.a.ICON},Object(o.createElement)(Gj,{onClick:e.onClick},e.children))},Wj=d.default.span(Ij||(Ij=kj(["\n  display: inline-block;\n  width: 80px;\n  height: 18px;\n"],["\n  display: inline-block;\n  width: 80px;\n  height: 18px;\n"]))),Zj=function(e){function t(t){var n=e.call(this,t)||this;return n.setCanvasData=function(e){n.setState({canvasData:e})},n.onClickResetZoom=function(e){n.getTopology().scaleTo(1)},n.state={deleteConfirm:!1,canvasData:null},n}return Tj(t,e),t.prototype.getTopology=function(){return(0,this.props.getRef)("TOPOLOGY_DIAGRAM").topology},t.prototype.render=function(){var e=this,t=this.props,n=t.controller,r={isOpen:this.state.deleteConfirm,cancelButtonText:"cancel",onConfirm:function(e){n.run("operation",Ej(Ej({},t),{opType:wy,blockType:"TOPOLOGY"}))},onCancel:function(t){e.setState({deleteConfirm:!1})},onClose:function(t){e.setState({deleteConfirm:!1})}},c=this.state.canvasData,i=c?c.scale:1;return Object(o.createElement)(Hj,null,Object(o.createElement)(Uj,{onClick:this.onClickResetZoom,tooltip:"reset zoom"},Object(o.createElement)(Wj,null,"zoom:"+Math.floor(100*i)+"%")),Object(o.createElement)(Uj,{onClick:function(t){e.setState({deleteConfirm:!0})},tooltip:"delete this diagram"},Vg(Ng)),Object(o.createElement)(b.a,Ej({},r),Object(o.createElement)("p",null,"Are you confirm to delete this topology diagram?")))},t}(o.Component),Yj=d.default.div(_j||(_j=kj(["\n  position: relative;\n  overflow: auto;\n  padding: 0px 0px 0px 5px;\n  background: #88888850;\n  height: 100%;\n"],["\n  position: relative;\n  overflow: auto;\n  padding: 0px 0px 0px 5px;\n  background: #88888850;\n  height: 100%;\n"]))),Jj=d.default.span(Mj||(Mj=kj(["\n  padding: 0px 20px;\n"],["\n  padding: 0px 20px;\n"])));function Xj(e){var t=e.controller,n=e.topicKey,r=e.getRef,c=e.saveRef,i=Ej(Ej({},e),{ref:c("TOPOLOGY_DIAGRAM")}),a=Ej(Ej({},e),{ref:c("TOPOLOGY_DIAGRAM_UTIL")});return Object(o.createElement)(b.i,{title:Object(o.createElement)(Jj,null,"Topology Diagram Editor"),icon:Vg("topology"),isOpen:!0,hasBackdrop:!0,backdropClassName:"backdrop",backdropProps:{onMouseDown:BO},canOutsideClickClose:!1,isCloseButtonShown:!0,onClose:function(o){o.stopPropagation();var c=r("TOPOLOGY_DIAGRAM").topology.data;t.run("operation",Ej(Ej({},e),{opType:Cy,topicKey:n,blockType:"TOPOLOGY",data:c,focusMode:iy}))},size:"100%"},Object(o.createElement)(Yj,{onClick:BO,onDoubleClick:BO},Object(o.createElement)(Vj,Ej({},i)),Object(o.createElement)(Zj,Ej({},a))))}function qj(e){var t=e.model,n=e.topicKey,o=t.getTopic(n).getBlock("TOPOLOGY").block;return null!=o&&null!=o.data||(t=Hy.setBlockData({model:t,topicKey:n,blockType:"TOPOLOGY",data:""})),t=Hy.focusTopic({model:t,topicKey:n,focusMode:"FOCUS_MODE_EDITING_TOPOLOGY"})}var Qj=function(){return{renderTopicBlock:function(e,t){var n=e.controller;return"TOPOLOGY"===e.block.type?n.run("renderTopicBlockTopology",e):t()},renderTopicBlockTopology:function(e){return Object(o.createElement)(xj,Ej({},e))},renderDrawer:function(e,t){var n=e.model;if("FOCUS_MODE_EDITING_TOPOLOGY"===n.focusMode){var r=Ej(Ej({},e),{topicKey:n.focusKey,key:"topology-drawer"});return Object(o.createElement)(Xj,Ej({},r))}return t()},customizeTopicContextMenu:function(e,t){var n=e.controller;return Object(o.createElement)(o.Fragment,null,t(),Object(o.createElement)(b.o,null),Object(o.createElement)(b.p,{icon:Vg("topology"),text:"Edit Topology Diagram",onClick:function(t){n.run("operation",Ej(Ej({},e),{opType:"OP_TYPE_START_EDITING_TOPOLOGY"}))}}))},getOpMap:function(e,t){var n=t();return n.set("OP_TYPE_START_EDITING_TOPOLOGY",qj),n}}};function $j(e){return!0===(null!=(t=e)&&"object"===typeof t&&!1===Array.isArray(t))&&"[object Object]"===Object.prototype.toString.call(e);var t}var eT=function(e){var t,n;return!1!==$j(e)&&("function"===typeof(t=e.constructor)&&(!1!==$j(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))};var tT,nT=function(e,t){},oT="L",rT="R",cT="M";!function(e){e[e.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT",e[e.LEFT_AND_RIGHT=2]="LEFT_AND_RIGHT",e[e.TOP_TO_BOTTOM=3]="TOP_TO_BOTTOM"}(tT||(tT={}));var iT=0,aT=1,lT="CONTENT",uT="DESC",sT="NORMAL",pT="EDITING_CONTENT",dT="EDITING_DESC",fT="SHOW_POPUP",yT="DRAGGING",bT="ANCESTOR",gT="DESCENDANT",hT="SIBLING",OT="NONE",mT="TOGGLE_COLLAPSE",vT="COLLAPSE_ALL",jT="EXPAND_ALL",TT="EXPAND_TO",ET="ADD_CHILD",kT="ADD_SIBLING",xT="DELETE_TOPIC",ST="FOCUS_TOPIC",CT="SET_FOCUS_MODE",wT="SET_STYLE",RT="CLEAR_ALL_CUSTOM_STYLE",KT="SET_THEME",DT="SET_TOPIC_BLOCK",LT="DELETE_TOPIC_BLOCK",IT="START_EDITING_CONTENT",_T="START_EDITING_DESC",MT="DRAG_AND_DROP",AT="SET_EDITOR_ROOT",FT="SET_LAYOUT_DIR",PT=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"data",get:function(){return this.get("data")}},{key:"type",get:function(){return this.get("type")}}],[{key:"create",value:function(e){return new n(e)}},{key:"createList",value:function(e){if(j.List.isList(e)||Array.isArray(e))return Object(j.List)(e.map(n.create));throw new Error("Block.createList only accepts Array or List, but you passed it: ".concat(e))}}]),n}(Object(j.Record)({type:null,key:null,data:null}));var NT={readOnly:!1,allowUndo:!0,layoutDir:tT.LEFT_AND_RIGHT,theme:{name:"default",randomColor:!0,background:"rgb(57,60,65)",highlightColor:"#50C9CE",marginH:60,marginV:20,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5,lineType:"curve",lineWidth:"3px"},rootTopic:{contentStyle:{fontSize:"34px",borderRadius:"35px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},primaryTopic:{contentStyle:{borderWidth:"1px",borderStyle:"solid",borderRadius:"20px",fontSize:"17px",padding:"10px 15px 10px 15px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},normalTopic:{contentStyle:{border:"1px solid #e8eaec",borderRadius:"20px",fontSize:"17px",padding:"4px 10px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"white"}}}},BT=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"layoutDir",get:function(){return this.get("layoutDir")}},{key:"readOnly",get:function(){return this.get("readOnly")}},{key:"allowUndo",get:function(){return this.get("allowUndo")}},{key:"theme",get:function(){return this.get("theme")}}],[{key:"fromJSON",value:function(e){return new n(e)}}]),n}(Object(j.Record)(NT));function zT(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var VT=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"key",get:function(){return this.get("key")}},{key:"parentKey",get:function(){return this.get("parentKey")}},{key:"collapse",get:function(){return this.get("collapse")}},{key:"subKeys",get:function(){return this.get("subKeys")}},{key:"blocks",get:function(){return this.get("blocks")}},{key:"relations",get:function(){return this.get("relations")}},{key:"style",get:function(){return this.get("style")}},{key:"getBlock",value:function(e){var t=this.blocks.findIndex((function(t){return t.type===e}));return-1===t?{index:t,block:null}:{index:t,block:this.blocks.get(t)}}}],[{key:"fromJSON",value:function(e){var t=e.key,o=e.parentKey,r=void 0===o?null:o,c=e.blocks,i=e.subKeys,a=void 0===i?[]:i,l=e.collapse;return new n({key:t,parentKey:r,collapse:void 0!==l&&l,subKeys:Object(j.List)(a),blocks:PT.createList(c)})}},{key:"create",value:function(e){var t=e.key,o=e.parentKey,r=void 0===o?null:o,c=e.content,i=void 0===c?"":c,a=e.subKeys,l=void 0===a?[]:a,u=e.collapse,s=void 0!==u&&u,p=PT.create({type:lT,data:i,key:null});return new n({key:t,parentKey:r,blocks:Object(j.List)([p]),subKeys:Object(j.List)(l),collapse:s})}}]),n}(Object(j.Record)({key:null,parentKey:null,collapse:!1,subKeys:null,blocks:null,relations:null,style:null}));function HT(e,t){var n=e.getTopic(t),o=[];if(n.subKeys.size>0){var r,c=n.subKeys.toArray();(r=o).push.apply(r,Object(v.a)(c)),o=c.reduce((function(t,n){return t.push.apply(t,Object(v.a)(HT(e,n))),t}),o)}return o}function GT(e,t,n){var o=e.getTopic(t),r=e.getTopic(n);if(o&&r){if(o.parentKey==r.parentKey)return hT;for(var c=o;c.parentKey;){if(c.parentKey===r.key)return gT;c=e.getParentTopic(c.key)}for(c=r;c.parentKey;){if(c.parentKey===o.key)return bT;c=e.getParentTopic(c.key)}}return OT}var UT=y()("modifier");function WT(e){var t=e.model,n=e.topicKey,o=e.focusMode;return UT("focus topic"),n!==t.focusKey&&(t=t.set("focusKey",n)),o!==t.focusMode&&(t=t.set("focusMode",o)),t}var ZT={addChild:function(e){var t=e.model,n=e.topicKey;UT("addChild:",n);var o=t.getTopic(n);if(o){var r=VT.create({key:zT(),parentKey:o.key});return o=o.set("collapse",!1).update("subKeys",(function(e){return e.push(r.key)})),WT({model:t=t.update("topics",(function(e){return e.set(n,o).set(r.key,r)})),topicKey:r.key,focusMode:pT})}return t},addSibling:function(e){var t=e.model,n=e.topicKey;if(n===t.rootTopicKey)return t;var o=t.getTopic(n);if(o){var r=t.getTopic(o.parentKey),c=r.subKeys.indexOf(n),i=VT.create({key:zT(),parentKey:r.key});return WT({model:t=t.update("topics",(function(e){return e.set(i.key,i)})).updateIn(["topics",r.key,"subKeys"],(function(e){return e.insert(c+1,i.key)})),topicKey:i.key,focusMode:pT})}return t},toggleCollapse:function(e){var t=e.model,n=e.topicKey,o=t.getTopic(n);return o&&0!==o.subKeys.size&&(o=o.merge({collapse:!o.collapse}),t=t.updateIn(["topics",o.key,"collapse"],(function(e){return!e}))),t=WT({model:t,topicKey:n,focusMode:sT})},collapseAll:function(e){var t=e.model,n=HT(t,t.editorRootTopicKey);return UT(t),t=WT({model:t=t.withMutations((function(e){n.forEach((function(t){e.setIn(["topics",t,"collapse"],!0)}))})),topicKey:t.editorRootTopicKey,focusMode:sT})},expandAll:function(e){var t=e.model,n=HT(t,t.editorRootTopicKey);return UT(t),t=t.withMutations((function(e){n.forEach((function(t){e.setIn(["topics",t,"collapse"],!1)}))})),UT(t),t},expandTo:function(e){var t=e.model,n=e.topicKey,o=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[t],r=e.getTopic(t);r.parentKey;)n?o.push(r.parentKey):o.unshift(r.parentKey),r=e.getParentTopic(r.key);return o}(t,n).filter((function(e){return e!==n}));return GT(t=t.withMutations((function(e){o.forEach((function(t){e.setIn(["topics",t,"collapse"],!1)}))})),n,t.editorRootTopicKey)!==gT&&(t=t.set("editorRootTopicKey",t.rootTopicKey)),t},focusTopic:WT,setFocusMode:function(e){var t=e.model,n=e.focusMode;return UT("setFocusMode"),n!==t.focusMode&&(t=t.set("focusMode",n)),t},deleteTopic:function(e){var t=e.model,n=e.topicKey;if(n===t.editorRootTopicKey)return t;var o=t.getTopic(n);return o&&(t=t.withMutations((function(e){e.update("topics",(function(e){e=e.delete(n);var o=HT(t,n);return e=e.withMutations((function(e){o.forEach((function(t){e.delete(t)}))}))})),e.updateIn(["topics",o.parentKey,"subKeys"],(function(e){return e.delete(e.indexOf(n))})),e.focusKey===n&&e.set("focusKey",null).set("focusMode",null)}))),t},setBlockData:function(e){var t=e.model,n=e.topicKey,o=e.blockType,r=e.focusMode,c=e.data,i=t.getTopic(n);if(i){var a=i.getBlock(o),l=a.index,u=a.block;-1===l?t=t.updateIn(["topics",n,"blocks"],(function(e){return e.push(PT.create({type:o,data:c}))})):u.data!==c&&(t=t.updateIn(["topics",n,"blocks",l,"data"],(function(e){return c}))),r&&(t=WT({model:t,topicKey:n,focusMode:r}))}return t},deleteBlock:function(e){var t=e.model,n=e.topicKey,o=e.blockType,r=t.getTopic(n);if(r){var c=r.getBlock(o).index;-1!==c&&(t=t.updateIn(["topics",n,"blocks"],(function(e){return e.delete(c)}))),t=WT({model:t,topicKey:null,focusMode:null})}return t},setStyle:function(e){var t=e.model,n=e.topicKey,o=e.style,r=t.getTopic(n);return r&&o!==r.style&&(t=t.updateIn(["topics",n,"style"],(function(e){return o}))),t},clearAllCustomStyle:function(e){var t=e.model;return t=t.withMutations((function(e){e.topics.keySeq().forEach((function(t){e.setIn(["topics",t,"style"],null)}))}))},setTheme:function(e){var t=e.model,n=e.theme;return t=t.setIn(["config","theme"],n)},setLayoutDir:function(e){var t=e.model,n=e.layoutDir;return t.config.layoutDir===n?t:t=t.setIn(["config","layoutDir"],n)},setEditorRootTopicKey:function(e){var t=e.model,n=e.topicKey;return t.editorRootTopicKey!==n&&(t=t.set("editorRootTopicKey",n)),t.getTopic(n).collapse&&(t=t.setIn(["topics",n,"collapse"],!1)),t},setZoomFactor:function(e){var t=e.model,n=e.zoomFactor;return t.zoomFactor!==n&&(t=t.set("zoomFactor",n)),t}},YT={topics:Object(j.Map)(),extData:Object(j.Map)(),config:new BT,rootTopicKey:null,editorRootTopicKey:null,focusKey:null,focusMode:null,formatVersion:null,zoomFactor:1},JT=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"toJS",value:function(){return{rootTopicKey:this.rootTopicKey,topics:Object.values(this.topics.toJS()),config:this.config,extData:this.extData,zoomFactor:this.zoomFactor}}},{key:"extData",get:function(){return this.get("extData")}},{key:"topics",get:function(){return this.get("topics")}},{key:"config",get:function(){return this.get("config")}},{key:"formatVersion",get:function(){return this.get("formatVersion")}},{key:"rootTopicKey",get:function(){return this.get("rootTopicKey")}},{key:"editorRootTopicKey",get:function(){return this.get("editorRootTopicKey")}},{key:"focusKey",get:function(){return this.get("focusKey")}},{key:"focusMode",get:function(){return this.get("focusMode")}},{key:"editingContentKey",get:function(){return this.focusMode===pT?this.focusKey:null}},{key:"editingDescKey",get:function(){return this.focusMode===dT?this.focusKey:null}},{key:"getTopic",value:function(e){return this.topics.get(e)}},{key:"getExtDataItem",value:function(e,t){return this.extData.get(e)||new t}},{key:"getParentTopic",value:function(e){var t=this.getTopic(e);return t.parentKey?this.getTopic(t.parentKey):null}},{key:"getTopicVisualLevel",value:function(e){for(var t=this.getTopic(e),n=0;t&&t.key!==this.editorRootTopicKey;)n++,t=this.getParentTopic(t.key);return n}},{key:"rootTopic",get:function(){return this.getTopic(this.rootTopicKey)}},{key:"zoomFactor",get:function(){return this.get("zoomFactor")}}],[{key:"isModel",value:function(e){return e instanceof n}},{key:"create",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null==t)return n.createEmpty();if(n.isModel(t)&&(e=t),eT(t)&&(e=n.fromJSON(t)),e)return null==e.focusKey&&(e=e.set("focusKey",e.rootTopicKey)),null==e.focusMode&&(e=e.set("focusMode",sT)),e;throw new Error("`Value.create` only accepts objects or values, but you passed it: ".concat(t))}},{key:"createEmpty",value:function(){var e=new n,t=VT.create({key:zT(),content:"RootTopic"});return e.update("topics",(function(e){return e.set(t.key,t)})).set("rootTopicKey",t.key).set("editorRootTopicKey",t.key).set("focusKey",t.key).set("focusMode",sT)}},{key:"fromJSON",value:function(e){var t=new n,o=e.topics,r=void 0===o?[]:o,c=e.config,i=void 0===c?{}:c,a=e.rootTopicKey,l=e.editorRootTopicKey;return void 0===l&&(l=a),t=(t=t.merge({rootTopicKey:a,editorRootTopicKey:l})).withMutations((function(e){r.forEach((function(t){e.update("topics",(function(e){return e.set(t.key,VT.fromJSON(t))}))})),e.set("config",BT.fromJSON(i))}))}}]),n}(Object(j.Record)(YT));function XT(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.plugins,n=void 0===t?[]:t;return Object(v.a)(n)}y()("core:controller");function qT(e,t){if(Array.isArray(t))t.forEach((function(t){return qT(e,t)}));else if(null!=t)for(var n in t){var o=t[n];e.middleware[n]=e.middleware[n]||[],e.middleware[n].push(o)}}function QT(e){if(!Array.isArray(e))throw new TypeError("Middleware stack must be an array!");var t,n=Object(m.a)(e);try{for(n.s();!(t=n.n()).done;){if("function"!==typeof t.value)throw new TypeError("Middleware must be composed of functions!")}}catch(o){n.e(o)}finally{n.f()}return function(t,n){var r=-1;return function c(i){if(i<=r)throw new Error("next() called multiple times");r=i;var a=e[i];i===e.length&&(a=n);if(!a)return null;try{return a(t,c.bind(null,i+1))}catch(o){throw o}}(0)}}var $T,eE,tE,nE,oE,rE,cE,iE,aE,lE,uE,sE,pE,dE,fE,yE,bE,gE,hE,OE,mE,vE,jE,TE,EE,kE,xE,SE,CE,wE,RE,KE,DE,LE,IE,_E,ME,AE,FE,PE,NE,BE,zE,VE,HE,GE,UE,WE,ZE,YE,JE,XE,qE,QE,$E,ek,tk,nk=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(a.a)(this,e);var n=t.plugins,o=void 0===n?[]:n,r=t.onChange,c=t.readOnly;this.readOnly=c,this.onChange=r,this.middleware=new Map;var i=XT({plugins:o});qT(this,i)}return Object(l.a)(e,[{key:"run",value:function(e){var t=this.middleware,n=t[e]||[];nT(0!==n.length,"the middleware function ".concat(e," is not found!"));for(var o=Object(k.a)(QT)(n),r=arguments.length,c=new Array(r>1?r-1:0),i=1;i<r;i++)c[i-1]=arguments[i];return o.apply(void 0,c)}},{key:"getValue",value:function(e,t){return this.run("getValue",Object(O.a)(Object(O.a)({},t),{},{propKey:e}))}},{key:"change",value:function(e,t){this.onChange(e,t),this.currentModel=e}}]),e}(),ok=(n(875),["title"]),rk=["layout","title"],ck=["layout","title"],ik=["controller","children","onClick"],ak=["text"],lk=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){return Object(a.a)(this,n),t.call(this,e)}return Object(l.a)(n,[{key:"operation",value:function(e,t){this.props.controller.run("operation",Object(O.a)({opType:e},t))}},{key:"run",value:function(e,t){this.props.controller.run(e,t)}},{key:"topic",get:function(){return this.props.model.getTopic(this.props.topicKey)}}]),n}(o.Component),uk=y()("node:drag-scroll-widget"),sk=d.default.div($T||($T=Object(Ka.a)(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: scroll;\n"]))),pk=d.default.div(eE||(eE=Object(Ka.a)(["\n  position: relative;\n  width: max-content;\n"]))),dk=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).contentResizeCallback=function(e,t){if(o.oldContentRect){var n={width:o.content.clientWidth+2*o.viewBox.clientWidth,height:o.content.clientHeight+2*o.viewBox.clientHeight};o.bigView.style.width=n.width+"px",o.bigView.style.height=n.height+"px"}o.oldContentRect=e[0].contentRect},o.contentResizeObserver=new p.a(o.contentResizeCallback),o.contentRef=function(e){e&&(o.content=e,o.contentResizeObserver.observe(o.content))},o.viewBoxRef=function(e){e&&(o.viewBox=e,o.props.enableMouseWheel||(uk("addEventListener onwheel"),o.viewBox.addEventListener("wheel",(function(e){uk("onwheel"),(e.ctrlKey||e.altKey)&&e.preventDefault()}),{passive:!1})),o.setViewBoxScroll(o.viewBox.clientWidth,o.viewBox.clientHeight))},o.bigViewRef=function(e){e&&(o.bigView=e)},o.setWidgetStyle=function(){o.content&&o.viewBox&&o.bigView&&(o.bigView.style.width=2*(o.content.clientWidth+o.viewBox.clientWidth)+"px",o.bigView.style.height=2*(o.content.clientHeight+o.viewBox.clientHeight)+"px",o.content.style.left=o.viewBox.clientWidth+"px",o.content.style.top=o.viewBox.clientHeight+"px")},o.setViewBoxScroll=function(e,t){uk("setViewBoxScroll ".concat(e," ").concat(t)),o.viewBox&&(o.viewBox.scrollLeft=e,o.viewBox.scrollTop=t)},o.setViewBoxScrollDelta=function(e,t){uk("setViewBoxScrollDelta ".concat(e," ").concat(t)),o.viewBox&&(o.viewBox.scrollLeft+=e,o.viewBox.scrollTop+=t)},o.onMouseDown=function(e){var t=o.props,n=t.mouseKey,r=t.needKeyPressed,c=t.canDragFunc;if((!c||c())&&(0===e.button&&"left"===n||2===e.button&&"right"===n)){if(r&&!e.ctrlKey)return;o._lastCoordX=o.viewBox.scrollLeft+e.nativeEvent.clientX,o._lastCoordY=o.viewBox.scrollTop+e.nativeEvent.clientY;var i=o.viewBox;i.addEventListener("mousemove",o.onMouseMove),i.addEventListener("mouseup",o.onMouseUp)}},o.onMouseUp=function(e){var t=o.viewBox;t.removeEventListener("mousemove",o.onMouseMove),t.removeEventListener("mouseup",o.onMouseUp)},o.onMouseMove=function(e){o.viewBox.scrollLeft=o._lastCoordX-e.clientX,o.viewBox.scrollTop=o._lastCoordY-e.clientY},o.handleContextMenu=function(e){e.preventDefault()},o.state={widgetStyle:{width:"10000px",height:"10000px"}},o}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.setWidgetStyle(),document.addEventListener("contextmenu",this.handleContextMenu)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("contextmenu",this.handleContextMenu)}},{key:"setZoomFactor",value:function(e){this.bigView.style.transform="scale(".concat(e,")"),this.bigView.style.transformOrigin="50% 50%"}},{key:"render",value:function(){var e=Object(O.a)({},this.state.widgetStyle);return Object(o.createElement)(sk,{ref:this.viewBoxRef,onMouseDown:this.onMouseDown},Object(o.createElement)("div",{style:e,ref:this.bigViewRef},Object(o.createElement)(pk,{ref:this.contentRef,style:this.state.contentStyle},this.props.children(this.setViewBoxScroll,this.setViewBoxScrollDelta))))}}]),n}(o.Component);dk.defaultProps={mouseKey:"left",needKeyPressed:!1};var fk=y()("node:save-ref"),yk=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).getRef=function(t){return fk(Object(Ra.a)(e)),e[t]},e.saveRef=function(t){return function(n){n&&(e[t]=n,e.fireListener(t,n))}},e.deleteRef=function(t){fk("deleteRef:",t),delete e[t]},e.observers=new Map,e.fireListener=function(t,n){if(e.observers.has(t)){var o,r=e.observers.get(t),c=Object(m.a)(r);try{for(c.s();!(o=c.n()).done;){(0,o.value)(t,n)}}catch(i){c.e(i)}finally{c.f()}}},e.registerRefListener=function(t,n){e.observers.has(t)?e.observers.get(t).push(n):e.observers.set(t,[n])},e}return Object(l.a)(n,[{key:"render",value:function(){return this.props.children(this.saveRef,this.getRef,this.deleteRef,this.registerRefListener.bind(this))}}]),n}(o.Component),bk=d.default.div(tE||(tE=Object(Ka.a)(["\n  display: flex;\n  flex-direction: ",";\n  align-items: ",";\n  justify-content: ",";\n"])),(function(e){return e.flexDirection?e.flexDirection:"row"}),(function(e){return e.alignItems}),(function(e){return e.justifyContent})),gk=d.default.div(nE||(nE=Object(Ka.a)(["\n  margin: ",";\n"])),(function(e){return e.margin})),hk=d.default.a(oE||(oE=Object(Ka.a)(["\n  font-size: 20px !important;\n"]))),Ok=d.default.div(rE||(rE=Object(Ka.a)(["\n  padding: 5px;\n  cursor: pointer;\n"]))),mk=d.default.div(cE||(cE=Object(Ka.a)(["\n  cursor: pointer;\n  &:hover {\n    color: #1ea7fd;\n  }\n"]))),vk=Object(d.default)(b.e)(iE||(iE=Object(Ka.a)(["\n  margin-bottom: 0px !important;\n"]))),jk=Object(d.default)(mk)(aE||(aE=Object(Ka.a)(["\n  position: absolute;\n  right: 5px;\n  top: 5px;\n  //padding: 5px;\n"]))),Tk=d.default.div(lE||(lE=Object(Ka.a)(["\n  height: 16px;\n"]))),Ek=d.default.span(uE||(uE=Object(Ka.a)(["\n  margin: 0px 10px;\n  &:hover {\n    color: palevioletred;\n  }\n"]))),kk=d.default.div(sE||(sE=Object(Ka.a)(["\n  z-index: ",";\n"])),(function(e){return e.zIndex})),xk=d.default.div(pE||(pE=Object(Ka.a)(["\n  min-width: 380px;\n  max-width: 482px;\n  max-height: 470px;\n  overflow: auto;\n"]))),Sk=d.default.div(dE||(dE=Object(Ka.a)(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n"]))),Ck=(d.default.div(fE||(fE=Object(Ka.a)(["\n  max-height: ",";\n  overflow-y: auto;\n  overflow-x: hidden;\n"])),(function(e){return e.maxHeight||"300px"})),d.default.div(yE||(yE=Object(Ka.a)(["\n  margin-top: 10px;\n  margin-bottom: 5px;\n  font-weight: bold;\n"])))),wk=d.default.span(bE||(bE=Object(Ka.a)(["\n  margin: 0 10px 0 2px;\n"]))),Rk=d.default.div(gE||(gE=Object(Ka.a)(["\n  padding: 10px;\n  margin: 0 0 10px 0;\n  border: rgba(16, 22, 26, 0.15) solid 1px;\n  border-radius: 5px;\n"]))),Kk=Object(d.default)(wk)(hE||(hE=Object(Ka.a)([""]))),Dk=d.default.div(OE||(OE=Object(Ka.a)(["\n  display: flex;\n  align-items: center;\n  //justify-content: center;\n  margin: 5px 0;\n"]))),Lk=d.default.div(mE||(mE=Object(Ka.a)(["\n  height: 3px;\n  width: 80%;\n  margin-left: 10%;\n  margin-right: 10%;\n  margin-bottom: 2px;\n  background: ",";\n"])),(function(e){return e.color})),Ik=d.default.div(vE||(vE=Object(Ka.a)(["\n  border: 1px solid grey;\n  cursor: pointer;\n  font-weight: bold;\n"]))),_k="show-menu",Mk="close",Ak="color-picker",Fk="notes",Pk="plus",Nk="minus",Bk="collapse",zk="expand",Vk="center",Hk="layout-left-and-right";function Gk(e){return"icon iconfont bm-".concat(e)}function Uk(e){return Object(o.createElement)("span",{className:Gk(e)})}function Wk(e){return"content-".concat(e)}function Zk(e){return"content-editor-".concat(e)}function Yk(e){return"desc-editor-".concat(e)}function Jk(e){return"topic-widget-".concat(e)}function Xk(e){return"topic-".concat(e)}function qk(e){return"links-".concat(e)}function Qk(e){return"links-svg-".concat(e)}function $k(e){return"collapse-".concat(e)}function ex(e,t){return"dropArea-".concat(t,"-").concat(e)}var tx="DIAGRAM-ROOT",nx="DragScrollWidget",ox="svg-highlight",rx="focus-highlight",cx="drop-effect",ix="CENTER_ROOT_TOPIC",ax="DIAGRAM_CUSTOMIZE_BASE_Z_INDEX",lx="TOPIC_CONTEXT_MENU_ENABLED",ux="TOPIC_TITLE",sx="DRAG_DROP_STATE",px="RIGHT_TOP_PANEL_STATE",dx="OPERATION_ENABLED",fx="CONFIRM",yx="CANCEL",bx="DEFAULT",gx="SEARCH",hx="LEFT_AND_RIGHT",Ox="ONLY_LEFT",mx="ONLY_RIGHT",vx="EDIT",jx="ADD_SIBLING",Tx="ADD_CHILD",Ex="EDIT_NOTES",kx="DELETE",xx="SET_AS_EDITOR_ROOT",Sx="EDIT_TOPOLOGY_DIAGRAM",Cx="SET_TOPIC_REFERENCES",wx="TOPIC_STYLE",Rx="STYLE",Kx="TEXT_EDITOR",Dx="LINK",Lx="LINK_TO_PARENT",Ix="SUB_LINKS",_x="COPY_STYLE",Mx="PASTE_STYLE",Ax="CLEAR_TOPIC_STYLE",Fx="CLEAR_ALL_CUSTOM_STYLE",Px="LINE_TYPE",Nx="THEME",Bx="GLOBAL",zx="HIGHLIGHT",Vx="RANDOM_COLOR",Hx="NORMAL_TOPIC",Gx="PRIMARY_TOPIC",Ux="ROOT_TOPIC",Wx="EXPORT_THEME",Zx="IMPORT_THEME",Yx="TAGS",Jx="TAGS_MANAGER",Xx="TAG_NAME",qx="ADD_TAG",Qx="UPDATE_TAG",$x="ALREADY_ADDED",eS="CAN_BE_ADDED",tS="TOPICS_THAT_USE_THIS_TAG",nS="BACKGROUND",oS="COLOR",rS="BORDER",cS="WIDTH",iS="RADIUS",aS="FONT_SIZE",lS="LINE_HEIGHT",uS="PADDING",sS="TOP",pS="BOTTOM",dS="LEFT",fS="RIGHT",yS="NONE",bS="SOLID",gS="DOTTED",hS="DASHED",OS="DOUBLE",mS="ROUND",vS="CURVE",jS="LINE",TS="COLLAPSE_ALL",ES="EXPAND_ALL",kS="CENTER_ROOT_TOPIC",xS="ZOOM",SS="ZOOM_IN",CS="ZOOM_OUT",wS="RESET",RS="RESET_ZOOM",KS="NOTE_PLACEHOLDER",DS="TOPOLOGY_DIAGRAM_EDITOR",LS="BASIC",IS="FLOW_GRAPH",_S="ACTIVITY_DIAGRAM",MS="SEQUENCE_DIAGRAM",AS="CLASS_DIAGRAM",FS="REFERENCE_TOPICS",PS="REFERENCED_TOPICS",NS="SELECT_REF_TOPICS_TIP",BS="TAG_NAME_OVER_MAX_TIP",zS="DELETE_TAG_TIP",VS="DELETE_TOPOLOGY_TIP",HS=function(e){e.stopPropagation()};function GS(e,t){!function(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.click()}("data:text/plain,".concat(encodeURIComponent(e)),t)}function US(e){var t=e.top,n=void 0===t?0:t,o=e.right,r=void 0===o?0:o,c=e.bottom,i=void 0===c?0:c,a=e.left,l=void 0===a?0:a;return"".concat(n,"px ").concat(r,"px ").concat(i,"px ").concat(l,"px")}function WS(e,t){return Array.isArray(t)?t.map((function(t){return e.controller.run("getI18nText",Object(O.a)(Object(O.a)({},e),{},{key:t}))})):e.controller.run("getI18nText",Object(O.a)(Object(O.a)({},e),{},{key:t.toUpperCase()}))}function ZS(e){return(e.top+e.bottom)/2}function YS(e,t){return(e.x+t.x)/2}function JS(e,t){return(e.y+t.y)/2}function XS(e){return[(e.left+e.right)/2,(e.top+e.bottom)/2]}function qS(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=e.getBoundingClientRect(),r=t.getBoundingClientRect(),c=XS(r),i=XS(o);i[0]=(i[0]-c[0])/n,i[1]=(i[1]-c[1])/n;var a=o.width/n,l=o.height/n;return{left:i[0]-a/2,right:i[0]+a/2,top:i[1]-l/2,bottom:i[1]+l/2,width:a,height:l}}function QS(e,t){var n=e.getBoundingClientRect(),o=XS(t.getBoundingClientRect()),r=XS(n);return[r[0]-o[0],r[1]-o[1]]}function $S(e){return Object(o.createElement)("div",null,e.children,Object(o.createElement)(b.h,{style:{margin:"10px 0"}}))}function eC(e){var t=e.title,n=e.layout,r=void 0===n?"h":n,c=e.color,i=e.handleColorChange,a={flexDirection:"h"===r?"row":"column",alignItems:"center"};return Object(o.createElement)(wk,null,Object(o.createElement)(bk,Object.assign({},a),null!=t&&Object(o.createElement)(gk,{margin:"0 5px 0 0"},t),Object(o.createElement)(b.s,null,Object(o.createElement)(Ik,null,Object(o.createElement)("div",{className:Gk(Ak)}),Object(o.createElement)(Lk,{color:c})),Object(o.createElement)("div",null,Object(o.createElement)(rt.a,{color:c,onChangeComplete:function(e){return i(e.hex)}})))))}function tC(e){var t=e.title,n=Object(wa.a)(e,ok);return Object(o.createElement)(wk,null,Object(o.createElement)(b.d,Object.assign({},n),t))}function nC(e){var t=e.layout,n=void 0===t?"h":t,r=e.title,c=Object(wa.a)(e,rk),i={flexDirection:"h"===n?"row":"column",alignItems:"center"};return Object(o.createElement)(wk,null,Object(o.createElement)(bk,Object.assign({},i),Object(o.createElement)(gk,{margin:"0 5px 0 0"},r),Object(o.createElement)(b.q,Object.assign({},c))))}function oC(e){var t=e.layout,n=void 0===t?"h":t,r=e.title,c=Object(wa.a)(e,ck),i={flexDirection:"h"===n?"row":"column",alignItems:"center"};return Object(o.createElement)(wk,null,Object(o.createElement)(bk,Object.assign({},i),Object(o.createElement)(gk,{margin:"0 5px 0 0"},r," "),Object(o.createElement)(b.m,Object.assign({},c))))}function rC(e){var t=e.text,n=e.items,r=e.itemRenderer,c=e.onItemSelect,i=ot.a.ofType(),a={items:n,itemRenderer:r,onItemSelect:c,filterable:!1};return Object(o.createElement)(wk,null,Object(o.createElement)(i,Object.assign({},a),Object(o.createElement)(b.d,{text:t})))}var cC=function(e){return function(t,n){var r=n.handleClick;return Object(o.createElement)(b.p,{text:"".concat(t).concat(e),key:t,onClick:r})}},iC=function(e){return function(t,n){var r=n.handleClick;return Object(o.createElement)(b.p,{text:WS(e,t),key:t,onClick:r})}},aC=(ot.a.ofType(),Object(v.a)(Array(7).keys())),lC=d.default.div(jE||(jE=Object(Ka.a)(["\n  position: relative;\n  padding: 6px;\n  width: 40px;\n  height: 40px;\n  cursor: pointer;\n  color: ",";\n  font-size: 24px;\n  display: inline-block;\n  &:hover {\n    color: ",";\n  }\n"])),(function(e){return e.disabled?"grey":"black"}),(function(e){return e.disabled?"grey":"rgb(44, 184, 146)"}));function uC(e){var t=e.controller,n=e.children,r=e.onClick,c=Object(wa.a)(e,ik),i=e.disabled;i=i||!t.getValue(dx,e);var a=Object(O.a)({controller:t,disabled:i,onClick:function(e){i||r(e)}},c);return Object(o.createElement)(lC,Object.assign({},a),n)}var sC=y()("plugin:event");function pC(){var e={};return{handleTopicClick:function(e){sC("handleTopicClick");var t=e.controller,n=e.model,o=e.topicKey;sC(n.zoomFactor),null===n.editingDescKey&&n.editingContentKey!==o&&(n.focusKey===o&&n.focusMode===pT||t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:ST,focusMode:sT})))},handleTopicDoubleClick:function(e){var t=e.controller;null===e.model.editingDescKey&&t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:ST,focusMode:pT}))},handleTopicContextMenu:function(e){e.controller.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:ST,focusMode:fT}))},handleActiveModalClose:function(e){var t=e.controller,n=t.run("getActiveModalProps",e);return null==n?null:"edit-desc"===n.name?function(){t.run("operation",Object(O.a)(Object(O.a)({},e),{},{focusMode:sT,opType:ST}))}:void 0},addEventListener:function(t){var n=t.key,o=t.listener,r=t.once,c=t.controller;function i(){o(),c.run("removeEventListener",{key:n,listener:o})}e[n]||(e[n]=[]),r?(i.origin=o,e[n].push(i)):e[n].push(o)},removeEventListener:function(t){var n=t.key,o=t.listener;e[n]&&(e[n]=e[n].filter((function(e){return e!==o&&e.origin!==o})))},fireEvent:function(t){var n=t.key;e[n]&&e[n].forEach((function(e){return e()}))}}}var dC="ADD_CHILD",fC="ADD_SIBLING",yC="DELETE_TOPIC",bC="EDIT_CONTENT",gC="EDIT_NOTES",hC="SET_EDITOR_ROOT",OC=0,mC=1;function vC(){return{customizeHotKeys:function(e){var t=function(t){return function(n){!function(e,t){var n=t,o=n.topicKey,r=n.model,c=n.controller;void 0===o&&(t=Object(O.a)(Object(O.a)({},t),{},{topicKey:r.focusKey})),c.run("operation",Object(O.a)(Object(O.a)({},t),{},{opType:e}))}(t,e)}};return{topicHotKeys:new Map([[dC,{label:"add child",combo:"tab",onKeyDown:t(ET)}],[fC,{label:"add sibling",combo:"enter",onKeyDown:t(kT)}],[yC,{label:"delete topic",combo:"del",onKeyDown:t(xT)}],[bC,{label:"edit content",combo:"space",onKeyDown:t(IT)}],[gC,{label:"edit notes",combo:"alt + d",onKeyDown:t(_T)}],[hC,{label:"set editor root",combo:"alt + shift + f",onKeyDown:t(AT)}]]),globalHotKeys:new Map}}}}function jC(){var e=new Map([[fx,"Confirm"],[yx,"Cancel"],[bx,"Default"],[gx,"Search"],[hx,"Left And Right"],[Ox,"Only Left"],[mx,"Only Right"],[vx,"Edit"],[Tx,"Add Child"],[jx,"Add Sibling"],[Ex,"Edit Notes"],[kx,"Delete"],[xx,"Set as Editor Root"],[Sx,"Edit Topology Diagram"],[Cx,"Set Topic References"],[wx,"TopicStyle"],[Rx,"Style"],[Kx,"Text Editor"],[Dx,"Link"],[Lx,"LinkToParent"],[Ix,"SubLinks"],[_x,"Copy Style"],[Mx,"Paste Style"],[Ax,"Clear Topic Style"],[Fx,"Clear All Custom Style"],[Px,"LineType"],[Nx,"Theme"],[Bx,"Global"],[zx,"Highlight"],[Vx,"Random Color"],[Hx,"NormalTopic"],[Gx,"PrimaryTopic"],[Ux,"RootTopic"],[Wx,"Export Theme"],[Zx,"Import Theme"],[Yx,"Tags"],[Jx,"Tags Manager"],[Xx,"Tag Name"],[qx,"Add Tag"],[Qx,"Update Tag"],[$x,"Already Added"],[eS,"Can be Added"],[tS,"Topics that Use this Tag"],[nS,"Background"],[oS,"Color"],[rS,"Border"],[cS,"Width"],[iS,"Radius"],[aS,"FontSize"],[lS,"LineHeight"],[uS,"Padding"],[sS,"Top"],[pS,"Bottom"],[dS,"Left"],[fS,"Right"],[yS,"None"],[bS,"Solid"],[gS,"Dotted"],[hS,"Dashed"],[OS,"Double"],[mS,"Round"],[vS,"Curve"],[jS,"Line"],[TS,"Collapse All"],[ES,"Expand All"],[kS,"Center Root Topic"],[xS,"zoom"],[SS,"Zoom In"],[CS,"Zoom Out"],[wS,"Reset"],[RS,"Reset Zoom"],[KS,"Write topic notes here"],[DS,"Topology Diagram Editor"],[LS,"Basic"],[IS,"Flow Graph"],[_S,"Activity Diagram"],[MS,"Sequence Diagram"],[AS,"Class Diagram"],[FS,"Reference Topics"],[PS,"Referenced Topics"],[NS,"Please select the topics you want to reference. After selection, click the confirm button."],[BS,"The length of tag name over the maximum length: 50!"],[zS,"All the relationship about this tag will be lost if you delete this tag! Are you confirm?"],[VS,"Are you confirm to delete this topology diagram?"]]);return{getI18nTextMap:function(){return e},getI18nText:function(e){var t=e.controller,n=e.key,o=t.run("getI18nTextMap",e);if(!o.has(n))throw new Error("i18n key ".concat(n," is not exist"));return o.get(n)}}}var TC=y()("plugin:operation");function EC(){var e=new Map([[mT,ZT.toggleCollapse],[vT,ZT.collapseAll],[jT,ZT.expandAll],[TT,ZT.expandTo],[ET,ZT.addChild],[kT,ZT.addSibling],[xT,ZT.deleteTopic],[ST,ZT.focusTopic],[CT,ZT.setFocusMode],[wT,ZT.setStyle],[RT,ZT.clearAllCustomStyle],[KT,ZT.setTheme],[DT,ZT.setBlockData],[LT,ZT.deleteBlock],[IT,function(e){var t=e.model,n=e.topicKey;return ZT.focusTopic({model:t,topicKey:n,focusMode:pT})}],[_T,function(e){var t=e.model,n=e.topicKey,o=t.getTopic(n).getBlock(uT);return null!=o.block&&null!=o.block.data||(t=ZT.setBlockData({model:t,topicKey:n,blockType:uT,data:""})),t=ZT.focusTopic({model:t,topicKey:n,focusMode:dT})}],[MT,function(e){var t=e.srcKey,n=e.dstKey,o=e.dropDir,r=e.model,c=r.getTopic(t),i=r.getTopic(n),a=c.parentKey,l=r.getTopic(a).subKeys,u=l.indexOf(t);if(l=l.delete(u),"in"===o){var s=i.subKeys;s=s.push(t),r=r.withMutations((function(e){e.setIn(["topics",a,"subKeys"],l).setIn(["topics",t,"parentKey"],n).setIn(["topics",n,"subKeys"],s).setIn(["topics",n,"collapse"],!1)}))}else{var p=i.parentKey,d=r.getTopic(p).subKeys,f=d.indexOf(n);if(a===p){var y=Object(j.List)();d.forEach((function(e){e!==t&&(y=e===n?"prev"===o?y.push(t).push(e):y.push(e).push(t):y.push(e))})),r=r.withMutations((function(e){e.setIn(["topics",p,"subKeys"],y)}))}else"prev"===o?d=d.insert(f,t):"next"===o&&(d=d.insert(f+1,t)),r=r.withMutations((function(e){e.setIn(["topics",a,"subKeys"],l).setIn(["topics",t,"parentKey"],p).setIn(["topics",p,"subKeys"],d).setIn(["topics",p,"collapse"],!1)}))}return r}],[AT,ZT.setEditorRootTopicKey],[FT,ZT.setLayoutDir]]),t=Object(j.Stack)(),n=Object(j.Stack)(),o=!0,r=new Set;return{isOperationEnabled:function(e){return o},enableOperation:function(){o=!0},disableOperation:function(e){var t=e.whiteList;o=!1,t?r=new Set(t):r.clear()},getOpMap:function(t){return e},getAllowUndo:function(e){var t=e.model,n=e.opType,o=e.allowUndo;if(!1===(void 0===o||o))return!1;if(n)switch(n){case ST:case CT:case IT:case _T:return!1}switch(t.focusMode){case"EDITING_DESC":case"EDITING_CONTENT":return!1}return t.config.allowUndo},getUndoRedoStack:function(){return{undoStack:t,redoStack:n}},setUndoStack:function(e){TC("setUndoStack",e.undoStack),t=e.undoStack},setRedoStack:function(e){TC("setRedoStack",e.redoStack),n=e.redoStack},canUndo:function(e){var t=e.controller;if(!t.run("isOperationEnabled",e))return!1;var n=t.run("getUndoRedoStack",e).undoStack,o=t.run("getAllowUndo",e);return n.size>0&&o},canRedo:function(e){var t=e.controller;if(!t.run("isOperationEnabled",e))return!1;var n=t.run("getUndoRedoStack",e).redoStack,o=t.run("getAllowUndo",e);return n.size>0&&o},undo:function(e){var t=e.controller,n=e.model;if(t.run("getAllowUndo",e)){var o=t.run("getUndoRedoStack",e),r=o.undoStack,c=o.redoStack,i=r.peek();i&&(t.run("setUndoStack",Object(O.a)(Object(O.a)({},e),{},{undoStack:r.shift()})),t.run("setRedoStack",Object(O.a)(Object(O.a)({},e),{},{redoStack:c.push(n)})),TC(i),t.change(i))}},redo:function(e){var t=e.controller,n=e.model;if(t.run("getAllowUndo",e)){var o=t.run("getUndoRedoStack",e),r=o.undoStack,c=o.redoStack,i=c.peek();i&&(t.run("setUndoStack",Object(O.a)(Object(O.a)({},e),{},{undoStack:r.push(n)})),t.run("setRedoStack",Object(O.a)(Object(O.a)({},e),{},{redoStack:c.shift()})),t.change(i))}},operation:function(e){var t=e.controller,n=e.opType,o=e.model,c=e.opArray,i=e.callback;if(null!=c&&!Array.isArray(c))throw new Error("operation: the type of opArray must be array!");if(null!=n&&null!=c)throw new Error("operation: opType and opArray conflict!");if(!t.run("isOperationEnabled",e)){if(0===r.size)return;if(null!=c){var a=c.filter((function(e){return!r.has(e.opType)}));if(a&&a.length>0)return}else if(!r.has(n))return}TC("operation:",n||c.map((function(e){return e.opType}))),TC("operation:",o),TC("operation:",e);var l,u=t.run("getOpMap",e);if(t.run("beforeOperation",e),t.run("getAllowUndo",e)){var s=t.run("getUndoRedoStack",e).undoStack;t.run("setUndoStack",Object(O.a)(Object(O.a)({},e),{},{undoStack:s.push(o)}))}if(null!=c)l=c.reduce((function(e,n){var o=n.opType;if(!u.has(o))throw new Error("opType:".concat(o," not exist!"));var r=u.get(o),c=Object(O.a)(Object(O.a)({controller:t},n),{},{model:e}),i=t.run("beforeOpFunction",c);return i=r(Object(O.a)(Object(O.a)({},c),{},{model:i})),i=t.run("afterOpFunction",Object(O.a)(Object(O.a)({},c),{},{model:i}))}),o);else{if(!u.has(n))throw new Error("opType:".concat(n," not exist!"));var p=u.get(n);l=t.run("beforeOpFunction",e),l=p(Object(O.a)(Object(O.a)({},e),{},{model:l})),l=t.run("afterOpFunction",Object(O.a)(Object(O.a)({},e),{},{model:l}))}TC("newModel:",l),t.change(l,i?i(l):null),t.run("afterOperation",e)},deleteRefKey:function(e){var t=e.model,n=e.topicKey,o=e.deleteRef,r=HT(t,n);r.push(n);var c,i=Object(m.a)(r);try{for(i.s();!(c=i.n()).done;){var a=c.value;o(qk(a)),o(Qk(a)),o(Wk(a)),o(Zk(a)),o(Yk(a)),o(Jk(a)),o(Xk(a)),o($k(a)),o(ex(a,"next")),o(ex(a,"prev"))}}catch(l){i.e(l)}finally{i.f()}},beforeOperation:function(e){},afterOperation:function(e){},beforeOpFunction:function(e){var t=e.controller,n=e.opType,o=e.model,r=e.topicKey;return n===xT&&r!==o.editorRootTopicKey&&t.run("deleteRefKey",e),o},afterOpFunction:function(e){return e.model},openNewModel:function(e){var t=e.model,n=e.controller,o=e.newModel;n.run("deleteRefKey",Object(O.a)(Object(O.a)({},e),{},{topicKey:t.rootTopicKey})),n.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:TT,topicKey:o.focusKey,model:o,callback:function(t){return function(){n.run("moveTopicToCenter",Object(O.a)(Object(O.a)({},e),{},{model:t,topicKey:t.focusKey}))}}}))}}}var kC=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.controller;return Object(o.createElement)(b.n,null,e.run("customizeTopicContextMenu",this.props))}}]),n}(lk),xC=[{icon:"edit",label:vx,shortcut:"Space",rootCanUse:!0,opType:IT},{icon:"add-sibling",label:jx,shortcut:"Enter",opType:kT},{icon:"add-child",label:Tx,shortcut:"Tab",rootCanUse:!0,opType:ET},{icon:"notes",label:Ex,shortcut:"Alt + D",rootCanUse:!0,opType:_T},{icon:"delete-node",label:kx,shortcut:"Del",opType:xT},{icon:"root",label:xx,shortcut:"Alt + Shift + F",opType:AT}];function SC(){return{renderTopicContextMenu:function(e){return Object(o.createElement)(kC,Object.assign({},e))},customizeTopicContextMenu:function(e){var t=e.topicKey,n=e.model,r=e.controller,c=t===n.editorRootTopicKey;function i(t){return function(n){t.opType&&r.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:t.opType}))}}return xC.map((function(t){return c&&!t.rootCanUse?null:Object(o.createElement)(b.p,{key:t.label,icon:Uk(t.icon),text:WS(e,t.label),labelElement:Object(o.createElement)("kbd",null,t.shortcut),onClick:i(t)})}))}}}var CC=y()("node:topic-drop-effect"),wC=d.default.svg(TE||(TE=Object(Ka.a)(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"]))),RC=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).state={content:null},e}return Object(l.a)(n,[{key:"layout",value:function(){var e=this.props,t=e.getRef,n=e.model,r=e.zoomFactor,c=e.diagramState.dragDrop;if(null!=c){var i=c.targetKey,a=c.targetDir;if(CC("layout",a),null!=i){var l=t("in"===a?Wk(i):ex(i,a)),u=t("svg-drop-effect"),s=t(nx).bigView,p=qS(l,s,r),d=qS(u,s,r),f=p.left-d.left-3,y=p.top-d.top-3,b=p.width+6,g=p.height+6;this.setState({content:Object(o.createElement)("g",null,Object(o.createElement)("rect",{x:f,y:y,width:b,height:g,fill:"none",stroke:n.config.theme.highlightColor,strokeDasharray:"5,5",strokeWidth:2}))})}else this.setState({content:null})}else this.setState({content:null})}},{key:"render",value:function(){var e=this.props.saveRef;return Object(o.createElement)(wC,{ref:e("svg-drop-effect")},this.state.content)}}]),n}(lk),KC=y()("plugin:drag-and-drop"),DC=d.default.div(EE||(EE=Object(Ka.a)(["\n  height: ",";\n  width: 100%;\n  margin: 5px 0px;\n"])),(function(e){return"".concat(e.height,"px")}));function LC(){return{renderTopicDropArea:function(e){var t=e.topicKey,n=e.dropDir,r=e.saveRef,c=e.controller,i=e.model,a={onDragEnter:function(o){KC("onDragEnter",t,n),c.run("handleTopicDragEnter",Object(O.a)(Object(O.a)({},e),{},{ev:o,dropDir:n}))},onDragLeave:function(o){KC("onDragLeave",t,n),c.run("handleTopicDragLeave",Object(O.a)(Object(O.a)({},e),{},{ev:o,dropDir:n}))},onDragOver:function(e){e.preventDefault()},onDrop:function(o){KC("onDrop",t,n),c.run("handleTopicDrop",Object(O.a)(Object(O.a)({},e),{},{ev:o,dropDir:n}))}};return Object(o.createElement)(DC,Object.assign({height:i.config.theme.marginV/2,ref:r(ex(t,n))},a))},renderDragAndDropEffect:function(e){KC("renderDragAndDropEffect");var t=e.saveRef;return Object(o.createElement)(RC,Object.assign({ref:t(cx)},e))},handleTopicDragStart:function(e){var t=e.controller;e.ev.stopPropagation(),t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:ST,focusMode:yT}))},canDrop:function(e){var t=e.srcKey,n=e.dstKey,o=e.model,r=e.dropDir;return t!==o.editorRootTopicKey&&t!==n&&GT(o,t,n)!==bT&&((n!==o.editorRootTopicKey||"in"===r)&&(o.getTopic(t).parentKey!==n||"in"!==r))},handleTopicDragEnter:function(e){var t=e.dropDir,n=e.topicKey,o=e.controller,r=e.model,c=e.diagramState,i=e.setDiagramState;KC("handleTopicDragEnter:",n,t),o.run("canDrop",Object(O.a)(Object(O.a)({},e),{},{srcKey:r.focusKey,dstKey:n}))&&i(Object(O.a)(Object(O.a)({},c),{},{dragDrop:{targetKey:n,targetDir:t}}))},handleTopicDragLeave:function(e){var t=e.topicKey,n=e.dropDir,o=e.getRef,r=e.ev,c=e.diagramState,i=e.setDiagramState,a=r.nativeEvent.relatedTarget;KC("handleTopicDragLeave:",t,n);var l=o(Wk(t));l==a||l.contains(a)||i(Object(O.a)(Object(O.a)({},c),{},{dragDrop:null}))},handleTopicDrop:function(e){KC("handleTopicDrop");var t=e,n=t.controller,o=t.topicKey,r=t.model,c=t.diagramState,i=t.setDiagramState;e=Object(O.a)(Object(O.a)({},e),{},{srcKey:r.focusKey,dstKey:o}),i(Object(O.a)(Object(O.a)({},c),{},{dragDrop:null})),n.run("canDrop",e)&&n.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:MT}))}}}function IC(e,t,n,o){var r,c=arguments.length,i=c<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(c<3?r(i):c>3?r(t,n,i):r(t,n))||i);return c>3&&i&&Object.defineProperty(t,n,i),i}var _C=d.default.div(kE||(kE=Object(Ka.a)(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 5px;\n"]))),MC=d.default.div(xE||(xE=Object(Ka.a)(["\n  width: 100%;\n  height: 100%;\n  background: ",";\n"])),(function(e){return e.theme.background})),AC=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).setZoomFactor=function(e){o.dragScrollWidget.setZoomFactor(e)},o.onWheel=function(e){if(e.altKey||e.ctrlKey){var t=o.props.controller,n=t.run("getZoomFactor",o.props);(n-=e.nativeEvent.deltaY>0?.1:-.1)<.5&&(n=.5),n>4&&(n=4),t.run("setZoomFactor",Object(O.a)(Object(O.a)({},o.props),{},{zoomFactor:n}))}},o}return Object(l.a)(n,[{key:"renderHotkeys",value:function(){var e=this.props,t=e.controller,n=e.model,r=t.run("customizeHotKeys",e);if(null===r)return null;if(!(r.topicHotKeys instanceof Map&&r.globalHotKeys instanceof Map))throw new TypeError("topicHotKeys and globalHotKeys must be a Map");var c=[];return n.focusMode!==sT&&n.focusMode!==fT||r.topicHotKeys.forEach((function(e,t){c.push(Object(o.createElement)(b.j,Object.assign({key:t},e,{global:!0})))})),r.globalHotKeys.forEach((function(e,t){c.push(Object(o.createElement)(b.j,Object.assign({key:t},e,{global:!0})))})),Object(o.createElement)(b.k,null,c)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.getRef,n=e.model;e.controller.run("addZoomFactorChangeEventListener",Object(O.a)(Object(O.a)({},this.props),{},{listener:this.setZoomFactor}));var o=t(Xk(n.editorRootTopicKey)),r=t("node-layer"),c=o.getBoundingClientRect(),i=r.getBoundingClientRect();this.dragScrollWidget.setViewBoxScrollDelta(0,c.top-i.top-this.dragScrollWidget.viewBox.getBoundingClientRect().height/2+c.height),this.layout()}},{key:"componentWillUnmount",value:function(){this.props.controller.run("removeZoomFactorChangeEventListener",Object(O.a)(Object(O.a)({},this.props),{},{listener:this.setZoomFactor}))}},{key:"dragScrollWidget",get:function(){return this.props.getRef(nx)}},{key:"componentDidUpdate",value:function(){this.props.controller.run("fireEvent",Object(O.a)(Object(O.a)({},this.props),{},{key:ix})),this.layout()}},{key:"layout",value:function(){this.props.controller.run("layout",this.props)}},{key:"render",value:function(){var e=this,t=this.props,n=t.saveRef,r=t.model,c=t.controller,i=r.editorRootTopicKey;return Object(o.createElement)(MC,{onWheel:this.onWheel},Object(o.createElement)(dk,Object.assign({},this.state,{enableMouseWheel:!1,zoomFactor:r.zoomFactor,ref:n(nx)}),(function(t,r){var a=Object(O.a)(Object(O.a)({},e.props),{},{topicKey:i,setViewBoxScroll:t,setViewBoxScrollDelta:r});return Object(o.createElement)(_C,{ref:n("node-layer")},c.run("renderRootWidget",a))})))}}]),n}(o.PureComponent);AC=IC([b.l],AC);var FC=d.default.div(SE||(SE=Object(Ka.a)(["\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: 100%;\n"]))),PC=d.default.div(CE||(CE=Object(Ka.a)(["\n  width: 100%;\n  //height: 100%;\n  overflow: auto;\n  flex-grow: 1;\n  background: ",";\n  position: relative;\n"])),(function(e){return e.theme.background}));function NC(e){var t=e.controller,n=e.saveRef,r=Object(o.useState)(t.run("getInitialDiagramState",e)),c=Object(Ca.a)(r,2),i=c[0],a=c[1],l=Object(O.a)(Object(O.a)({},e),{},{diagramState:i,setDiagramState:a});return Object(o.createElement)(FC,null,t.run("renderToolbar",e),Object(o.createElement)(PC,{ref:n(tx)},Object(o.createElement)(AC,Object.assign({},l)),t.run("renderDiagramCustomize",l)))}var BC=Object(d.default)(kk)(wE||(wE=Object(Ka.a)(["\n  position: absolute;\n  width: 20%;\n  padding: 0 5px;\n  background: white;\n  left: 30px;\n  top: 20px;\n  border-radius: 2px;\n"]))),zC=d.default.div(RE||(RE=Object(Ka.a)(["\n  max-width: 600px;\n"]))),VC=d.default.span(KE||(KE=Object(Ka.a)([""]))),HC=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).setEditorRootTopicKey=function(e){return function(){var t=r.props,n=t.model,o=t.controller;n.editorRootTopicKey!==e&&o.run("operation",Object(O.a)(Object(O.a)({},r.props),{},{opType:AT,topicKey:e}))}},r.breadcrumbRenderer=function(e){var t=e.text,n=Object(wa.a)(e,ak),r=t.length>8,c=r?t.substr(0,8)+"...":t,i={content:Object(o.createElement)(zC,null,t),position:b.u.BOTTOM_RIGHT},a=Object(o.createElement)(b.b,Object.assign({},n),Object(o.createElement)(VC,null,c));return r?Object(o.createElement)(b.x,Object.assign({},i),a):a},r}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.model,n=e.controller,r=e.zIndex,c=t.editorRootTopicKey;if(c===t.rootTopicKey)return null;for(var i=[],a=t.getTopic(c);null!=a;){var l=n.getValue(ux,Object(O.a)(Object(O.a)({},e),{},{topicKey:a.key}));i.unshift({text:l,onClick:this.setEditorRootTopicKey(a.key)}),a=t.getTopic(a.parentKey)}var u={items:i,breadcrumbRenderer:this.breadcrumbRenderer};return Object(o.createElement)(BC,{zIndex:r},Object(o.createElement)(b.c,Object.assign({},u)))}}]),n}(lk),GC=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).handleClose=function(){var t=e.props.controller.run("handleActiveModalClose",e.props);t&&t()},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.controller,t=e.run("renderModal",this.props),n=e.run("getActiveModalProps",this.props);return Object(o.createElement)(b.g,{onClose:this.handleClose,isOpen:null!==t,autoFocus:!0,enforceFocus:!0,usePortal:!0,title:n&&n.title,style:n&&n.style},Object(o.createElement)("div",{className:g.a.DIALOG_BODY,style:{minHeight:0}},t))}}]),n}(lk),UC=d.default.svg(DE||(DE=Object(Ka.a)(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"]))),WC=y()("node:root-sub-links"),ZC=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).state={curves:[]},e}return Object(l.a)(n,[{key:"layout",value:function(){var e,t,n,r=this.props,c=r.model,i=r.getRef,a=r.topicKey,l=r.zoomFactor,u=r.controller,s=c.getTopic(a),p=i(Wk(a)),d=i(Qk(a)),f=i(nx).bigView,y=qS(p,f,l),b=qS(d,f,l);e={x:(n=y,(n.left+n.right)/2-b.left),y:ZS(y)-b.top};var g=[];s.subKeys.forEach((function(n){var c,a=u.run("getLinkStyle",Object(O.a)(Object(O.a)({},r),{},{topicKey:n})),s=a.lineType,p=qS(i(Wk(n)),f,l);if(t={x:(t=p.left>y.right?{x:p.left,y:ZS(p)}:{x:p.right,y:ZS(p)}).x-b.left,y:t.y-b.top},"curve"===s)c="M ".concat(e.x," ").concat(e.y," C ").concat(e.x," ").concat(JS(e,t)," ").concat(YS(e,t)," ").concat(t.y," ").concat(t.x," ").concat(t.y);else if("line"===s)c="M ".concat(e.x," ").concat(e.y," L ").concat(t.x," ").concat(t.y);else if("round"===s){var d=t.y>e.y?1:-1,h=t.x>e.x?1:-1,m=a.lineRadius;if(null==m)throw new Error("link line type is round, but lineRadius is not provided!");c=t.y===e.y?"M ".concat(e.x," ").concat(e.y," H ").concat(t.x):"M ".concat(e.x," ").concat(e.y,"  V ").concat(t.y-d*m," A ").concat(m," ").concat(m," 0 0 ").concat(d*h===1?0:1," ").concat(e.x+m*h," ").concat(t.y," H ").concat(t.x)}g.push(Object(o.createElement)("path",{key:"link-".concat(n),d:c,strokeWidth:a.lineWidth,stroke:a.lineColor,fill:"none"}))})),this.setState({curves:g})}},{key:"render",value:function(){WC("render");var e=this.props,t=e.topicKey,n=e.saveRef;return Object(o.createElement)(UC,{ref:n(Qk(t))},Object(o.createElement)("g",null,this.state.curves))}}]),n}(lk),YC=y()("RootNode"),JC=d.default.div(LE||(LE=Object(Ka.a)(["\n  display: flex;\n  position: relative;\n\n  align-items: ",";\n  flex-direction: column;\n\n  padding: ",";\n"])),(function(e){return e.topicDirection===oT?"flex-end":"flex-start"}),(function(e){return e.topicDirection===oT?"15px 60px 15px 0px":"15px 0px 15px 60px"})),XC=d.default.div(IE||(IE=Object(Ka.a)(["\n  display: flex;\n  position: relative;\n  align-items: center;\n  z-index: 3;\n"]))),qC=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"renderPartTopics",value:function(e,t){var n=this.props,r=n.controller,c=n.saveRef,i=r.run("createSubTopics",Object(O.a)(Object(O.a)({},this.props),{},{dir:t,isRoot:!0,topics:e}));if(!i)return null;var a=i.subTopics,l="bm-layer-".concat(t===oT?"left":"right");return Object(o.createElement)(JC,{topicDirection:t,ref:c(l)},a)}},{key:"render",value:function(){YC("render");var e=this.props,t=e.model,n=e.topicKey,r=e.saveRef,c=e.controller,i=c.run("getTopicContentStyle",e),a=t.config,l=c.run("renderTopicContent",Object(O.a)(Object(O.a)({},e),{},{topicStyle:i,dir:cT})),u=c.run("getPartTopics",{layout:a.layoutDir,model:t,topicKey:n}),s=Object(o.createElement)(XC,{ref:r(Xk(n))},l),p=c.run("renderRootWidgetOtherChildren",e);switch(a.layoutDir){case tT.LEFT_AND_RIGHT:return Object(o.createElement)(o.Fragment,null,this.renderPartTopics(u.L,"L"),s,this.renderPartTopics(u.R,"R"),p);case tT.LEFT_TO_RIGHT:return Object(o.createElement)(o.Fragment,null,s,this.renderPartTopics(u.R,"R"),p);case tT.RIGHT_TO_LEFT:return Object(o.createElement)(o.Fragment,null,this.renderPartTopics(u.L,"L"),s,p);case tT.TOP_TO_BOTTOM:return Object(o.createElement)(o.Fragment,null,s,this.renderPartTopics(u.B,"B"),p)}return null}}]),n}(o.Component),QC=d.default.div(_E||(_E=Object(Ka.a)(["\n  position: absolute;\n  top: calc(50% - 10px);\n  ",";\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  //@ts-ignore\n  background: ",";\n  cursor: pointer;\n  padding: 0;\n  font-size: 14px;\n  line-height: 20px;\n  border: 0;\n  z-index: 2;\n"])),(function(e){var t=e.dir;return t===rT?Object(d.css)(ME||(ME=Object(Ka.a)(["\n        right: -25px;\n      "]))):t===oT?Object(d.css)(AE||(AE=Object(Ka.a)(["\n        left: -25px;\n      "]))):void 0}),(function(e){return e.background}));function $C(e){var t=e.model,n=e.topicKey,r=e.topicStyle,c=e.dir,i=e.saveRef,a=e.onClickCollapse,l=t.getTopic(n);return l.subKeys.size>0?Object(o.createElement)(QC,{ref:i($k(n)),onClick:a,background:r.background,dir:c,className:nt()(Object(Sa.a)({icon:!0,iconfont:!0},"bm-".concat(l.collapse?"plus":"minus"),!0))}):null}var ew=y()("node:topic-content2"),tw=d.default.div(FE||(FE=Object(Ka.a)(["\n  position: relative;\n"]))),nw=d.default.div(PE||(PE=Object(Ka.a)(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: auto;\n  z-index: 10;\n  color: black;\n"]))),ow=function(e){ew("cancelEvent"),e.preventDefault(),e.stopPropagation()};function rw(e){var t,n=e.controller,r=e.model,c=e.topicKey,i=e.getRef,a=r.editingContentKey!==c,l=n.run("renderTopicContentEditor",Object(O.a)(Object(O.a)({},e),{},{readOnly:a}));if(a)t=l;else{var u,s={width:50,height:40},d=i("content-editor-".concat(c));d&&(s=d.getBoundingClientRect());var f=new p.a((function(e,t){var n=e[0].contentRect;u.style.left=(s.width-n.width)/2+"px",u.style.top=(s.height-n.height)/2+"px"}));ew(s),t=Object(o.createElement)(o.Fragment,null,Object(o.createElement)("div",{style:{width:s.width,height:s.height}}),Object(o.createElement)(nw,{ref:function(e){e&&(u=e,f.observe(u))}},l))}return Object(o.createElement)(tw,{onDragEnter:ow,onDragOver:ow},t)}var cw=y()("node:topic-content-widget"),iw=d.default.div(NE||(NE=Object(Ka.a)(["\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  //overflow: hidden;\n  position: relative;\n"]))),aw=d.default.div(BE||(BE=Object(Ka.a)(["\n  position: relative;\n"]))),lw=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).onDragStart=function(e){o.run("handleTopicDragStart",Object(O.a)(Object(O.a)({},o.props),{},{ev:e}))},o.onDragOver=function(e){e.preventDefault()},o.onDragEnter=function(e){cw("onDragEnter",o.props.topicKey),o.run("handleTopicDragEnter",Object(O.a)(Object(O.a)({},o.props),{},{ev:e,dropDir:"in"}))},o.onDragLeave=function(e){o.run("handleTopicDragLeave",Object(O.a)(Object(O.a)({},o.props),{},{ev:e,dropDir:"in"}))},o.onDrop=function(e){cw("onDrop"),o.run("handleTopicDrop",Object(O.a)(Object(O.a)({},o.props),{},{ev:e,dropDir:"in"}))},o.onClick=function(e){var t=o.props.controller;o.handleTopicClickTimeout=setTimeout((function(){t.run("handleTopicClick",Object(O.a)(Object(O.a)({},o.props),{},{ev:e}))}),200)},o.onDoubleClick=function(e){clearTimeout(o.handleTopicClickTimeout),o.props.controller.run("handleTopicDoubleClick",Object(O.a)(Object(O.a)({},o.props),{},{ev:e}))},o.needRelocation=!1,o.onClickCollapse=function(e){e.stopPropagation();var t=o.props,n=t.topicKey,r=t.getRef;o.needRelocation=!0;var c=r($k(n)).getBoundingClientRect();cw("oldRect",c),o.oldCollapseIconVector=[c.left+c.width/2,c.top+c.height/2],cw("oldCollapseIconVector",o.oldCollapseIconVector),o.operation(mT,o.props)},o.state={dragEnter:!1},o}return Object(l.a)(n,[{key:"renderContextMenu",value:function(){var e=this.props.controller;if(e.getValue(lx,Object(O.a)({},this.props)))return this.operation(ST,Object(O.a)(Object(O.a)({},this.props),{},{focusMode:fT})),e.run("renderTopicContextMenu",this.props)}},{key:"onContextMenuClose",value:function(){}},{key:"componentDidUpdate",value:function(){if(this.needRelocation){var e=this.props,t=e.getRef,n=e.topicKey,o=e.setViewBoxScrollDelta,r=t($k(n)).getBoundingClientRect(),c=[r.left+r.width/2,r.top+r.height/2];cw("newVector:",c),cw("oldVector:",this.oldCollapseIconVector);var i=[c[0]-this.oldCollapseIconVector[0],c[1]-this.oldCollapseIconVector[1]];cw("vector",i),o(i[0],i[1]),this.needRelocation=!1}}},{key:"render",value:function(){var e=this.props,t=e.saveRef,n=e.topicKey,r=e.model,c=e.controller,i=e.topicStyle,a=e.dir;cw("render",n,r.focusMode);var l=c.run("isOperationEnabled",e)&&r.editingContentKey!==n,u=c.run("renderTopicCollapseIcon",Object(O.a)(Object(O.a)({},e),{},{onClickCollapse:this.onClickCollapse.bind(this)})),s=c.run("renderTopicDropArea",Object(O.a)(Object(O.a)({},e),{},{dropDir:"prev"})),p=c.run("renderTopicDropArea",Object(O.a)(Object(O.a)({},e),{},{dropDir:"next"})),d={onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDragOver:this.onDragOver,onDrop:this.onDrop};return Object(o.createElement)(aw,null,s,Object(o.createElement)(iw,Object.assign({style:i,draggable:l,ref:t(Wk(n)),onDragStart:this.onDragStart,onClick:this.onClick,onDoubleClick:this.onDoubleClick},d),c.run("renderTopicBlocks",e),c.run("renderTopicContentOthers",e)),p,a!==cT&&u)}}]),n}(lk);lw=IC([b.f],lw);var uw=y()("node:topic-desc"),sw=d.default.div(zE||(zE=Object(Ka.a)(["\n  overflow: auto;\n"])));function pw(e){var t=e.controller,n=e.model,r=e.topicKey,c=e.getRef,i=n.editingDescKey===r;uw("isEditing",i);var a=n.getTopic(r).getBlock(uT);if(!i&&t.run("isBlockEmpty",Object(O.a)(Object(O.a)({},e),{},{block:a.block})))return null;var l=t.run("renderTopicDescEditor",e),u=c(tx),s={maxWidth:"800px",maxHeight:"600px"};if(u){var p=u.getBoundingClientRect();s.maxWidth="".concat(.6*p.width,"px"),s.maxHeight="".concat(.8*p.height,"px")}var d={autoFocus:!1,content:Object(o.createElement)(sw,{onClick:HS,classname:g.a.POPOVER_DISMISS,style:s},l),target:Object(o.createElement)(Ek,{onClick:function(n){n.stopPropagation(),t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:_T}))},className:Gk(Fk),tabIndex:-1}),interactionKind:b.t.HOVER,hoverOpenDelay:500};return a.block&&Object(o.createElement)(b.s,Object.assign({},d))}var dw=d.default.svg(VE||(VE=Object(Ka.a)(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n"]))),fw=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).state={content:null},e}return Object(l.a)(n,[{key:"layout",value:function(){var e=this.props,t=e.getRef,n=e.model,r=e.zoomFactor,c=n.focusKey,i=n.focusMode;if(c&&i!==pT){var a=t(Wk(c)),l=t(nx).bigView,u=t(ox),s=qS(a,l,r),p=qS(u,l,r),d=s.left-p.left-3,f=s.top-p.top-3,y=s.width+6,b=s.height+6;this.setState({content:Object(o.createElement)("rect",{x:d,y:f,width:y,height:b,fill:"none",stroke:n.config.theme.highlightColor,strokeWidth:2})})}else this.setState({content:null})}},{key:"render",value:function(){var e=this.props.saveRef;return Object(o.createElement)(dw,{ref:e(ox)},this.state.content)}}]),n}(lk),yw=d.default.svg(HE||(HE=Object(Ka.a)(["\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n"]))),bw=y()("node:topic-sub-links"),gw=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).state={curves:[]},e}return Object(l.a)(n,[{key:"layout",value:function(){var e,t,n,r=this.props,c=r.model,i=r.getRef,a=r.topicKey,l=r.dir,u=r.controller,s=u.run("getZoomFactor",r),p=c.getTopic(a),d=i(Wk(a)),f=i(Qk(a)),y=i($k(a)),b=i(nx).bigView,g=qS(f,b,s),h=qS(y,b,s),m=qS(d,b,s);bw(a),bw("svgRect",g),bw("collapseRect",h),bw("contentRect",m),l===rT?(e={x:0,y:ZS(m)-g.top},t={x:h.right-g.left+10,y:e.y}):l===oT&&(e={x:g.right-g.left,y:ZS(m)-g.top},t={x:h.left-g.left-10,y:e.y});var v=[];p.subKeys.forEach((function(c){var a,d=u.run("getLinkStyle",Object(O.a)(Object(O.a)({},r),{},{topicKey:c})),f=i(Wk(c));if(f){var y=qS(f,b,s);l===rT&&(n={x:y.left-g.left,y:ZS(y)-g.top}),l===oT&&(n={x:y.right-g.left,y:ZS(y)-g.top});var h=d.lineType;if("curve"===h)a="M ".concat(e.x," ").concat(e.y," L ").concat(t.x," ").concat(t.y," C ").concat(t.x," ").concat(JS(t,n)," ").concat(YS(t,n)," ").concat(n.y," ").concat(n.x," ").concat(n.y);else if("round"===h){var m=n.y>e.y?1:-1,j=n.x>e.x?1:-1,T=d.lineRadius;a=1===p.subKeys.size||Math.abs(n.y-e.y)<=1?"M ".concat(e.x," ").concat(e.y," L ").concat(n.x," ").concat(n.y):"M ".concat(e.x," ").concat(e.y," H ").concat(t.x," V ").concat(n.y-m*T," A ").concat(T," ").concat(T," 0 0 ").concat(m*j===1?0:1," ").concat(t.x+T*j," ").concat(n.y," H ").concat(n.x)}else"line"===h&&(a="M ".concat(e.x," ").concat(e.y," H ").concat(t.x," L ").concat(n.x," ").concat(n.y));v.push(Object(o.createElement)("path",{key:"link-".concat(c),d:a,strokeWidth:d.lineWidth,stroke:d.lineColor,fill:"none"}))}})),this.setState({curves:v})}},{key:"render",value:function(){var e=this.props,t=e.topicKey,n=e.saveRef;return Object(o.createElement)(yw,{ref:n(Qk(t))},Object(o.createElement)("g",null,this.state.curves))}}]),n}(lk),hw=y()("node:topic-widget"),Ow=d.default.div(GE||(GE=Object(Ka.a)(["\n  display: flex;\n  align-items: center;\n  flex-direction: ",";\n"])),(function(e){return e.topicDirection===rT?"row":"row-reverse"})),mw=d.default.div(UE||(UE=Object(Ka.a)(["\n  position: relative;\n  padding: ",";\n"])),(function(e){return e.dir===rT?"0 0 0 ".concat(e.marginH,"px"):"0 ".concat(e.marginH,"px 0 0")})),vw=d.default.div(WE||(WE=Object(Ka.a)(["\n  display: flex;\n  position: relative;\n  align-items: center;\n\n  flex-direction: ",";\n"])),(function(e){return e.topicDirection===rT?"row":"row-reverse"})),jw=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"renderSubTopics",value:function(){var e=this.props,t=e.controller,n=e.model,r=e.topicKey,c=e.dir,i=n.getTopic(r).subKeys.toArray(),a=t.run("createSubTopics",Object(O.a)(Object(O.a)({},e),{},{topics:i}));if(!a)return null;var l=a.subTopics,u=t.run("renderSubLinks",e);return Object(o.createElement)(mw,{dir:c,marginH:n.config.theme.marginH},l," ",u)}},{key:"layoutLinks",value:function(){var e=this.props,t=e.getRef,n=e.topicKey,o=e.model.getTopic(n);if(0!==o.subKeys.size&&!o.collapse){hw("layoutLinks",n);var r=t(qk(n));r&&r.layout()}}},{key:"render",value:function(){var e=this.props,t=e.controller,n=e.topicKey,r=e.dir,c=e.saveRef;hw("render",n);var i=t.run("getTopicContentStyle",e),a=Object(O.a)(Object(O.a)({},e),{},{topicStyle:i}),l=t.run("renderTopicContent",a);return Object(o.createElement)(Ow,{topicDirection:r},Object(o.createElement)(vw,{topicDirection:r,ref:c(Xk(n))},l),this.renderSubTopics())}}]),n}(o.Component),Tw=y()("node:view-port-viewer"),Ew=Object(d.default)(kk)(ZE||(ZE=Object(Ka.a)(["\n  position: absolute;\n  background: white;\n  right: 30px;\n  bottom: 20px;\n  border-radius: 2px;\n  display: flex;\n  flex-direction: row;\n  user-select: none;\n"]))),kw=Object(d.default)(mk)(YE||(YE=Object(Ka.a)(["\n  margin: 10px;\n"]))),xw=d.default.span(JE||(JE=Object(Ka.a)(["\n  display: inline-block;\n  width: 80px;\n  height: 18px;\n"]))),Sw=function(e){return Object(o.createElement)(b.x,{content:e.tooltip,position:h.a.TOP,className:g.a.ICON},Object(o.createElement)(kw,{onClick:e.onClick,tabIndex:-1},e.children))},Cw=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).zoomFactorChange=function(e){Tw("zoomFactorChange",e),o.setState({zoomFactor:e})},o.onClickResetZoom=function(e){var t=o.props;t.controller.run("setZoomFactor",Object(O.a)(Object(O.a)({},t),{},{zoomFactor:1}))},o.onClickAddZoom=function(e){var t=o.props,n=t.controller,r=n.run("getZoomFactor",t);n.run("setZoomFactor",Object(O.a)(Object(O.a)({},t),{},{zoomFactor:r+.1}))},o.onClickMinusZoom=function(e){var t=o.props,n=t.controller,r=n.run("getZoomFactor",t);n.run("setZoomFactor",Object(O.a)(Object(O.a)({},t),{},{zoomFactor:r-.1}))},o.onClickCollapseAll=function(e){var t=o.props,n=t.controller;n.run("addEventListener",Object(O.a)(Object(O.a)({},t),{},{key:ix,listener:o.centerRootTopic,once:!0})),n.run("operation",Object(O.a)(Object(O.a)({},t),{},{opType:vT}))},o.onClickExpandAll=function(e){var t=o.props,n=t.controller;n.run("addEventListener",Object(O.a)(Object(O.a)({},t),{},{key:ix,listener:o.centerRootTopic,once:!0})),n.run("operation",Object(O.a)(Object(O.a)({},t),{},{opType:jT}))},o.centerRootTopic=function(){var e=o.props,t=e.model;e.controller.run("moveTopicToCenter",Object(O.a)(Object(O.a)({},o.props),{},{topicKey:t.editorRootTopicKey}))},o}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this.props;e.controller.run("addZoomFactorChangeEventListener",Object(O.a)(Object(O.a)({},e),{},{listener:this.zoomFactorChange}))}},{key:"componentWillUnmount",value:function(){var e=this.props;e.controller.run("removeZoomFactorChangeEventListener",Object(O.a)(Object(O.a)({},e),{},{listener:this.zoomFactorChange}))}},{key:"render",value:function(){Tw("render");var e=this.props,t=e.controller,n=e.zIndex,r=t.run("getZoomFactor",e);return Object(o.createElement)(Ew,{zIndex:n},Object(o.createElement)(Sw,{onClick:this.onClickCollapseAll,tooltip:WS(e,TS)},Uk(Bk)),Object(o.createElement)(Sw,{onClick:this.onClickExpandAll,tooltip:WS(e,ES)},Uk(zk)),Object(o.createElement)(Sw,{onClick:this.centerRootTopic,tooltip:WS(e,kS)},Uk(Vk)),Object(o.createElement)(Sw,{onClick:this.onClickMinusZoom,tooltip:WS(e,SS)},Uk(Nk)),Object(o.createElement)(Sw,{onClick:this.onClickResetZoom,tooltip:WS(e,wS)},Object(o.createElement)(xw,null,"".concat(WS(e,xS),":").concat(Math.floor(100*r),"%"))),Object(o.createElement)(Sw,{onClick:this.onClickAddZoom,tooltip:WS(e,CS)},Uk(Pk)))}}]),n}(lk),ww=d.default.div(XE||(XE=Object(Ka.a)(["\n  overflow: auto;\n  padding: 0px 0px 0px 20px;\n  background: #88888850;\n"])));function Rw(e){var t=e.controller,n=e.model,r=e.topicKey;if(n.focusMode===dT){var c=t.run("renderTopicDescEditor",e);return Object(o.createElement)(b.i,{key:"drawer",title:WS(e,Ex),icon:Uk("note"),isOpen:!0,hasBackdrop:!0,backdropProps:{onMouseDown:HS},isCloseButtonShown:!1,onClose:function(n){n.stopPropagation();var o="topic-desc-data-".concat(r),c=t.run("deleteTempValue",{key:o});t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:DT,topicKey:r,blockType:uT,data:c,focusMode:sT}))},size:"70%"},Object(o.createElement)(ww,null,c))}}function Kw(e){var t=e.theme,n=e.children;return Object(o.createElement)(d.ThemeProvider,{theme:t},Object(o.createElement)(o.Fragment,null,n))}var Dw=y()("plugin:rendering");function Lw(){var e;return{getDiagramProps:function(){return e},renderDiagram:function(t){var n=t.model;return Object(o.createElement)(yk,null,(function(r,c,i){return e=Object(O.a)(Object(O.a)({},t),{},{saveRef:r,getRef:c,deleteRef:i}),Dw("renderDiagram",n),Object(o.createElement)(Kw,{theme:n.config.theme},Object(o.createElement)(NC,e))}))},renderDrawer:Rw,getInitialDiagramState:function(e){return{rightTopPanel:{isOpen:!1,selectedTabId:"topic-style"}}},renderDiagramCustomize:function(e){var t=e.controller,n=e.model,o=t.getValue(ax),r=Object(O.a)(Object(O.a)({},e),{},{zIndex:o,topicKey:n.focusKey});return[t.run("renderEditorRootBreadcrumbs",r),t.run("renderRightTopPanel",r),t.run("renderModals",Object(O.a)(Object(O.a)({},r),{},{zIndex:o+1})),t.run("renderDrawer",Object(O.a)(Object(O.a)({},r),{},{zIndex:o+1})),t.run("renderViewPortViewer",r)]},renderEditorRootBreadcrumbs:function(e){return Object(o.createElement)(HC,Object.assign({key:"EditorRootBreadcrumbs"},e))},renderModals:function(e){return Object(o.createElement)(GC,Object.assign({key:"modals"},e))},renderModal:function(e){return null},getActiveModalProps:function(e){return null},renderDoc:function(e){return e.children},renderRootWidget:function(e){return Object(o.createElement)(qC,Object.assign({},e))},renderTopicWidget:function(e){return Object(o.createElement)(jw,Object.assign({},e))},renderTopicContent:function(e){return Object(o.createElement)(lw,Object.assign({},e))},renderTopicCollapseIcon:function(e){return Object(o.createElement)($C,Object.assign({},e))},renderTopicContentOthers:function(e){return[]},renderTopicBlocks:function(e){var t=e.model,n=e.topicKey,r=e.controller,c=t.getTopic(n).blocks,i=[],a=0;return c.forEach((function(t){var n=r.run("renderTopicBlock",Object(O.a)(Object(O.a)({},e),{},{block:t,blockKey:"block-".concat(a)}));n&&(i.push(Object(o.createElement)(o.Fragment,{key:"block-".concat(a)},n)),a++)})),i},renderTopicBlock:function(e){var t=e.controller;switch(e.block.type){case lT:return t.run("renderTopicBlockContent",e);case uT:return t.run("renderTopicBlockDesc",e)}return null},renderTopicBlockContent:function(e){return Object(o.createElement)(rw,Object.assign({},e))},renderTopicBlockDesc:function(e){return Object(o.createElement)(pw,Object.assign({},e))},renderSubLinks:function(e){var t=e.saveRef,n=e.topicKey,r=e.model.getTopic(n);return 0===r.subKeys.size||r.collapse?null:Object(o.createElement)(gw,Object.assign({ref:t(qk(n))},e))},renderRootSubLinks:function(e){var t=e.saveRef,n=e.topicKey;return Object(o.createElement)(ZC,Object.assign({ref:t(qk(n))},e))},renderFocusItemHighlight:function(e){var t=e.saveRef;return Object(o.createElement)(fw,Object.assign({ref:t(rx)},e))},renderRootWidgetOtherChildren:function(e){var t=e.controller,n=t.run("getZoomFactor",e);return e=Object(O.a)(Object(O.a)({},e),{},{zoomFactor:n}),Object(o.createElement)(o.Fragment,null,t.run("renderRootSubLinks",e),t.run("renderFocusItemHighlight",e),t.run("renderDragAndDropEffect",e))},renderViewPortViewer:function(e){return Object(o.createElement)(Cw,Object.assign({key:"view-port-viewer"},e))}}}var Iw=Object(d.default)(kk)(qE||(qE=Object(Ka.a)(["\n  position: absolute;\n  background: white;\n  right: 30px;\n  top: 20px;\n  border-radius: 2px;\n  user-select: none;\n"]))),_w=Object(d.default)(b.w)(QE||(QE=Object(Ka.a)(["\n  padding: 0px 10px;\n"])));function Mw(e){var t=e.controller,n=e.zIndex,r=e.diagramState,c=e.setDiagramState,i=r.rightTopPanel,a=i.isOpen,l=i.selectedTabId,u=function(e){c(Object(O.a)(Object(O.a)({},r),{},{rightTopPanel:Object(O.a)(Object(O.a)({},i),e)}))};if(!a)return Object(o.createElement)(Iw,{zIndex:n},Object(o.createElement)(Ok,{onClick:function(){u({isOpen:!0})}},Object(o.createElement)(hk,{className:Gk(_k)})));return Object(o.createElement)(Iw,{zIndex:n},Object(o.createElement)(Tk,null,Object(o.createElement)(jk,{className:Gk(Mk),onClick:function(){u({isOpen:!1})}})),Object(o.createElement)(_w,{id:"tabs",selectedTabId:l,onChange:function(e){u({selectedTabId:e})}},t.run("renderRightTopPanelTabs",e)))}var Aw=Object(v.a)(Array(7).keys()),Fw=[0,5,10,15,20,25,30,35],Pw=["none","solid","dotted","dashed","double"];function Nw(e){var t=e.contentStyle,n=e.setContentStyle;return Object(o.createElement)($S,null,Object(o.createElement)(Ck,null,WS(e,rS)),Object(o.createElement)(Dk,null,Object(o.createElement)(rC,{text:"".concat(WS(e,cS),": ").concat(t.borderWidth?t.borderWidth:WS(e,bx)),items:Aw,itemRenderer:cC("px"),onItemSelect:function(e){n({borderWidth:"".concat(e,"px")})}}),Object(o.createElement)(rC,{text:"".concat(WS(e,Rx),": ").concat(t.borderStyle?WS(e,t.borderStyle):WS(e,yS)),items:Pw,itemRenderer:iC(e),onItemSelect:function(e){n({borderStyle:e})}}),Object(o.createElement)(rC,{text:"".concat(WS(e,iS),": ").concat(t.borderRadius),items:Fw,itemRenderer:cC("px"),onItemSelect:function(e){n({borderRadius:"".concat(e,"px")})}}),Object(o.createElement)(eC,{color:t.borderColor,handleColorChange:function(e){n({borderColor:e})}})))}var Bw=["curve","round","line"];function zw(e){var t=e.showLinkStyle,n=void 0===t||t,r=e.showSubLinkStyle,c=void 0===r||r,i=e.linkStyle,a=void 0===i?{}:i,l=e.subLinkStyle,u=void 0===l?{}:l,s=e.setLinkStyle,p=e.setSubLinkStyle;return Object(o.createElement)($S,null,Object(o.createElement)(Ck,null,WS(e,Dx)),n&&Object(o.createElement)(Dk,{alignItems:"center"},Object(o.createElement)(gk,{margin:"0 5px 0 0"},WS(e,Lx)+":"," "),Object(o.createElement)(rC,{text:"".concat(WS(e,cS),": ").concat(a?a.lineWidth:"0px"),items:aC,itemRenderer:cC("px"),onItemSelect:function(e){s({lineWidth:"".concat(e,"px")})}}),Object(o.createElement)(rC,{text:"".concat(WS(e,Px),": ").concat(WS(e,a.lineType)),items:Bw,itemRenderer:iC(e),onItemSelect:function(e){s({lineType:e})}}),Object(o.createElement)(eC,{color:a.lineColor,handleColorChange:function(e){s({lineColor:e})}})),c&&Object(o.createElement)(Dk,{alignItems:"center"},Object(o.createElement)(gk,{margin:"0 5px 0 0"},WS(e,Ix)+": "),Object(o.createElement)(rC,{text:"".concat(WS(e,cS),": ").concat(u?u.lineWidth:"0px"),items:aC,itemRenderer:cC("px"),onItemSelect:function(e){p({lineWidth:"".concat(e,"px")})}}),Object(o.createElement)(rC,{text:"".concat(WS(e,Px),": ").concat(WS(e,u.lineType)),items:Bw,itemRenderer:iC(e),onItemSelect:function(e){p({lineType:e})}}),Object(o.createElement)(eC,{color:u.lineColor,handleColorChange:function(e){p({lineColor:e})}})))}function Vw(e){var t=e.contentStyle,n=e.setContentStyle,r={title:"".concat(WS(e,aS),":"),min:12,max:100,value:parseInt(t.fontSize),style:{width:50},onValueChange:function(e){n({fontSize:e})}},c={title:"".concat(WS(e,lS),":"),style:{width:50},value:t.lineHeight||"",onChange:function(e){n({lineHeight:e.target.value})}};return Object(o.createElement)($S,null,Object(o.createElement)(Ck,null,WS(e,Kx)),Object(o.createElement)(bk,null,Object(o.createElement)(nC,Object.assign({},r)),Object(o.createElement)(oC,Object.assign({},c)),Object(o.createElement)(eC,{color:t.color,handleColorChange:function(e){n({color:e})}})))}var Hw,Gw=y()("node:style-editor");function Uw(e){var t=e.controller,n=e.model,r=e.topicKey,c=n.getTopic(r),i=function(n){t.run("setTopicContentStyle",Object(O.a)(Object(O.a)({},e),{},{style:n}))};if(!n.focusKey)return null;var a=t.run("getTopicContentStyle",e),l=t.run("getLinkStyle",e),u=t.run("getSubLinkStyle",e),s=Object(O.a)(Object(O.a)({},e),{},{linkStyle:l,subLinkStyle:u,setLinkStyle:function(n){t.run("setLinkStyle",Object(O.a)(Object(O.a)({},e),{},{linkStyle:n}))},setSubLinkStyle:function(n){t.run("setSubLinkStyle",Object(O.a)(Object(O.a)({},e),{},{subLinkStyle:n}))}}),p=Object(O.a)(Object(O.a)({},e),{},{contentStyle:a,setContentStyle:i});return Object(o.createElement)(xk,null,Object(o.createElement)(Nw,Object.assign({},p)),Object(o.createElement)(Vw,Object.assign({},p)),Object(o.createElement)($S,null,Object(o.createElement)(Ck,null,WS(e,nS)),Object(o.createElement)(eC,{color:a.background,handleColorChange:function(e){i({background:e})}})),Object(o.createElement)(zw,Object.assign({},s)),Object(o.createElement)($S,null,Object(o.createElement)(tC,{title:WS(e,Ax),onClick:function(){c.style&&t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:wT,style:null}))}}),Object(o.createElement)(tC,{title:WS(e,_x),onClick:function(){Hw=t.run("getTopicStyle",e),Gw(Hw)}}),Object(o.createElement)(tC,{title:WS(e,Mx),onClick:function(){Hw&&t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:wT,style:JSON.stringify(Hw)}))}})),function(e){var t=e.controller;return Object(o.createElement)($S,null,Object(o.createElement)(wk,null,Object(o.createElement)(b.d,{onClick:function(n){t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:RT}))}},WS(e,Fx))))}(e))}var Ww=n(110);function Zw(e){var t=e.contentStyle,n=e.setContentStyle,r=Ww("padding",t.padding||"0"),c={layout:"v",min:0,max:99,style:{width:38}},i=parseInt(r["padding-top"]),a=parseInt(r["padding-right"]),l=parseInt(r["padding-bottom"]),u=parseInt(r["padding-left"]),s={top:i,right:a,bottom:l,left:u},p=function(e){return function(t){n({padding:US(Object(O.a)(Object(O.a)({},s),{},Object(Sa.a)({},e,t)))})}},d=Object(O.a)(Object(O.a)({},c),{},{title:WS(e,sS),value:i,onValueChange:p("top")}),f=Object(O.a)(Object(O.a)({},c),{},{title:WS(e,fS),value:a,onValueChange:p("right")}),y=Object(O.a)(Object(O.a)({},c),{},{title:WS(e,pS),value:l,onValueChange:p("bottom")}),b=Object(O.a)(Object(O.a)({},c),{},{title:WS(e,dS),value:u,onValueChange:p("left")});return Object(o.createElement)($S,null,Object(o.createElement)(Ck,null,WS(e,uS)),Object(o.createElement)(Dk,null,Object(o.createElement)(nC,Object.assign({},d)),Object(o.createElement)(nC,Object.assign({},f)),Object(o.createElement)(nC,Object.assign({},y)),Object(o.createElement)(nC,Object.assign({},b))))}var Yw=d.default.div($E||($E=Object(Ka.a)(["\n  height: 250px;\n  overflow: auto;\n"])));function Jw(e){var t=e.topicStyle,n=e.setTopicStyle,r=t.contentStyle,c=void 0===r?{}:r,i=t.linkStyle,a=void 0===i?{}:i,l=t.subLinkStyle,u=void 0===l?{}:l,s=function(e){n({contentStyle:e})},p=Object(O.a)(Object(O.a)({},e),{},{contentStyle:c,setContentStyle:s}),d=Object(O.a)(Object(O.a)({},e),{},{showLinkStyle:!1,linkStyle:a,subLinkStyle:u,setLinkStyle:function(e){n({linkStyle:e})},setSubLinkStyle:function(e){n({subLinkStyle:e})}});return Object(o.createElement)(Yw,null,Object(o.createElement)(Nw,Object.assign({},p)),Object(o.createElement)(Zw,Object.assign({},p)),Object(o.createElement)(Vw,Object.assign({},p)),Object(o.createElement)($S,null,Object(o.createElement)(Ck,null,WS(e,nS)),Object(o.createElement)(eC,{color:c.background,handleColorChange:function(e){s({background:e})}})),Object(o.createElement)(zw,Object.assign({},d)))}y()("node:theme-editor");var Xw="normal";function qw(e){var t,n=Object(o.useState)(!1),r=Object(Ca.a)(n,2),c=r[0],i=r[1],a=e.model,l=e.controller,u=Object(ct.cloneDeep)(a.config.theme),s=l.run("getThemeOfTopic",Object(O.a)(Object(O.a)({},e),{},{isClone:!0})),p=s.rootTopic,d=s.primaryTopic,f=s.normalTopic,y=function(t){l.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:KT,theme:t}))},g=(t=function(e){y(Object(ct.merge)(u,{randomColor:e}))},function(e){return t(e.target.checked)}),h=Object(O.a)(Object(O.a)({},e),{},{topicStyle:p,setTopicStyle:function(e){y(Object(ct.merge)(u,{rootTopic:e}))}}),m=Object(o.createElement)(Jw,Object.assign({},h)),v=Object(O.a)(Object(O.a)({},e),{},{topicStyle:d,setTopicStyle:function(e){y(Object(ct.merge)(u,{primaryTopic:e}))}}),j=Object(o.createElement)(Jw,Object.assign({},v)),T=Object(O.a)(Object(O.a)({},e),{},{topicStyle:f,setTopicStyle:function(e){y(Object(ct.merge)(u,{normalTopic:e}))}}),E=Object(o.createElement)(Jw,Object.assign({},T)),k={id:Xw,handleTabIdChange:function(e){Xw=e}},x=Object(o.createElement)(Rk,null,Object(o.createElement)(b.w,Object.assign({},k),Object(o.createElement)(b.v,{id:"normal",title:WS(e,Hx),panel:E}),Object(o.createElement)(b.v,{id:"primary",title:WS(e,Gx),panel:j}),Object(o.createElement)(b.v,{id:"root",title:WS(e,Ux),panel:m}))),S={isOpen:c,onClose:function(e){i(!1)}},C=Object(o.createElement)(b.a,Object.assign({},S),Object(o.createElement)("p",null,"File format error"));return Object(o.createElement)(xk,null,Object(o.createElement)($S,null,Object(o.createElement)(Ck,null,WS(e,Bx)),Object(o.createElement)(Dk,null,Object(o.createElement)(Kk,null,WS(e,nS)+":"),Object(o.createElement)(eC,{color:u.background,handleColorChange:function(e){y(Object(ct.merge)(u,{background:e}))}}),Object(o.createElement)(Kk,null,WS(e,zx)+":"),Object(o.createElement)(eC,{color:u.highlightColor,handleColorChange:function(e){y(Object(ct.merge)(u,{highlightColor:e}))}}),Object(o.createElement)(Kk,null,WS(e,Vx)+":"),Object(o.createElement)(vk,{checked:u.randomColor,onChange:g}))),x,Object(o.createElement)($S,null,Object(o.createElement)(tC,{title:WS(e,Wx),onClick:function(e){GS(JSON.stringify(u),"blink-mind-theme.json")}}),Object(o.createElement)(tC,{title:WS(e,Zx),onClick:function(e){(function(e){var t=document.createElement("input");return t.type="file",t.accept=e,new Promise((function(e,n){t.addEventListener("change",(function(t){var o=t.target.files[0],r=new FileReader;r.onload=function(t){var n=t.target.result;e(n)},r.onerror=function(e){n(e.target.error)},r.readAsText(o)})),t.click()}))})(".json,.txt").then((function(e){var t,n=JSON.parse(e);null!=(t=n).name&&null!=t.background&&null!=t.highlightColor?y(n):i(!0)}))}})),C)}function Qw(){return{renderRightTopPanel:function(e){var t=Object(O.a)(Object(O.a)({},e),{},{key:"right-top-panel"});return Object(o.createElement)(Mw,Object.assign({},t))},renderRightTopPanelTabs:function(e){var t=e.controller;return[t.run("renderTopicStyleEditor",e),t.run("renderThemeEditor",e)]},renderTopicStyleEditor:function(e){var t={id:"topic-style",key:"topic-style",title:WS(e,wx),panel:Object(o.createElement)(Uw,Object.assign({},e))};return Object(o.createElement)(b.v,Object.assign({},t))},renderThemeEditor:function(e){var t={id:"theme-editor",key:"theme-editor",title:WS(e,Nx),panel:Object(o.createElement)(qw,Object.assign({},e))};return Object(o.createElement)(b.v,Object.assign({},t))}}}var $w=d.default.div(ek||(ek=Object(Ka.a)(["\n  box-shadow: rgb(170, 170, 170) 0 0 2px;\n  background: white;\n  .iconfont {\n    font-size: 28px !important;\n  }\n"])));function eR(e){var t=e.controller;return Object(o.createElement)($w,null,t.run("renderToolbarItems",e))}function tR(e){var t=[[tT.LEFT_AND_RIGHT,WS(e,hx),"layout-left-and-right"],[tT.LEFT_TO_RIGHT,WS(e,mx),"layout-right"],[tT.RIGHT_TO_LEFT,WS(e,Ox),"layout-left"]];return Object(o.createElement)(uC,Object.assign({className:Gk(Hk)},e),Object(o.createElement)(b.s,{enforceFocus:!1},Object(o.createElement)(Sk,null),Object(o.createElement)(b.n,null,t.map((function(t){return Object(o.createElement)(b.p,{key:t[1],icon:Uk(t[2]),text:t[1],onClick:(n=t[0],function(t){e.controller.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:FT,layoutDir:n}))})});var n})))))}function nR(){return{renderToolbar:function(e){return Object(o.createElement)(eR,Object.assign({},e))},renderToolbarItems:function(e){var t=e.controller.run("customizeToolbar",e);return t.sort((function(e,t){return e.order-t.order})),t.map((function(t){return Object(o.createElement)(t.element,Object(O.a)(Object(O.a)({},e),{},{key:t.order.toString()}))}))},customizeToolbar:function(e){return[{order:100,element:tR}]}}}var oR=y()("plugin:utils");function rR(){var e=new Map,t=new Map;return{addTempValueChangeListener:function(e){var n=e.key,o=e.listener;t.has(n)||t.set(n,[]),t.get(n).push(o)},removeTempValueChangeListener:function(e){var n=e.key,o=e.listener;t.has(n)&&(t[n]=t.get(n).filter((function(e){return e!==o})))},getTempValue:function(t){var n=t.key;return oR("getTempValue",n),e.get(n)},setTempValue:function(n){var o=n.key,r=n.value;if(oR("setTempValue",o),e.set(o,r),t.has(o)){var c,i=t.get(o),a=Object(m.a)(i);try{for(a.s();!(c=a.n()).done;){(0,c.value)(r)}}catch(l){a.e(l)}finally{a.f()}}},deleteTempValue:function(t){var n=t.key;oR("deleteTempValue",n);var o=e.get(n);return e.delete(n),o}}}function cR(){return[Lw(),rR(),SC(),Qw(),nR(),LC()]}var iR=y()("node:text-editor"),aR=d.default.div(tk||(tk=Object(Ka.a)(["\n  padding: 6px;\n  background-color: ",";\n  cursor: ",";\n  min-width: 50px;\n"])),(function(e){return e.readOnly?null:"white"}),(function(e){return e.readOnly?"pointer":"text"})),lR=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).state={content:null},o.onMouseDown=function(e){e.stopPropagation()},o.onMouseMove=function(e){},o.onKeyDown=function(e){},o._handleClick=function(e){!o.root.contains(e.target)&&o.onClickOutSide(e)},o.rootRef=function(e){return function(t){e(t),o.root=t}},o.initState(),o}return Object(l.a)(n,[{key:"onChange",value:function(e){var t=e.value;iR("onChange",t),this.setState({content:t})}},{key:"componentDidMount",value:function(){this.props.readOnly||document.addEventListener("click",this._handleClick)}},{key:"componentWillUnmount",value:function(){this.props.readOnly||document.removeEventListener("click",this._handleClick)}},{key:"onClickOutSide",value:function(e){}},{key:"getCustomizeProps",value:function(){return null}},{key:"getContent",value:function(){var e=this.getCustomizeProps().block.data;return null==e?null:("string"===typeof e&&(e=Fe.a.deserialize(e)),e)}},{key:"initState",value:function(){var e=this.getContent();this.state={content:e}}},{key:"render",value:function(){var e=this.props,t=e.topicKey,n=e.saveRef,r=this.getCustomizeProps(),c=r.readOnly,i=r.getRefKeyFunc,a=r.placeholder,l=r.style;iR(c);var u=i(t),s=c?this.getContent():this.state.content,p=this.onMouseDown,d=this.onMouseMove,f=this.onKeyDown,y={value:s,readOnly:c,onChange:this.onChange.bind(this),placeholder:a,style:l},b={key:u,readOnly:c,ref:this.rootRef(n(u)),onMouseDown:p,onMouseMove:d,onKeyDown:f};return Object(o.createElement)(aR,Object.assign({},b),Object(o.createElement)(Pe.Editor,Object.assign({},y,{autoFocus:!0})))}}]),n}(o.PureComponent),uR=y()("node:topic-content-editor");function sR(e){return"content-editor-".concat(e)}var pR=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).onKeyDown=function(e){e.nativeEvent.ctrlKey&&"Enter"===e.nativeEvent.code&&o.save()},o}return Object(l.a)(n,[{key:"getCustomizeProps",value:function(){var e=this.props,t=e.model,n=e.topicKey,o=e.readOnly;return{block:t.getTopic(n).getBlock(lT).block,readOnly:o,getRefKeyFunc:sR,placeholder:"new",style:{whiteSpace:"pre"}}}},{key:"onClickOutSide",value:function(e){uR("onClickOutSide"),this.save()}},{key:"save",value:function(){var e=this.props,t=e.model,n=e.topicKey;t.editingContentKey!==n||this.props.controller.run("operation",Object(O.a)(Object(O.a)({},this.props),{},{opType:DT,blockType:lT,data:this.state.content,focusMode:sT}))}}]),n}(lR),dR=y()("node:topic-desc-editor");function fR(e){return"desc-editor-".concat(e)}var yR=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),o=t.call(this,e),dR("constructor"),o}return Object(l.a)(n,[{key:"initState",value:function(){Object(ka.a)(Object(xa.a)(n.prototype),"initState",this).call(this);var e=this.props,t=e.controller,o=e.topicKey,r="topic-desc-data-".concat(o),c=this.state.content;t.run("setTempValue",{key:r,value:c})}},{key:"getCustomizeProps",value:function(){var e=this.props,t=e.model,n=e.topicKey;return{block:t.getTopic(n).getBlock(uT).block,readOnly:t.editingDescKey!==n,getRefKeyFunc:fR,placeholder:"write topic notes here"}}},{key:"onChange",value:function(e){var t=e.value;dR("onChange");var n=this.props,o=n.controller,r=n.topicKey;if(!(n.model.editingDescKey!==r)){var c="topic-desc-data-".concat(r);o.run("setTempValue",{key:c,value:t}),this.setState({content:t})}}}]),n}(lR);var bR=y()("plugin:StylePlugin");function gR(){var e=new Map,t=0;return{getTopicStyle:function(e){var t=e.controller;return{contentStyle:t.run("getTopicContentStyle",e),linkStyle:t.run("getLinkStyle",e),subLinkStyle:t.run("getSubLinkStyle",e)}},getTopicContentStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;bR("getTopicContentStyle:",t,n);var r,c=n.getTopicVisualLevel(t),i=n.config.theme;if(r=c===iT?i.rootTopic:c===aT?i.primaryTopic:i.normalTopic,r=Object(O.a)(Object(O.a)({},i.contentStyle),r.contentStyle),i.randomColor){var a=o.run("getRandomColor",e);r=Object(O.a)(Object(O.a)({},r),{},{background:a,borderColor:a,subLinkStyle:Object(O.a)(Object(O.a)({},r.subLinkStyle),{},{lineColor:a})})}var l=n.getTopic(t);if(!l.style)return r;var u=JSON.parse(l.style);return Object(O.a)(Object(O.a)({},r),u.contentStyle)},getLinkStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;bR("getLinkStyle",t);var r,c=n.getTopicVisualLevel(t),i=n.config.theme,a=i.linkStyle;r=c===iT?i.rootTopic.linkStyle:c===aT?i.primaryTopic.linkStyle:i.normalTopic.linkStyle,a=Object(O.a)(Object(O.a)({},a),r);var l=n.getTopic(t);if(null!=l.parentKey){var u=o.run("getSubLinkStyle",Object(O.a)(Object(O.a)({},e),{},{topicKey:l.parentKey}));a=Object(O.a)(Object(O.a)({},a),u)}if(!l.style)return a;var s=JSON.parse(l.style);return Object(O.a)(Object(O.a)({},a),s.linkStyle)},getSubLinkStyle:function(e){var t=e.topicKey,n=e.model,o=e.controller;bR("getLinkStyle",t);var r,c=n.getTopicVisualLevel(t),i=n.config.theme,a=i.linkStyle;r=c===iT?i.rootTopic.subLinkStyle:c===aT?i.primaryTopic.subLinkStyle:i.normalTopic.subLinkStyle,a=Object(O.a)(Object(O.a)({},a),r);var l=n.getTopic(t);if(i.randomColor){var u=o.run("getRandomColor",e);bR(u),a=Object(O.a)(Object(O.a)({},a),{},{lineColor:u})}if(!l.style)return a;var s=JSON.parse(l.style);return Object(O.a)(Object(O.a)({},a),s.subLinkStyle)},setTopicContentStyle:function(e){var t=e.topicKey,n=e.controller,o=e.style,r=e.model.getTopic(t).style,c=r?JSON.parse(r):{},i=Object(O.a)(Object(O.a)({},c),{},{contentStyle:Object(O.a)(Object(O.a)({},c.contentStyle),o)});if(!Object(ct.isEqual)(c,i)){var a=JSON.stringify(i);n.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:wT,style:a}))}},setLinkStyle:function(e){var t=e.topicKey,n=e.controller,o=e.linkStyle,r=e.model.getTopic(t).style,c=r?JSON.parse(r):{},i=Object(O.a)(Object(O.a)({},c),{},{linkStyle:Object(O.a)(Object(O.a)({},c.linkStyle),o)});if(!Object(ct.isEqual)(c,i)){var a=JSON.stringify(i);n.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:wT,style:a}))}},setSubLinkStyle:function(e){var t=e.topicKey,n=e.controller,o=e.subLinkStyle,r=e.model.getTopic(t).style,c=r?JSON.parse(r):{},i=Object(O.a)(Object(O.a)({},c),{},{subLinkStyle:Object(O.a)(Object(O.a)({},c.subLinkStyle),o)});if(!Object(ct.isEqual)(c,i)){var a=JSON.stringify(i);n.run("operation",Object(O.a)(Object(O.a)({},e),{},{opType:wT,style:a}))}},getTopicThemeStyle:function(e){var t=e.topicKey,n=e.model,o=n.getTopicVisualLevel(t),r=n.config.theme;return o===iT?r.rootTopic:o===aT?r.primaryTopic:r.normalTopic},getRandomColor:function(n){var o=n.topicKey;if(e.has(o))return e.get(o);var r=["#00CC99","#FFEE88","#A167A5","#E5F993","#F5C396","#DB995A","#83BCFF","#ED7B84","#739E82","#D3BCC0","#FFA0FD","#EFD3D7","#C6878F"],c=r[++t%r.length];return e.set(o,c),bR("getRandomColor",o,c),c}}}function hR(){return[cR(),{getPartTopics:function(e){var t=e.layout,n=e.model,o=e.topicKey,r=n.getTopic(o),c=r.subKeys.size,i=r.subKeys.toArray();switch(t){case tT.LEFT_TO_RIGHT:return{R:i};case tT.RIGHT_TO_LEFT:return{L:i};case tT.LEFT_AND_RIGHT:return{L:i.slice(Math.ceil(c/2),c),R:i.slice(0,Math.ceil(c/2))};case tT.TOP_TO_BOTTOM:return{B:i}}},createSubTopics:function(e){var t=e.model,n=e.topicKey,o=e.controller,r=e.topics,c=e.saveRef,i=t.getTopic(n);if(0===r.size||i.collapse)return null;var a=[];return r.forEach((function(t){var n=Object(O.a)(Object(O.a)({},e),{},{topicKey:t,key:t,ref:c(Jk(t))});a.push(o.run("renderTopicWidget",n))})),{subTopics:a}},layout:function(e){var t=e.getRef,n=e.model,o=t(qk(n.editorRootTopicKey)),r=t(rx),c=t(cx);o&&o.layout(),r&&r.layout(),c&&c.layout(),function e(o){if(o.key!==n.editorRootTopicKey){var r=t(Jk(o.key));r&&r.layoutLinks()}if(!o.collapse){var c,i=Object(m.a)(o.subKeys);try{for(i.s();!(c=i.n()).done;){var a=c.value;e(n.getTopic(a))}}catch(l){i.e(l)}finally{i.f()}}}(n.getTopic(n.editorRootTopicKey))},getRelativeRect:function(e){var t=e.element,n=e.controller,o=e.getRef,r=n.run("getZoomFactor",e);return qS(t,o(nx).bigView,r)},getRelativeRectFromViewPort:function(e){var t=e.element,n=e.controller,o=e.getRef,r=n.run("getZoomFactor",e);return qS(t,o(nx).viewBox,r)},getRelativeVectorFromViewPort:function(e){return QS(e.element,(0,e.getRef)(nx).viewBox)},addZoomFactorChangeEventListener:function(e){e.controller.run("addTempValueChangeListener",Object(O.a)({key:"ZoomFactor"},e))},removeZoomFactorChangeEventListener:function(e){e.controller.run("removeTempValueChangeListener",Object(O.a)({key:"ZoomFactor"},e))},setZoomFactor:function(e){var t=e.controller,n=e.zoomFactor;return t.run("setTempValue",{key:"ZoomFactor",value:n})},getZoomFactor:function(e){return e.controller.run("getTempValue",{key:"ZoomFactor"})||1},moveTopicToCenter:function(e){var t=e.getRef,n=e.topicKey,o=e.model,r=e.moveDir,c=void 0===r?mC:r;if(o.editorRootTopicKey!==n&&GT(o,n,o.editorRootTopicKey)!==gT)throw new Error("moveTopicToCenter error: topicKey ".concat(n," is not the DESCENDANT of editor root topic"));var i=t(Xk(n)),a=t(nx),l=a.viewBox;if(!i||!l)throw new Error("moveTopicToCenter error: topic or viewBox is null");var u=QS(i,l);if(c===OC)a.setViewBoxScrollDelta(u[0],u[1]);else if(c===mC){var s=l.getBoundingClientRect(),p=i.getBoundingClientRect(),d=(s.width-p.width)/2;a.setViewBoxScrollDelta(u[0]+d-200,u[1])}},focusTopicAndMoveToCenter:function(e){var t=e.controller,n=e.topicKey;t.run("operation",Object(O.a)(Object(O.a)({},e),{},{opArray:[{opType:ST,topicKey:n,focusMode:sT},{opType:TT,topicKey:n}],allowUndo:!1,callback:function(o){return function(){t.run("moveTopicToCenter",Object(O.a)(Object(O.a)({},e),{},{model:o,topicKey:n}))}}}))}},EC(),gR(),pC(),vC(),{getValue:function(e,t){var n=e.propKey,o=e.controller,r=e.diagramState;switch(n){case ax:return 3;case lx:case dx:return o.run("isOperationEnabled",e);case ux:return o.run("getTopicTitle",e);case sx:return r.dragDrop;case px:return r.rightTopPanel}return t()}},{getTopicTitle:function(e){var t=e.model,n=e.controller,o=e.topicKey,r=e.maxLength,c=t.getTopic(o).getBlock(lT).block,i=n.run("serializeBlockData",Object(O.a)(Object(O.a)({},e),{},{block:c}));return null!=r&&(i=i.length>r?i.substr(0,r)+"...":i),i},renderTopicContentEditor:function(e){return Object(o.createElement)(pR,Object.assign({},e))},renderTopicDescEditor:function(e){return Object(o.createElement)(yR,Object.assign({},e))},isBlockEmpty:function(e,t){var n=e.block,o=e.controller;return n.type===lT||n.type===uT?null==n.data||""===o.run("serializeBlockData",e):t()},serializeBlockData:function(e,t){var n=e.block;return n.type===lT||n.type===uT?"string"===typeof n.data?n.data:Fe.a.serialize(n.data):t()}},{createNewModel:function(e){return JT.createEmpty()}},{getThemeOfTopic:function(e){var t=e.model.config.theme,n=t.contentStyle,o=t.rootTopic,r=t.primaryTopic,c=t.normalTopic;return{rootTopic:Object(O.a)(Object(O.a)({},o),{},{contentStyle:Object(O.a)(Object(O.a)({},n),o.contentStyle)}),primaryTopic:Object(O.a)(Object(O.a)({},r),{},{contentStyle:Object(O.a)(Object(O.a)({},n),r.contentStyle)}),normalTopic:Object(O.a)(Object(O.a)({},c),{},{contentStyle:Object(O.a)(Object(O.a)({},n),c.contentStyle)})}}},jC()]}y()("node:Diagram"),o.Component;var OR=n(886),mR=function(e,t){return(mR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function vR(e,t){function n(){this.constructor=e}mR(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var jR=function(){return(jR=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function TR(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,c=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(o=c.next()).done;)i.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}return i}function ER(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var kR,xR,SR=Object(d.default)(kk)(kR||(kR=ER(["\n  position: absolute;\n  left: calc(50% - 150px);\n  top: 30px;\n  width: 300px;\n  background: white;\n  padding: 10px;\n  user-select: none;\n"],["\n  position: absolute;\n  left: calc(50% - 150px);\n  top: 30px;\n  width: 300px;\n  background: white;\n  padding: 10px;\n  user-select: none;\n"]))),CR=d.default.div(xR||(xR=ER(["\n  margin-bottom: 10px;\n"],["\n  margin-bottom: 10px;\n"])));function wR(e){var t=e.zIndex,n=e.controller,r=e.topicKey;return Object(o.createElement)(SR,{zIndex:t},Object(o.createElement)(CR,null,"Please select the topics you want to reference. After selection, click the confirm button."),Object(o.createElement)(bk,{justifyContent:"space-around"},Object(o.createElement)(b.d,{onClick:function(t){var o=n.run("getSelectedReferenceKeys",e);n.run("enableOperation",e),n.run("operation",jR(jR({},e),{opArray:[{opType:"OP_TYPE_SET_REFERENCE_TOPICS",topicKey:r,referenceKeys:o},{opType:ST,topicKey:r,focusMode:sT}]})),n.run("clearSelectedReferenceKeys",e)}},"Confirm"),Object(o.createElement)(b.d,{onClick:function(t){n.run("clearSelectedReferenceKeys",e),n.run("enableOperation",e),n.run("operation",jR(jR({},e),{opType:CT,focusMode:sT}))}},"Cancel")))}var RR={keyList:Object(j.List)(),dataMap:Object(j.Map)()},KR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vR(t,e),Object.defineProperty(t.prototype,"keyList",{get:function(){return this.get("keyList")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataMap",{get:function(){return this.get("dataMap")},enumerable:!0,configurable:!0}),t}(Object(j.Record)(RR)),DR={reference:Object(j.Map)()},LR=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vR(t,e),Object.defineProperty(t.prototype,"reference",{get:function(){return this.get("reference")},enumerable:!0,configurable:!0}),t.prototype.getReferenceKeys=function(e){return this.reference.has(e)?this.reference.get(e).keyList.toArray():[]},t.prototype.getReferencedKeys=function(e){var t=[];return this.reference.forEach((function(n,o){n.keyList.includes(e)&&t.push(o)})),t},t}(Object(j.Record)(DR));function IR(e){var t=e.model,n=e.topicKey,o=e.referenceKeys,r=t.getExtDataItem("TOPIC_REFERENCE",LR),c=r.reference.get(n)||new KR;return c=c.set("keyList",Object(j.List)(o)),r=r.setIn(["reference",n],c),t=t.setIn(["extData","TOPIC_REFERENCE"],r)}var _R,MR,AR,FR=d.default.div(_R||(_R=ER(["\n  display: flex;\n  width: 380px;\n  margin: 10px;\n  justify-content: center;\n  align-items: center;\n"],["\n  display: flex;\n  width: 380px;\n  margin: 10px;\n  justify-content: center;\n  align-items: center;\n"]))),PR=d.default.div(MR||(MR=ER(["\n  width: 300px;\n  text-decoration: underline;\n  cursor: pointer;\n"],["\n  width: 300px;\n  text-decoration: underline;\n  cursor: pointer;\n"]))),NR=d.default.div(AR||(AR=ER(["\n  width: 80px;\n"],["\n  width: 80px;\n"])));function BR(e){var t=e.controller,n=e.refKey,r=e.refType,c=e.removeHandler,i=TR(Object(o.useState)(!1),2),a=i[0],l=i[1],u=t.getValue(ux,jR(jR({},e),{topicKey:n,maxLength:100})),s={isOpen:a,cancelButtonText:"cancel",onConfirm:function(e){c(e)},onCancel:function(e){l(!1)},onClose:function(e){l(!1)}};return Object(o.createElement)(FR,null,Object(o.createElement)(PR,{onClick:function(o){o.stopPropagation(),t.run("focusTopicAndMoveToCenter",jR(jR({},e),{topicKey:n}))}},u),Object(o.createElement)(NR,null,"reference"===r&&Object(o.createElement)(o.Fragment,null,Object(o.createElement)(b.d,{onClick:function(e){l(!0)}},"Remove"),Object(o.createElement)(b.a,jR({},s),Object(o.createElement)("p",null,"Are you confirm to remove this reference?")))))}var zR,VR,HR,GR,UR,WR=d.default.div(zR||(zR=ER([""],[""]))),ZR=d.default.div(VR||(VR=ER(["\n  padding: 10px;\n"],["\n  padding: 10px;\n"]))),YR=d.default.div(HR||(HR=ER(["\n  max-height: 200px;\n  overflow: auto;\n"],["\n  max-height: 200px;\n  overflow: auto;\n"]))),JR=d.default.div(GR||(GR=ER(["\n  font-size: 20px;\n  color: #106ba3;\n"],["\n  font-size: 20px;\n  color: #106ba3;\n"]))),XR=d.default.div(UR||(UR=ER(["\n  text-decoration: underline;\n  color: #106ba3;\n  cursor: pointer;\n"],["\n  text-decoration: underline;\n  color: #106ba3;\n  cursor: pointer;\n"])));function qR(e){var t=e.topicKey,n=e.controller,r=e.model,c=r.extData.get("TOPIC_REFERENCE"),i=c.getReferenceKeys(t),a=0===i.length?null:Object(o.createElement)(ZR,null,Object(o.createElement)(JR,null,"Reference Topics:"),Object(o.createElement)(YR,null,i.map((function(r){var i,a=jR(jR({},e),{key:r,refKey:r,refType:"reference",removeHandler:(i=r,function(o){o.stopPropagation();var r=c.reference.get(t).keyList;n.run("operation",jR(jR({},e),{opArray:[{opType:"OP_TYPE_SET_REFERENCE_TOPICS",topicKey:t,focusMode:sT,referenceKeys:r.delete(r.indexOf(i)).toArray()}]}))})});return Object(o.createElement)(BR,jR({},a))})))),l=c.getReferencedKeys(t),u=0===l.length?null:Object(o.createElement)(ZR,null,Object(o.createElement)(JR,null,"Referenced Topics:"),Object(o.createElement)(YR,null,l.map((function(t){var n=jR(jR({},e),{key:t,refKey:t,refType:"referenced"});return Object(o.createElement)(BR,jR({},n))})))),s=r.focusKey!==t&&Object(o.createElement)(ZR,null,Object(o.createElement)(XR,{onClick:function(t){t.stopPropagation(),n.run("focusTopicAndMoveToCenter",e)}},"Goto Origin Topic"));return Object(o.createElement)(WR,{onMouseDown:HS},a,u,s)}function QR(e){var t=e.model,n=e.topicKey,r=t.extData.get("TOPIC_REFERENCE")||new LR,c=r.reference.get(n),i=[];if(r.reference.forEach((function(e,t){e.keyList.includes(n)&&i.push(t)})),(null==c||0===c.keyList.size)&&0===i.length)return null;var a={className:Gk("reference"),tabIndex:-1},l=Object(o.createElement)(Ek,jR({},a)),u={autoFocus:!1,content:Object(o.createElement)(qR,jR({},e)),target:l,interactionKind:b.t.CLICK,hoverOpenDelay:500};return Object(o.createElement)(b.s,jR({},u))}function $R(e){var t=e.topicKey,n=e.selectedTopicKeys,r=n.has(t),c=TR(Object(o.useState)(r),2),i=c[0],a=c[1],l={checked:i,onChange:function(){n.has(t)?n.delete(t):n.add(t),a(!i)}};return Object(o.createElement)(vk,jR({},l))}var eK,tK,nK,oK,rK,cK=OR.a.ofType(),iK=Object(d.default)(cK)(eK||(eK=ER(["\n  top: 20%;\n  left: 25% !important;\n  width: 50% !important;\n"],["\n  top: 20%;\n  left: 25% !important;\n  width: 50% !important;\n"]))),aK=d.default.div(tK||(tK=ER(["\n  margin: 0 5px;\n  padding: 10px 5px;\n  width: 100%;\n  font-size: 16px;\n  cursor: pointer;\n  &:hover {\n    background: #e3e8ec;\n  }\n"],["\n  margin: 0 5px;\n  padding: 10px 5px;\n  width: 100%;\n  font-size: 16px;\n  cursor: pointer;\n  &:hover {\n    background: #e3e8ec;\n  }\n"]))),lK=Object(d.default)(b.s)(nK||(nK=ER(["\n  display: block;\n"],["\n  display: block;\n"]))),uK=d.default.div(oK||(oK=ER(["\n  padding: 10px;\n  font-size: 16px;\n  //max-width: 800px;\n  //max-height: 600px;\n  overflow: auto;\n"],["\n  padding: 10px;\n  font-size: 16px;\n  //max-width: 800px;\n  //max-height: 600px;\n  overflow: auto;\n"]))),sK=d.default.div(rK||(rK=ER(["\n  white-space: break-spaces;\n"],["\n  white-space: break-spaces;\n"]))),pK={placeholder:"Search"};function dK(e){var t=e.model,n=(e.setSearchWord,e.controller),r=function(t){return function(o){n.run("focusTopicAndMoveToCenter",jR(jR({},e),{topicKey:t}))}},c=function(){var o=[];return t.topics.forEach((function(t,r){o.push({key:r,title:n.run("getTopicTitle",jR(jR({},e),{topicKey:r}))})})),o}();return Object(o.createElement)(iK,{inputProps:pK,itemListPredicate:function(e,t){return t.filter((function(t){return t.title.toLowerCase().includes(e.toLowerCase())}))},isOpen:!0,items:c,itemRenderer:function(e,t){var n=e.key,c=e.title,i=c.length>100,a=i?c.substr(0,100)+"...":c,l={key:n,onClick:r(n)},u=Object(o.createElement)(aK,jR({},l),a),s={key:n,target:u,content:Object(o.createElement)(uK,null,Object(o.createElement)(sK,null,c)),fill:!0,interactionKind:b.t.HOVER_TARGET_ONLY,hoverOpenDelay:1e3};return i?Object(o.createElement)(lK,jR({},s)):u},onClose:function(){n.run("operation",jR(jR({},e),{opType:CT,focusMode:sT}))},resetOnSelect:!0})}n(876);function fK(e){return r.a.createElement("div",{className:"bm-toolbar-item ".concat(rn("openfile")),onClick:function(t){var n=e.diagram,o=n.getDiagramProps().controller;Cn(".json,.blinkmind,.bm").then((function(e){var t=JSON.parse(e),r=o.run("deserializeModel",{controller:o,obj:t});n.openNewModel(r)}))}})}function yK(e){return!0===(null!=(t=e)&&"object"===typeof t&&!1===Array.isArray(t))&&"[object Object]"===Object.prototype.toString.call(e);var t}var bK=function(e){var t,n;return!1!==yK(e)&&("function"===typeof(t=e.constructor)&&(!1!==yK(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))},gK=function(e,t){return(gK=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function hK(e,t){function n(){this.constructor=e}gK(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var OK=function(){return(OK=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function mK(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,c=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(o=c.next()).done;)i.push(o.value)}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}return i}function vK(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(mK(arguments[t]));return e}y()("core:controller");function jK(e){var t,n;if(!Array.isArray(e))throw new TypeError("Middleware stack must be an array!");try{for(var o=function(e){var t="function"===typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}(e),r=o.next();!r.done;r=o.next()){if("function"!==typeof r.value)throw new TypeError("Middleware must be composed of functions!")}}catch(c){t={error:c}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return function(t,n){var o=-1;return function r(c){if(c<=o)throw new Error("next() called multiple times");o=c;var i=e[c];c===e.length&&(i=n);if(!i)return null;try{return i(t,r.bind(null,c+1))}catch(a){throw a}}(0)}}var TK;!function(){function e(e){void 0===e&&(e={});var t=e.plugins,n=void 0===t?[]:t,o=e.onChange,r=e.readOnly;this.readOnly=r,this.onChange=o,this.middleware=new Map,function e(t,n){if(Array.isArray(n))n.forEach((function(n){return e(t,n)}));else if(null!=n)for(var o in n){var r=n[o];t.middleware[o]=t.middleware[o]||[],t.middleware[o].push(r)}}(this,function(e){void 0===e&&(e={});var t=e.plugins;return vK(void 0===t?[]:t)}({plugins:n}))}e.prototype.run=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=this.middleware,r=o[e]||[];Object(ke.a)(0!==r.length,"the middleware function "+e+" is not found!");var c=Object(k.a)(jK)(r);return c.apply(void 0,vK(t))},e.prototype.getValue=function(e,t){return this.run("getValue",OK(OK({},t),{propKey:e}))},e.prototype.change=function(e,t){this.onChange(e,t),this.currentModel=e}}();!function(e){e[e.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT",e[e.LEFT_AND_RIGHT=2]="LEFT_AND_RIGHT",e[e.TOP_TO_BOTTOM=3]="TOP_TO_BOTTOM"}(TK||(TK={}));var EK="CONTENT",kK="NORMAL",xK="EDITING_CONTENT",SK="EDITING_DESC",CK="SET_FOCUS_MODE";function wK(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var RK=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return hK(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.get("data")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.get("type")},enumerable:!0,configurable:!0}),t.create=function(e){return new t(e)},t.createList=function(e){if(j.List.isList(e)||Array.isArray(e))return Object(j.List)(e.map(t.create));throw new Error("Block.createList only accepts Array or List, but you passed it: "+e)},t}(Object(j.Record)({type:null,key:null,data:null})),KK=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return hK(t,e),Object.defineProperty(t.prototype,"key",{get:function(){return this.get("key")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentKey",{get:function(){return this.get("parentKey")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collapse",{get:function(){return this.get("collapse")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subKeys",{get:function(){return this.get("subKeys")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blocks",{get:function(){return this.get("blocks")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relations",{get:function(){return this.get("relations")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.get("style")},enumerable:!0,configurable:!0}),t.prototype.getBlock=function(e){var t=this.blocks.findIndex((function(t){return t.type===e}));return-1===t?{index:t,block:null}:{index:t,block:this.blocks.get(t)}},t.fromJSON=function(e){var n=e.key,o=e.parentKey,r=void 0===o?null:o,c=e.blocks,i=e.subKeys,a=void 0===i?[]:i,l=e.collapse;return new t({key:n,parentKey:r,collapse:void 0!==l&&l,subKeys:Object(j.List)(a),blocks:RK.createList(c)})},t.create=function(e){var n=e.key,o=e.parentKey,r=void 0===o?null:o,c=e.content,i=void 0===c?"":c,a=e.subKeys,l=void 0===a?[]:a,u=e.collapse,s=void 0!==u&&u,p=RK.create({type:EK,data:i,key:null});return new t({key:n,parentKey:r,blocks:Object(j.List)([p]),subKeys:Object(j.List)(l),collapse:s})},t}(Object(j.Record)({key:null,parentKey:null,collapse:!1,subKeys:null,blocks:null,relations:null,style:null}));y()("modifier");var DK={readOnly:!1,allowUndo:!0,layoutDir:TK.LEFT_AND_RIGHT,theme:{name:"default",randomColor:!0,background:"rgb(57,60,65)",highlightColor:"#50C9CE",marginH:60,marginV:20,contentStyle:{lineHeight:"1.5"},linkStyle:{lineRadius:5,lineType:"curve",lineWidth:"3px"},rootTopic:{contentStyle:{fontSize:"34px",borderRadius:"35px",padding:"16px 18px 16px 18px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},primaryTopic:{contentStyle:{borderWidth:"1px",borderStyle:"solid",borderRadius:"20px",fontSize:"17px",padding:"10px 15px 10px 15px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"rgb(113, 203, 45)"}},normalTopic:{contentStyle:{border:"1px solid #e8eaec",borderRadius:"20px",fontSize:"17px",padding:"4px 10px"},subLinkStyle:{lineType:"curve",lineWidth:"3px",lineColor:"white"}}}},LK=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return hK(t,e),Object.defineProperty(t.prototype,"layoutDir",{get:function(){return this.get("layoutDir")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readOnly",{get:function(){return this.get("readOnly")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowUndo",{get:function(){return this.get("allowUndo")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"theme",{get:function(){return this.get("theme")},enumerable:!0,configurable:!0}),t.fromJSON=function(e){return new t(e)},t}(Object(j.Record)(DK)),IK={topics:Object(j.Map)(),extData:Object(j.Map)(),config:null,rootTopicKey:null,editorRootTopicKey:null,focusKey:null,focusMode:null,formatVersion:null,zoomFactor:1},_K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return hK(t,e),t.isModel=function(e){return e instanceof t},t.create=function(e){if(void 0===e&&(e=null),null==e)return t.createEmpty();var n;if(t.isModel(e)&&(n=e),bK(e)&&(n=t.fromJSON(e)),n)return null==n.focusKey&&(n=n.set("focusKey",n.rootTopicKey)),null==n.focusMode&&(n=n.set("focusMode",kK)),n;throw new Error("`Value.create` only accepts objects or values, but you passed it: "+e)},t.createEmpty=function(){var e=new t,n=KK.create({key:wK()});return e.update("topics",(function(e){return e.set(n.key,n)})).set("rootTopicKey",n.key).set("focusKey",n.key).set("focusMode",kK)},t.fromJSON=function(e){var n=new t,o=e.topics,r=void 0===o?[]:o,c=e.config,i=void 0===c?{}:c,a=e.rootTopicKey,l=e.editorRootTopicKey;return void 0===l&&(l=a),n=(n=n.merge({rootTopicKey:a,editorRootTopicKey:l})).withMutations((function(e){r.forEach((function(t){e.update("topics",(function(e){return e.set(t.key,KK.fromJSON(t))}))})),e.set("config",LK.fromJSON(i))}))},t.prototype.toJS=function(){return{rootTopicKey:this.rootTopicKey,topics:Object.values(this.topics.toJS()),config:this.config,extData:this.extData,zoomFactor:this.zoomFactor}},Object.defineProperty(t.prototype,"extData",{get:function(){return this.get("extData")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topics",{get:function(){return this.get("topics")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"config",{get:function(){return this.get("config")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formatVersion",{get:function(){return this.get("formatVersion")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rootTopicKey",{get:function(){return this.get("rootTopicKey")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editorRootTopicKey",{get:function(){return this.get("editorRootTopicKey")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"focusKey",{get:function(){return this.get("focusKey")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"focusMode",{get:function(){return this.get("focusMode")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editingContentKey",{get:function(){return this.focusMode===xK?this.focusKey:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editingDescKey",{get:function(){return this.focusMode===SK?this.focusKey:null},enumerable:!0,configurable:!0}),t.prototype.getTopic=function(e){return this.topics.get(e)},t.prototype.getExtDataItem=function(e,t){return this.extData.get(e)||new t},t.prototype.getParentTopic=function(e){var t=this.getTopic(e);return t.parentKey?this.getTopic(t.parentKey):null},t.prototype.getTopicVisualLevel=function(e){for(var t=this.getTopic(e),n=0;t&&t.key!==this.editorRootTopicKey;)n++,t=this.getParentTopic(t.key);return n},Object.defineProperty(t.prototype,"rootTopic",{get:function(){return this.getTopic(this.rootTopicKey)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomFactor",{get:function(){return this.get("zoomFactor")},enumerable:!0,configurable:!0}),t}(Object(j.Record)(IK));function MK(e){var t=[[TK.LEFT_AND_RIGHT,"Left And Right","layout-left-and-right"],[TK.LEFT_TO_RIGHT,"Only Right","layout-right"],[TK.RIGHT_TO_LEFT,"Only Left","layout-left"]];return r.a.createElement("div",{className:nt()("bm-toolbar-item",rn("layout-left-and-right"))},r.a.createElement(b.s,{enforceFocus:!1},r.a.createElement("div",{className:"bm-toolbar-popover-target"}),r.a.createElement(b.n,null,t.map((function(t){return r.a.createElement(b.p,{key:t[1],icon:cn(t[2]),text:t[1],onClick:(n=t[0],function(t){var o=e.diagram.getDiagramProps();o.controller.run("setLayoutDir",Object(O.a)(Object(O.a)({},o),{},{layoutDir:n}))})});var n})))))}var AK=n(301),FK=n.n(AK),PK=n(302),NK=n.n(PK),BK=n(303),zK=n.n(BK),VK=n(304),HK=n.n(VK),GK=n(305),UK=n.n(GK);function WK(e){var t=[["default",FK.a],["theme1",NK.a],["theme2",zK.a],["theme3",HK.a],["theme4",UK.a]];return r.a.createElement("div",{className:nt()("bm-toolbar-item",rn("theme"))},r.a.createElement(b.s,{enforceFocus:!1},r.a.createElement("div",{className:"bm-toolbar-popover-target"}),r.a.createElement("div",{className:"bm-popover-theme"},t.map((function(t){return r.a.createElement("div",{key:t[0],className:"bm-theme-item",onClick:(n=t[0],function(t){var o=e.diagram.getDiagramProps();o.controller.run("setTheme",Object(O.a)(Object(O.a)({},o),{},{themeKey:n}))})},r.a.createElement("img",{className:"bm-theme-img",src:t[1],alt:t[0]}));var n})))))}function ZK(e){return r.a.createElement("div",{className:nt()("bm-toolbar-item",rn("export"))},r.a.createElement(b.s,{enforceFocus:!1},r.a.createElement("div",{className:"bm-toolbar-popover-target"}),r.a.createElement(b.n,null,r.a.createElement(b.p,{text:"JSON(.json)",onClick:function(t){var n=e.diagram.getDiagramProps(),o=n.controller,r=n.model,c=o.run("serializeModel",n),i=JSON.stringify(c),a="data:text/plain,".concat(encodeURIComponent(i)),l=o.run("getTopicTitle",Object(O.a)(Object(O.a)({},n),{},{topicKey:r.rootTopicKey}));!function(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.click()}(a,"".concat(l,".blinkmind"))}}),r.a.createElement(b.o,null))))}function YK(e){return r.a.createElement("div",{className:"bm-toolbar-item ".concat(rn(on)),onClick:function(t){var n=e.diagram.getDiagramProps();n.controller.run("operation",Object(O.a)(Object(O.a)({},n),{},{opType:CK,focusMode:"FOCUS_MODE_SEARCH"}))}})}var JK=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.onClickUndo,n=e.onClickRedo,o=e.canUndo,c=e.canRedo;return r.a.createElement("div",{className:"bm-toolbar"},r.a.createElement(fK,e),r.a.createElement(ZK,e),r.a.createElement(WK,e),r.a.createElement(MK,e),r.a.createElement(YK,e),r.a.createElement("div",{className:nt()("bm-toolbar-item",rn("undo"),{"bm-toolbar-item-disabled":!o}),onClick:t}),r.a.createElement("div",{className:nt()("bm-toolbar-item",rn("redo"),{"bm-toolbar-item-disabled":!c}),onClick:n}))}}]),n}(r.a.PureComponent),XK=(n(877),y()("app"),[rf(),function(){var e=new Map([["default",_f],["random-color-square",Gf],["theme1",Uf],["theme2",Wf],["theme3",Zf],["theme4",Yf]]);return{getAllThemes:function(t){return e},setTheme:function(e){var t=e.model,n=e.controller,o=e.themeKey,r=n.run("getAllThemes",e);if(!r.has(o))throw new Error("setTheme: the theme key is not correct!");var c=r.get(o),i=Vf.setTheme({model:t,theme:c});n.change(i)}}}(),function(){var e=new Set;function t(t){var n=t.model,o=t.topicKey,r=n.getExtDataItem("TOPIC_REFERENCE",LR);return e=new Set(r.getReferenceKeys(o)),n=ZT.focusTopic({model:n,topicKey:o,focusMode:"FOCUS_MODE_SET_REFERENCE_TOPICS"})}return{customizeTopicContextMenu:function(e,t){var n=e.controller;return Object(o.createElement)(o.Fragment,null,t(),Object(o.createElement)(b.o,null),Object(o.createElement)(b.p,{key:"EXT_KEY_TOPIC_REFERENCE",icon:Uk("reference"),text:"Set Reference Topics",onClick:function(t){n.run("operation",jR(jR({},e),{opType:"OP_TYPE_START_SET_REFERENCE_TOPICS"})),n.run("disableOperation",jR(jR({},e),{whiteList:[mT]}))}}))},getOpMap:function(e,n){var o=n();return o.set("OP_TYPE_START_SET_REFERENCE_TOPICS",t),o.set("OP_TYPE_SET_REFERENCE_TOPICS",IR),o},beforeOpFunction:function(e,t){var n=t(),o=e.opType,r=e.topicKey;if(o===xT&&r!==n.editorRootTopicKey){var c=HT(n,r);c.push(r);var i=n.getExtDataItem("TOPIC_REFERENCE",LR),a=i.reference;c.forEach((function(e){var t=i.getReferencedKeys(e);(a=a.withMutations((function(n){t.forEach((function(t){n.updateIn([t,"keyList"],(function(t){return t.delete(t.indexOf(e))}))}))}))).has(e)&&(a=a.delete(e))})),i=i.set("reference",a),n=n.setIn(["extData","TOPIC_REFERENCE"],i)}return n},renderDiagramCustomize:function(e,t){var n=e.model,r=e.controller.getValue(ax)+2,c=t();if("FOCUS_MODE_SET_REFERENCE_TOPICS"===n.focusMode){var i=jR(jR({},e),{zIndex:r,topicKey:n.focusKey,key:"AddReferenceTopicPanel"});c.push(Object(o.createElement)(wR,jR({},i)))}return c},renderTopicContentOthers:function(t,n){var r=t.model,c=t.topicKey,i=t.controller,a=n();if(a.push(i.run("renderTopicExtReference",jR(jR({},t),{key:"EXT_KEY_TOPIC_REFERENCE-icon"}))),"FOCUS_MODE_SET_REFERENCE_TOPICS"===r.focusMode&&r.focusKey!==c){var l=jR(jR({},t),{key:"checkbox",selectedTopicKeys:e}),u=Object(o.createElement)($R,jR({},l));a.push(u)}return a},renderTopicExtReference:function(e,t){return Object(o.createElement)(QR,jR({},e))},clearSelectedReferenceKeys:function(){e.clear()},getSelectedReferenceKeys:function(){return Array.from(e)},deserializeExtDataItem:function(e,t){var n=e.extDataKey,o=e.extDataItem;if("TOPIC_REFERENCE"===n){var r=new LR,c=function(e){var t=o.reference[e],n=new KR({keyList:Object(j.List)(t.keyList),dataMap:Object(j.Map)(t.dataMap)});r=r.update("reference",(function(t){return t.set(e,n)}))};for(var i in o.reference)c(i);return r}return t()}}}(),function(){var e=function(e){};return{customizeHotKeys:function(e,t){var n=e.controller,o=e.model,r=t();return r.globalHotKeys.set("DEFAULT_SEARCH",{label:"search",combo:"ctrl + f",onKeyDown:function(){n.run("operation",jR(jR({},e),{opType:ST,topicKey:o.focusKey,focusMode:"FOCUS_MODE_SEARCH"}))}}),r},renderDiagramCustomize:function(t,n){var r=n();if("FOCUS_MODE_SEARCH"===t.model.focusMode){var c=jR(jR({key:"search-panel"},t),{setSearchWorld:e});r.push(Object(o.createElement)(dK,jR({},c)))}return r}}}(),Qj(),{serializeModel:function(e,t){var n=t();if(null!=n)return n;var o=e.model,r=e.controller;return{rootTopicKey:o.rootTopicKey,editorRootTopicKey:o.editorRootTopicKey,focusKey:o.focusKey,extData:r.run("serializeExtData",vf(vf({},e),{extData:o.extData})),topics:o.topics.valueSeq().toArray().map((function(t){return r.run("serializeTopic",vf(vf({},e),{topic:t}))})),config:r.run("serializeConfig",vf(vf({},e),{config:o.config})),formatVersion:o.formatVersion}},deserializeModel:function(e,t){var n=t();if(null!=n)return n;var o=e.obj,r=e.controller;null==o.formatVersion&&(o.formatVersion="0.0");var c=o.rootTopicKey,i=o.editorRootTopicKey,a=o.focusKey,l=o.topics,u=o.config,s=o.extData,p=o.formatVersion,d=new mf;return null==(d=d.merge({rootTopicKey:c,editorRootTopicKey:null==i?c:i,focusKey:a,extData:r.run("deserializeExtData",vf(vf({},e),{extData:s,formatVersion:p})),config:r.run("deserializeConfig",vf(vf({},e),{config:u,formatVersion:p})),topics:r.run("deserializeTopics",vf(vf({},e),{topics:l,formatVersion:p})),formatVersion:o.formatVersion})).focusKey&&(d=d.set("focusKey",d.rootTopicKey)),null==d.focusMode&&(d=d.set("focusMode",sf)),jf("deserializeModel",d),d},serializeExtData:function(e,t){var n=t();if(null!=n)return n;var o=e.extData,r=e.controller,c={};return o.forEach((function(t,n){c[n]=r.run("serializeExtDataItem",{props:e,extDataKey:n,extDataItem:t})})),c},deserializeExtData:function(e,t){var n=t();if(null!=n)return n;var o=e.extData,r=e.controller,c=Object(j.Map)();for(var i in o)c=c.set(i,r.run("deserializeExtDataItem",vf(vf({},e),{extDataKey:i,extDataItem:o[i]})));return c},serializeExtDataItem:function(e,t){var n=t();if(null!=n)return n;var o=e.extDataItem;return Object(j.isImmutable)(o)?o.toJS():o},deserializeExtDataItem:function(e,t){var n=t();return null!=n?n:e.extDataItem},serializeConfig:function(e,t){var n=t();return null!=n?n:e.config.toJS()},deserializeConfig:function(e,t){var n=t();if(null!=n)return n;var o=e.config;return new bf(o)},serializeTopic:function(e,t){var n=t();if(null!=n)return n;var o=e.topic,r=e.controller;return{key:o.key,parentKey:o.parentKey,subKeys:o.subKeys.toArray(),collapse:o.collapse,style:o.style,blocks:o.blocks.map((function(t){return r.run("serializeBlock",vf(vf({},e),{block:t}))}))}},deserializeTopic:function(e,t){var n=t();if(null!=n)return n;var o=e.topic,r=e.controller,c=o.key,i=o.parentKey,a=o.subKeys,l=o.blocks,u=o.style,s=o.collapse,p=new hf;return p=p.merge({key:c,parentKey:i,subKeys:Object(j.List)(a),style:u,collapse:s,blocks:r.run("deserializeBlocks",vf(vf({},e),{blocks:l}))})},deserializeTopics:function(e,t){var n=t();if(null!=n)return n;var o=e.topics,r=e.controller,c=Object(j.Map)();return c=c.withMutations((function(t){o.forEach((function(n){return t.set(n.key,r.run("deserializeTopic",vf(vf({},e),{topic:n})))}))}))},serializeBlock:function(e,t){var n=t();if(null!=n)return n;var o=e.block,r=e.controller;return{type:o.type,data:r.run("serializeBlockData",vf({},e))}},serializeBlockData:function(e,t){var n=t();return null!=n?n:e.block.data},deserializeBlock:function(e,t){var n=t();if(null!=n)return n;var o=e.block,r=e.controller,c=o.type;return new ff({type:c,data:r.run("deserializeBlockData",vf(vf({},e),{block:o}))})},deserializeBlockData:function(e,t){var n=t();return null!=n?n:e.block.data},deserializeBlocks:function(e,t){var n=t();if(null!=n)return n;var o=e.blocks,r=e.controller,c=Object(j.List)();return c=c.withMutations((function(t){o.forEach((function(n){return t.push(r.run("deserializeBlock",vf(vf({},e),{block:n})))}))}))}}]),qK=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).diagramRef=function(e){o.diagram=e,o.setState({})},o.onClickUndo=function(e){var t=o.diagram.getDiagramProps();t.controller.run("undo",t)},o.onClickRedo=function(e){var t=o.diagram.getDiagramProps();t.controller.run("redo",t)},o.onChange=function(e,t){o.setState({model:e},t)},o.initModel(),o}return Object(l.a)(n,[{key:"initModel",value:function(){var e=function(){var e=wK();return _K.create({rootTopicKey:e,topics:[{key:e,blocks:[{type:"CONTENT",data:"MainTopic"}]}]})}();this.state={model:e}}},{key:"renderDiagram",value:function(){return r.a.createElement(mc,{ref:this.diagramRef,model:this.state.model,onChange:this.onChange,plugins:XK})}},{key:"renderToolbar",value:function(){var e=this.diagram.getDiagramProps(),t=e.controller,n=t.run("canUndo",e),o=t.run("canRedo",e),c={diagram:this.diagram,onClickUndo:this.onClickUndo,onClickRedo:this.onClickRedo,canUndo:n,canRedo:o};return r.a.createElement(JK,c)}},{key:"render",value:function(){return r.a.createElement("div",{className:"mindmap"},this.diagram&&this.renderToolbar(),this.renderDiagram())}}]),n}(r.a.Component);n(878);var QK=function(){return r.a.createElement(qK,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));localStorage.debug=["app","plugin:layout"].join(","),i.a.render(r.a.createElement(QK,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}}]);
//# sourceMappingURL=chunk-blinkmind.40bfdff5.chunk.js.map